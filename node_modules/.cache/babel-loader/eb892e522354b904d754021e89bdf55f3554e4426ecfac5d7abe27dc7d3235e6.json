{"ast":null,"code":"import{useState,useCallback}from'react';export const useSlider=()=>{const[isDraggingSlider,setIsDraggingSlider]=useState(false);const[draggedHandle,setDraggedHandle]=useState(null);const[sliderRect,setSliderRect]=useState(null);const handleSliderMouseDown=useCallback((e,handle)=>{e.preventDefault();setIsDraggingSlider(true);setDraggedHandle(handle);// Всегда ищем элемент слайдера по классу\nconst sliderElement=e.currentTarget.closest('.year-range-slider');if(sliderElement){setSliderRect(sliderElement.getBoundingClientRect());}},[]);const handleSliderMouseMove=useCallback((e,yearInputs,applyYearFilter,setYearInputs)=>{if(!isDraggingSlider||!draggedHandle)return;// Получаем актуальные координаты слайдера\n// Ищем активный слайдер (тот, который видим на экране)\nconst sliderElements=document.querySelectorAll('.year-range-slider');let sliderElement=null;// Находим видимый слайдер\nArray.from(sliderElements).forEach(element=>{const rect=element.getBoundingClientRect();if(rect.width>0&&rect.height>0&&!sliderElement){sliderElement=element;}});if(!sliderElement)return;const rect=sliderElement.getBoundingClientRect();const clientX='touches'in e?e.touches[0].clientX:e.clientX;const x=clientX-rect.left;const percentage=Math.max(0,Math.min(100,x/rect.width*100));// Преобразуем процент в год (от -800 до 2000)\nconst totalRange=2800;// 2000 - (-800)\nconst year=Math.round(-800+percentage/100*totalRange);// Ограничиваем значения\nconst startYear=parseInt(yearInputs.start)||-800;const endYear=parseInt(yearInputs.end)||2000;let newYear=year;if(draggedHandle==='start'){newYear=Math.max(-800,Math.min(endYear-100,year));setYearInputs(prev=>({...prev,start:newYear.toString()}));applyYearFilter('start',newYear.toString());}else{newYear=Math.max(startYear+100,Math.min(2000,year));setYearInputs(prev=>({...prev,end:newYear.toString()}));applyYearFilter('end',newYear.toString());}},[isDraggingSlider,draggedHandle]);const handleSliderMouseUp=useCallback(()=>{setIsDraggingSlider(false);setDraggedHandle(null);setSliderRect(null);},[]);return{isDraggingSlider,draggedHandle,sliderRect,handleSliderMouseDown,handleSliderMouseMove,handleSliderMouseUp};};","map":{"version":3,"names":["useState","useCallback","useSlider","isDraggingSlider","setIsDraggingSlider","draggedHandle","setDraggedHandle","sliderRect","setSliderRect","handleSliderMouseDown","e","handle","preventDefault","sliderElement","currentTarget","closest","getBoundingClientRect","handleSliderMouseMove","yearInputs","applyYearFilter","setYearInputs","sliderElements","document","querySelectorAll","Array","from","forEach","element","rect","width","height","clientX","touches","x","left","percentage","Math","max","min","totalRange","year","round","startYear","parseInt","start","endYear","end","newYear","prev","toString","handleSliderMouseUp"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/hooks/useSlider.ts"],"sourcesContent":["import { useState, useCallback } from 'react'\r\n\r\nexport const useSlider = () => {\r\n  const [isDraggingSlider, setIsDraggingSlider] = useState(false)\r\n  const [draggedHandle, setDraggedHandle] = useState<'start' | 'end' | null>(null)\r\n  const [sliderRect, setSliderRect] = useState<DOMRect | null>(null)\r\n\r\n  const handleSliderMouseDown = useCallback((e: React.MouseEvent | React.TouchEvent, handle: 'start' | 'end') => {\r\n    e.preventDefault()\r\n    setIsDraggingSlider(true)\r\n    setDraggedHandle(handle)\r\n    \r\n    // Всегда ищем элемент слайдера по классу\r\n    const sliderElement = e.currentTarget.closest('.year-range-slider') as Element\r\n    if (sliderElement) {\r\n      setSliderRect(sliderElement.getBoundingClientRect())\r\n    }\r\n  }, [])\r\n\r\n  const handleSliderMouseMove = useCallback((e: MouseEvent | TouchEvent, yearInputs: { start: string; end: string }, applyYearFilter: (field: 'start' | 'end', value: string) => void, setYearInputs: (inputs: { start: string; end: string } | ((prev: { start: string; end: string }) => { start: string; end: string })) => void) => {\r\n    if (!isDraggingSlider || !draggedHandle) return\r\n\r\n    // Получаем актуальные координаты слайдера\r\n    // Ищем активный слайдер (тот, который видим на экране)\r\n    const sliderElements = document.querySelectorAll('.year-range-slider')\r\n    let sliderElement: Element | null = null\r\n    \r\n    // Находим видимый слайдер\r\n    Array.from(sliderElements).forEach((element) => {\r\n      const rect = element.getBoundingClientRect()\r\n      if (rect.width > 0 && rect.height > 0 && !sliderElement) {\r\n        sliderElement = element\r\n      }\r\n    })\r\n    \r\n    if (!sliderElement) return\r\n    \r\n    const rect = (sliderElement as Element).getBoundingClientRect()\r\n    const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX\r\n    const x = clientX - rect.left\r\n    const percentage = Math.max(0, Math.min(100, (x / rect.width) * 100))\r\n    \r\n    // Преобразуем процент в год (от -800 до 2000)\r\n    const totalRange = 2800 // 2000 - (-800)\r\n    const year = Math.round(-800 + (percentage / 100) * totalRange)\r\n    \r\n    // Ограничиваем значения\r\n    const startYear = parseInt(yearInputs.start) || -800\r\n    const endYear = parseInt(yearInputs.end) || 2000\r\n    \r\n    let newYear = year\r\n    if (draggedHandle === 'start') {\r\n      newYear = Math.max(-800, Math.min(endYear - 100, year))\r\n      setYearInputs(prev => ({ ...prev, start: newYear.toString() }))\r\n      applyYearFilter('start', newYear.toString())\r\n    } else {\r\n      newYear = Math.max(startYear + 100, Math.min(2000, year))\r\n      setYearInputs(prev => ({ ...prev, end: newYear.toString() }))\r\n      applyYearFilter('end', newYear.toString())\r\n    }\r\n  }, [isDraggingSlider, draggedHandle])\r\n\r\n  const handleSliderMouseUp = useCallback(() => {\r\n    setIsDraggingSlider(false)\r\n    setDraggedHandle(null)\r\n    setSliderRect(null)\r\n  }, [])\r\n\r\n  return {\r\n    isDraggingSlider,\r\n    draggedHandle,\r\n    sliderRect,\r\n    handleSliderMouseDown,\r\n    handleSliderMouseMove,\r\n    handleSliderMouseUp\r\n  }\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}