{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useRef, useCallback, useEffect } from 'react';\nexport const useTimelineDrag = ({\n  timelineWidth,\n  containerWidth\n}) => {\n  _s();\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStartX, setDragStartX] = useState(0);\n  const [dragStartY, setDragStartY] = useState(0);\n  const [scrollLeft, setScrollLeft] = useState(0);\n  const [scrollTop, setScrollTop] = useState(0);\n  const timelineRef = useRef(null);\n  const dragStartTime = useRef(0);\n  const handleMouseDown = useCallback(e => {\n    var _timelineRef$current, _timelineRef$current2;\n    const target = e.target;\n    const isInteractive = target.closest('.life-bar') || target.closest('.achievement-marker') || target.closest('button') || target.closest('[role=\"button\"]');\n    if (isInteractive) return;\n    setIsDragging(true);\n    setDragStartX(e.clientX);\n    setDragStartY(e.clientY);\n    setScrollLeft(((_timelineRef$current = timelineRef.current) === null || _timelineRef$current === void 0 ? void 0 : _timelineRef$current.scrollLeft) || 0);\n    setScrollTop(((_timelineRef$current2 = timelineRef.current) === null || _timelineRef$current2 === void 0 ? void 0 : _timelineRef$current2.scrollTop) || 0);\n    dragStartTime.current = Date.now();\n    e.preventDefault();\n  }, []);\n\n  // Убираем локальный handleMouseMove, так как используем глобальный\n  const handleMouseMove = useCallback(() => {}, []);\n\n  // Убираем локальный handleMouseUp, так как используем глобальный\n  const handleMouseUp = useCallback(() => {}, []);\n  const handleTouchStart = useCallback(e => {\n    var _timelineRef$current3, _timelineRef$current4;\n    const target = e.target;\n    const isInteractive = target.closest('.life-bar') || target.closest('.achievement-marker') || target.closest('button') || target.closest('[role=\"button\"]');\n    if (isInteractive) return;\n    setIsDragging(true);\n    setDragStartX(e.touches[0].clientX);\n    setDragStartY(e.touches[0].clientY);\n    setScrollLeft(((_timelineRef$current3 = timelineRef.current) === null || _timelineRef$current3 === void 0 ? void 0 : _timelineRef$current3.scrollLeft) || 0);\n    setScrollTop(((_timelineRef$current4 = timelineRef.current) === null || _timelineRef$current4 === void 0 ? void 0 : _timelineRef$current4.scrollTop) || 0);\n    dragStartTime.current = Date.now();\n  }, []);\n  const handleTouchMove = useCallback(e => {\n    if (!isDragging) return;\n    const deltaX = e.touches[0].clientX - dragStartX;\n    const deltaY = e.touches[0].clientY - dragStartY;\n    const newScrollLeft = scrollLeft - deltaX;\n    const newScrollTop = scrollTop - deltaY;\n    if (timelineRef.current) {\n      timelineRef.current.scrollLeft = Math.max(0, newScrollLeft);\n      timelineRef.current.scrollTop = Math.max(0, newScrollTop);\n    }\n  }, [isDragging, dragStartX, dragStartY, scrollLeft, scrollTop]);\n  const handleTouchEnd = useCallback(() => {\n    if (!isDragging) return;\n    const dragDuration = Date.now() - dragStartTime.current;\n    if (dragDuration < 200) {\n      setIsDraggingTimeline(false);\n    } else {\n      setIsDraggingTimeline(true);\n      setTimeout(() => setIsDraggingTimeline(false), 100);\n    }\n    setIsDragging(false);\n  }, [isDragging]);\n  useEffect(() => {\n    const handleGlobalMouseMove = e => {\n      if (!isDragging) return;\n      const deltaX = e.clientX - dragStartX;\n      const deltaY = e.clientY - dragStartY;\n      const newScrollLeft = scrollLeft - deltaX;\n      const newScrollTop = scrollTop - deltaY;\n      if (timelineRef.current) {\n        timelineRef.current.scrollLeft = Math.max(0, newScrollLeft);\n        timelineRef.current.scrollTop = Math.max(0, newScrollTop);\n      }\n    };\n    const handleGlobalMouseUp = () => {\n      if (!isDragging) return;\n      const dragDuration = Date.now() - dragStartTime.current;\n      if (dragDuration < 200) {\n        setIsDraggingTimeline(false);\n      } else {\n        setIsDraggingTimeline(true);\n        setTimeout(() => setIsDraggingTimeline(false), 100);\n      }\n      setIsDragging(false);\n    };\n    if (isDragging) {\n      document.addEventListener('mousemove', handleGlobalMouseMove);\n      document.addEventListener('mouseup', handleGlobalMouseUp);\n    }\n    return () => {\n      document.removeEventListener('mousemove', handleGlobalMouseMove);\n      document.removeEventListener('mouseup', handleGlobalMouseUp);\n      setIsDragging(false);\n      setIsDraggingTimeline(false);\n    };\n  }, [isDragging, dragStartX, dragStartY, scrollLeft, scrollTop]);\n  return {\n    timelineRef,\n    isDragging,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseUp,\n    handleTouchStart,\n    handleTouchMove,\n    handleTouchEnd\n  };\n};\n_s(useTimelineDrag, \"CIBM281wvsgardX8D089QdEd5Jk=\");","map":{"version":3,"names":["useState","useRef","useCallback","useEffect","useTimelineDrag","timelineWidth","containerWidth","_s","isDragging","setIsDragging","dragStartX","setDragStartX","dragStartY","setDragStartY","scrollLeft","setScrollLeft","scrollTop","setScrollTop","timelineRef","dragStartTime","handleMouseDown","e","_timelineRef$current","_timelineRef$current2","target","isInteractive","closest","clientX","clientY","current","Date","now","preventDefault","handleMouseMove","handleMouseUp","handleTouchStart","_timelineRef$current3","_timelineRef$current4","touches","handleTouchMove","deltaX","deltaY","newScrollLeft","newScrollTop","Math","max","handleTouchEnd","dragDuration","setIsDraggingTimeline","setTimeout","handleGlobalMouseMove","handleGlobalMouseUp","document","addEventListener","removeEventListener"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/hooks/useTimelineDrag.ts"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from 'react'\r\n\r\ninterface UseTimelineDragProps {\r\n  timelineWidth: number\r\n  containerWidth: number\r\n}\r\n\r\nexport const useTimelineDrag = ({ timelineWidth, containerWidth }: UseTimelineDragProps) => {\r\n  const [isDragging, setIsDragging] = useState(false)\r\n  const [dragStartX, setDragStartX] = useState(0)\r\n  const [dragStartY, setDragStartY] = useState(0)\r\n  const [scrollLeft, setScrollLeft] = useState(0)\r\n  const [scrollTop, setScrollTop] = useState(0)\r\n  const timelineRef = useRef<HTMLDivElement>(null)\r\n  const dragStartTime = useRef<number>(0)\r\n\r\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\r\n    const target = e.target as HTMLElement\r\n    const isInteractive = target.closest('.life-bar') || \r\n                         target.closest('.achievement-marker') ||\r\n                         target.closest('button') ||\r\n                         target.closest('[role=\"button\"]')\r\n    \r\n    if (isInteractive) return\r\n\r\n    setIsDragging(true)\r\n    setDragStartX(e.clientX)\r\n    setDragStartY(e.clientY)\r\n    setScrollLeft(timelineRef.current?.scrollLeft || 0)\r\n    setScrollTop(timelineRef.current?.scrollTop || 0)\r\n    dragStartTime.current = Date.now()\r\n    e.preventDefault()\r\n  }, [])\r\n\r\n  // Убираем локальный handleMouseMove, так как используем глобальный\r\n  const handleMouseMove = useCallback(() => {}, [])\r\n\r\n  // Убираем локальный handleMouseUp, так как используем глобальный\r\n  const handleMouseUp = useCallback(() => {}, [])\r\n\r\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\r\n    const target = e.target as HTMLElement\r\n    const isInteractive = target.closest('.life-bar') || \r\n                         target.closest('.achievement-marker') ||\r\n                         target.closest('button') ||\r\n                         target.closest('[role=\"button\"]')\r\n    \r\n    if (isInteractive) return\r\n\r\n    setIsDragging(true)\r\n    setDragStartX(e.touches[0].clientX)\r\n    setDragStartY(e.touches[0].clientY)\r\n    setScrollLeft(timelineRef.current?.scrollLeft || 0)\r\n    setScrollTop(timelineRef.current?.scrollTop || 0)\r\n    dragStartTime.current = Date.now()\r\n  }, [])\r\n\r\n  const handleTouchMove = useCallback((e: React.TouchEvent) => {\r\n    if (!isDragging) return\r\n\r\n    const deltaX = e.touches[0].clientX - dragStartX\r\n    const deltaY = e.touches[0].clientY - dragStartY\r\n    const newScrollLeft = scrollLeft - deltaX\r\n    const newScrollTop = scrollTop - deltaY\r\n    \r\n    if (timelineRef.current) {\r\n      timelineRef.current.scrollLeft = Math.max(0, newScrollLeft)\r\n      timelineRef.current.scrollTop = Math.max(0, newScrollTop)\r\n    }\r\n  }, [isDragging, dragStartX, dragStartY, scrollLeft, scrollTop])\r\n\r\n  const handleTouchEnd = useCallback(() => {\r\n    if (!isDragging) return\r\n\r\n    const dragDuration = Date.now() - dragStartTime.current\r\n    \r\n    if (dragDuration < 200) {\r\n      setIsDraggingTimeline(false)\r\n    } else {\r\n      setIsDraggingTimeline(true)\r\n      setTimeout(() => setIsDraggingTimeline(false), 100)\r\n    }\r\n\r\n    setIsDragging(false)\r\n  }, [isDragging])\r\n\r\n  useEffect(() => {\r\n    const handleGlobalMouseMove = (e: MouseEvent) => {\r\n      if (!isDragging) return\r\n\r\n      const deltaX = e.clientX - dragStartX\r\n      const deltaY = e.clientY - dragStartY\r\n      const newScrollLeft = scrollLeft - deltaX\r\n      const newScrollTop = scrollTop - deltaY\r\n      \r\n      if (timelineRef.current) {\r\n        timelineRef.current.scrollLeft = Math.max(0, newScrollLeft)\r\n        timelineRef.current.scrollTop = Math.max(0, newScrollTop)\r\n      }\r\n    }\r\n\r\n    const handleGlobalMouseUp = () => {\r\n      if (!isDragging) return\r\n\r\n      const dragDuration = Date.now() - dragStartTime.current\r\n      \r\n      if (dragDuration < 200) {\r\n        setIsDraggingTimeline(false)\r\n      } else {\r\n        setIsDraggingTimeline(true)\r\n        setTimeout(() => setIsDraggingTimeline(false), 100)\r\n      }\r\n\r\n      setIsDragging(false)\r\n    }\r\n\r\n    if (isDragging) {\r\n      document.addEventListener('mousemove', handleGlobalMouseMove)\r\n      document.addEventListener('mouseup', handleGlobalMouseUp)\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleGlobalMouseMove)\r\n      document.removeEventListener('mouseup', handleGlobalMouseUp)\r\n      setIsDragging(false)\r\n      setIsDraggingTimeline(false)\r\n    }\r\n  }, [isDragging, dragStartX, dragStartY, scrollLeft, scrollTop])\r\n\r\n  return {\r\n    timelineRef,\r\n    isDragging,\r\n    handleMouseDown,\r\n    handleMouseMove,\r\n    handleMouseUp,\r\n    handleTouchStart,\r\n    handleTouchMove,\r\n    handleTouchEnd\r\n  }\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}