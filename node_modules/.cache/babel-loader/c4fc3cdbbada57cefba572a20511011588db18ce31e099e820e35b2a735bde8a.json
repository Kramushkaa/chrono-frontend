{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useAuth}from'../context/AuthContext';import{getProfile}from'../services/auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function Profile(){const{auth,logout,ensureAccessToken}=useAuth();const[loading,setLoading]=useState(false);const[profile,setProfile]=useState(null);const[error,setError]=useState(null);useEffect(()=>{(async()=>{setLoading(true);setError(null);try{var _data$data;const token=await ensureAccessToken();if(!token)throw new Error('Нет токена доступа');const data=await getProfile(token);setProfile((data===null||data===void 0?void 0:(_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.user)||null);}catch(e){setError('Не удалось загрузить профиль');}finally{setLoading(false);}})();},[ensureAccessToken]);if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{style:{color:'red'},children:error});return/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:8},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041B\\u0438\\u0447\\u043D\\u044B\\u0439 \\u043A\\u0430\\u0431\\u0438\\u043D\\u0435\\u0442\"}),profile?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",profile.email]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F:\"}),\" \",profile.username||'—']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0420\\u043E\\u043B\\u044C:\"}),\" \",profile.role]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D:\"}),\" \",profile.email_verified?'да':'нет']})]}):/*#__PURE__*/_jsx(\"div\",{children:\"\\u041D\\u0435\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]});}","map":{"version":3,"names":["React","useEffect","useState","useAuth","getProfile","jsx","_jsx","jsxs","_jsxs","Profile","auth","logout","ensureAccessToken","loading","setLoading","profile","setProfile","error","setError","_data$data","token","Error","data","user","e","children","style","color","display","gap","email","username","role","email_verified","onClick"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/components/Profile.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { getProfile } from '../services/auth';\r\n\r\nexport function Profile() {\r\n  const { auth, logout, ensureAccessToken } = useAuth();\r\n  const [loading, setLoading] = useState(false);\r\n  const [profile, setProfile] = useState<any>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const token = await ensureAccessToken();\r\n        if (!token) throw new Error('Нет токена доступа');\r\n        const data = await getProfile(token);\r\n        setProfile(data?.data?.user || null);\r\n      } catch (e) {\r\n        setError('Не удалось загрузить профиль');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, [ensureAccessToken]);\r\n\r\n  if (loading) return <div>Загрузка профиля...</div>;\r\n  if (error) return <div style={{ color: 'red' }}>{error}</div>;\r\n\r\n  return (\r\n    <div style={{ display: 'grid', gap: 8 }}>\r\n      <h3>Личный кабинет</h3>\r\n      {profile ? (\r\n        <div>\r\n          <div><strong>Email:</strong> {profile.email}</div>\r\n          <div><strong>Имя пользователя:</strong> {profile.username || '—'}</div>\r\n          <div><strong>Роль:</strong> {profile.role}</div>\r\n          <div><strong>Email подтвержден:</strong> {profile.email_verified ? 'да' : 'нет'}</div>\r\n        </div>\r\n      ) : (\r\n        <div>Нет данных профиля</div>\r\n      )}\r\n      <button onClick={logout}>Выйти</button>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,OAAO,KAAQ,wBAAwB,CAChD,OAASC,UAAU,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE9C,MAAO,SAAS,CAAAC,OAAOA,CAAA,CAAG,CACxB,KAAM,CAAEC,IAAI,CAAEC,MAAM,CAAEC,iBAAkB,CAAC,CAAGT,OAAO,CAAC,CAAC,CACrD,KAAM,CAACU,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAM,IAAI,CAAC,CACjD,KAAM,CAACe,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAgB,IAAI,CAAC,CAEvDD,SAAS,CAAC,IAAM,CACd,CAAC,SAAY,CACXa,UAAU,CAAC,IAAI,CAAC,CAChBI,QAAQ,CAAC,IAAI,CAAC,CACd,GAAI,KAAAC,UAAA,CACF,KAAM,CAAAC,KAAK,CAAG,KAAM,CAAAR,iBAAiB,CAAC,CAAC,CACvC,GAAI,CAACQ,KAAK,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,oBAAoB,CAAC,CACjD,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAlB,UAAU,CAACgB,KAAK,CAAC,CACpCJ,UAAU,CAAC,CAAAM,IAAI,SAAJA,IAAI,kBAAAH,UAAA,CAAJG,IAAI,CAAEA,IAAI,UAAAH,UAAA,iBAAVA,UAAA,CAAYI,IAAI,GAAI,IAAI,CAAC,CACtC,CAAE,MAAOC,CAAC,CAAE,CACVN,QAAQ,CAAC,8BAA8B,CAAC,CAC1C,CAAC,OAAS,CACRJ,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,EAAE,CAAC,CACN,CAAC,CAAE,CAACF,iBAAiB,CAAC,CAAC,CAEvB,GAAIC,OAAO,CAAE,mBAAOP,IAAA,QAAAmB,QAAA,CAAK,gGAAmB,CAAK,CAAC,CAClD,GAAIR,KAAK,CAAE,mBAAOX,IAAA,QAAKoB,KAAK,CAAE,CAAEC,KAAK,CAAE,KAAM,CAAE,CAAAF,QAAA,CAAER,KAAK,CAAM,CAAC,CAE7D,mBACET,KAAA,QAAKkB,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,CAAE,CAAE,CAAAJ,QAAA,eACtCnB,IAAA,OAAAmB,QAAA,CAAI,iFAAc,CAAI,CAAC,CACtBV,OAAO,cACNP,KAAA,QAAAiB,QAAA,eACEjB,KAAA,QAAAiB,QAAA,eAAKnB,IAAA,WAAAmB,QAAA,CAAQ,QAAM,CAAQ,CAAC,IAAC,CAACV,OAAO,CAACe,KAAK,EAAM,CAAC,cAClDtB,KAAA,QAAAiB,QAAA,eAAKnB,IAAA,WAAAmB,QAAA,CAAQ,8FAAiB,CAAQ,CAAC,IAAC,CAACV,OAAO,CAACgB,QAAQ,EAAI,GAAG,EAAM,CAAC,cACvEvB,KAAA,QAAAiB,QAAA,eAAKnB,IAAA,WAAAmB,QAAA,CAAQ,2BAAK,CAAQ,CAAC,IAAC,CAACV,OAAO,CAACiB,IAAI,EAAM,CAAC,cAChDxB,KAAA,QAAAiB,QAAA,eAAKnB,IAAA,WAAAmB,QAAA,CAAQ,2EAAkB,CAAQ,CAAC,IAAC,CAACV,OAAO,CAACkB,cAAc,CAAG,IAAI,CAAG,KAAK,EAAM,CAAC,EACnF,CAAC,cAEN3B,IAAA,QAAAmB,QAAA,CAAK,oGAAkB,CAAK,CAC7B,cACDnB,IAAA,WAAQ4B,OAAO,CAAEvB,MAAO,CAAAc,QAAA,CAAC,gCAAK,CAAQ,CAAC,EACpC,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}