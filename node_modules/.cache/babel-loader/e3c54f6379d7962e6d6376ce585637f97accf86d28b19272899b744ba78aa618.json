{"ast":null,"code":"import React,{useRef,useEffect,useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const FilterDropdown=_ref=>{let{title,items,selectedItems,onSelectionChange,getItemColor,icon,textLabel}=_ref;const isActive=selectedItems.length>0;const dropdownRef=useRef(null);const contentRef=useRef(null);const[dropdownPosition,setDropdownPosition]=useState('bottom');const[isOpen,setIsOpen]=useState(false);// Функция для определения позиции dropdown\nconst updateDropdownPosition=()=>{if(!dropdownRef.current||!contentRef.current)return;const dropdownRect=dropdownRef.current.getBoundingClientRect();const contentRect=contentRef.current.getBoundingClientRect();const viewportHeight=window.innerHeight;// Проверяем, помещается ли dropdown снизу\nconst spaceBelow=viewportHeight-dropdownRect.bottom;const contentHeight=contentRect.height;if(spaceBelow<contentHeight&&dropdownRect.top>contentHeight){setDropdownPosition('top');}else{setDropdownPosition('bottom');}};// Обновляем позицию при открытии dropdown\nuseEffect(()=>{if(isOpen){updateDropdownPosition();}},[isOpen]);// Обновляем позицию при изменении размера окна\nuseEffect(()=>{const handleResize=()=>{if(isOpen){updateDropdownPosition();}};window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[isOpen]);// Обработка клика вне dropdown для его закрытия\nuseEffect(()=>{const handleClickOutside=event=>{if(dropdownRef.current&&!dropdownRef.current.contains(event.target)){setIsOpen(false);}};if(isOpen){document.addEventListener('mousedown',handleClickOutside);}return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[isOpen]);return/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown\",ref:dropdownRef,children:[/*#__PURE__*/_jsxs(\"button\",{className:`filter-btn ${isActive?'active':''}`,style:{minWidth:'auto',padding:'0.3rem 0.6rem',display:'flex',alignItems:'center',gap:'0.3rem',background:isActive?'rgba(139, 69, 19, 0.15)':'rgba(139, 69, 19, 0.08)',border:`1px solid ${isActive?'rgba(139, 69, 19, 0.3)':'rgba(139, 69, 19, 0.2)'}`,borderRadius:'4px',color:'#f4e4c1',fontSize:'0.7rem',cursor:'pointer',transition:'all 0.2s ease',whiteSpace:'nowrap'},onClick:()=>setIsOpen(!isOpen),children:[icon&&/*#__PURE__*/_jsx(\"span\",{className:\"filter-icon\",children:icon}),/*#__PURE__*/_jsx(\"span\",{className:\"filter-text\",children:textLabel||title}),isActive&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-count\",children:[\"(\",selectedItems.length,\")\"]})]}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-content\",ref:contentRef,style:{position:'absolute',top:dropdownPosition==='bottom'?'100%':'auto',bottom:dropdownPosition==='top'?'100%':'auto',left:'0',right:'0',zIndex:1000,maxHeight:'300px',overflowY:'auto',display:'block'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'0.5rem',borderBottom:'1px solid rgba(139, 69, 19, 0.3)'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onSelectionChange(items);},style:{padding:'0.25rem 0.5rem',marginRight:'0.5rem',background:'#27ae60',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'0.7rem'},children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0432\\u0441\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onSelectionChange([]);},style:{padding:'0.25rem 0.5rem',background:'#e74c3c',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'0.7rem'},children:\"\\u0421\\u043D\\u044F\\u0442\\u044C \\u0432\\u0441\\u0435\"})]}),items.map(item=>/*#__PURE__*/_jsxs(\"label\",{className:\"filter-checkbox\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedItems.includes(item),onChange:e=>{e.stopPropagation();if(e.target.checked){onSelectionChange([...selectedItems,item]);}else{onSelectionChange(selectedItems.filter(i=>i!==item));}}}),/*#__PURE__*/_jsx(\"span\",{style:{color:getItemColor?getItemColor(item):'#f4e4c1',fontWeight:getItemColor?'bold':'normal'},children:item})]},item))]})]});};","map":{"version":3,"names":["React","useRef","useEffect","useState","jsx","_jsx","jsxs","_jsxs","FilterDropdown","_ref","title","items","selectedItems","onSelectionChange","getItemColor","icon","textLabel","isActive","length","dropdownRef","contentRef","dropdownPosition","setDropdownPosition","isOpen","setIsOpen","updateDropdownPosition","current","dropdownRect","getBoundingClientRect","contentRect","viewportHeight","window","innerHeight","spaceBelow","bottom","contentHeight","height","top","handleResize","addEventListener","removeEventListener","handleClickOutside","event","contains","target","document","className","ref","children","style","minWidth","padding","display","alignItems","gap","background","border","borderRadius","color","fontSize","cursor","transition","whiteSpace","onClick","position","left","right","zIndex","maxHeight","overflowY","borderBottom","e","stopPropagation","marginRight","map","item","type","checked","includes","onChange","filter","i","fontWeight"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/components/FilterDropdown.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react'\r\n\r\ninterface FilterDropdownProps {\r\n  title: string\r\n  items: string[]\r\n  selectedItems: string[]\r\n  onSelectionChange: (items: string[]) => void\r\n  getItemColor?: (item: string) => string\r\n  icon?: React.ReactNode\r\n  textLabel?: string\r\n}\r\n\r\nexport const FilterDropdown: React.FC<FilterDropdownProps> = ({ \r\n  title, \r\n  items, \r\n  selectedItems, \r\n  onSelectionChange, \r\n  getItemColor,\r\n  icon,\r\n  textLabel\r\n}) => {\r\n  const isActive = selectedItems.length > 0\r\n  const dropdownRef = useRef<HTMLDivElement>(null)\r\n  const contentRef = useRef<HTMLDivElement>(null)\r\n  const [dropdownPosition, setDropdownPosition] = useState<'bottom' | 'top'>('bottom')\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  \r\n  // Функция для определения позиции dropdown\r\n  const updateDropdownPosition = () => {\r\n    if (!dropdownRef.current || !contentRef.current) return\r\n    \r\n    const dropdownRect = dropdownRef.current.getBoundingClientRect()\r\n    const contentRect = contentRef.current.getBoundingClientRect()\r\n    const viewportHeight = window.innerHeight\r\n    \r\n    // Проверяем, помещается ли dropdown снизу\r\n    const spaceBelow = viewportHeight - dropdownRect.bottom\r\n    const contentHeight = contentRect.height\r\n    \r\n    if (spaceBelow < contentHeight && dropdownRect.top > contentHeight) {\r\n      setDropdownPosition('top')\r\n    } else {\r\n      setDropdownPosition('bottom')\r\n    }\r\n  }\r\n  \r\n  // Обновляем позицию при открытии dropdown\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      updateDropdownPosition()\r\n    }\r\n  }, [isOpen])\r\n  \r\n  // Обновляем позицию при изменении размера окна\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      if (isOpen) {\r\n        updateDropdownPosition()\r\n      }\r\n    }\r\n    \r\n    window.addEventListener('resize', handleResize)\r\n    return () => window.removeEventListener('resize', handleResize)\r\n  }, [isOpen])\r\n  \r\n  // Обработка клика вне dropdown для его закрытия\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false)\r\n      }\r\n    }\r\n    \r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside)\r\n    }\r\n    \r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside)\r\n    }\r\n  }, [isOpen])\r\n  \r\n  return (\r\n    <div className=\"filter-dropdown\" ref={dropdownRef}>\r\n      <button \r\n        className={`filter-btn ${isActive ? 'active' : ''}`}\r\n        style={{ \r\n          minWidth: 'auto',\r\n          padding: '0.3rem 0.6rem',\r\n          display: 'flex', \r\n          alignItems: 'center', \r\n          gap: '0.3rem',\r\n          background: isActive ? 'rgba(139, 69, 19, 0.15)' : 'rgba(139, 69, 19, 0.08)',\r\n          border: `1px solid ${isActive ? 'rgba(139, 69, 19, 0.3)' : 'rgba(139, 69, 19, 0.2)'}`,\r\n          borderRadius: '4px',\r\n          color: '#f4e4c1',\r\n          fontSize: '0.7rem',\r\n          cursor: 'pointer',\r\n          transition: 'all 0.2s ease',\r\n          whiteSpace: 'nowrap'\r\n        }}\r\n        onClick={() => setIsOpen(!isOpen)}\r\n      >\r\n        {icon && <span className=\"filter-icon\">{icon}</span>}\r\n        <span className=\"filter-text\">{textLabel || title}</span>\r\n        {isActive && <span className=\"filter-count\">({selectedItems.length})</span>}\r\n      </button>\r\n      {isOpen && (\r\n        <div \r\n          className=\"filter-dropdown-content\"\r\n          ref={contentRef}\r\n          style={{\r\n            position: 'absolute',\r\n            top: dropdownPosition === 'bottom' ? '100%' : 'auto',\r\n            bottom: dropdownPosition === 'top' ? '100%' : 'auto',\r\n            left: '0',\r\n            right: '0',\r\n            zIndex: 1000,\r\n            maxHeight: '300px',\r\n            overflowY: 'auto',\r\n            display: 'block'\r\n          }}\r\n        >\r\n          <div style={{ padding: '0.5rem', borderBottom: '1px solid rgba(139, 69, 19, 0.3)' }}>\r\n            <button\r\n              onClick={(e) => {\r\n                e.stopPropagation()\r\n                onSelectionChange(items)\r\n              }}\r\n              style={{\r\n                padding: '0.25rem 0.5rem',\r\n                marginRight: '0.5rem',\r\n                background: '#27ae60',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer',\r\n                fontSize: '0.7rem'\r\n              }}\r\n            >\r\n              Выбрать все\r\n            </button>\r\n            <button\r\n              onClick={(e) => {\r\n                e.stopPropagation()\r\n                onSelectionChange([])\r\n              }}\r\n              style={{\r\n                padding: '0.25rem 0.5rem',\r\n                background: '#e74c3c',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer',\r\n                fontSize: '0.7rem'\r\n              }}\r\n            >\r\n              Снять все\r\n            </button>\r\n          </div>\r\n          {items.map(item => (\r\n            <label key={item} className=\"filter-checkbox\" onClick={(e) => e.stopPropagation()}>\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={selectedItems.includes(item)}\r\n                onChange={(e) => {\r\n                  e.stopPropagation()\r\n                  if (e.target.checked) {\r\n                    onSelectionChange([...selectedItems, item])\r\n                  } else {\r\n                    onSelectionChange(selectedItems.filter(i => i !== item))\r\n                  }\r\n                }}\r\n              />\r\n              <span style={{ \r\n                color: getItemColor ? getItemColor(item) : '#f4e4c1',\r\n                fontWeight: getItemColor ? 'bold' : 'normal'\r\n              }}>\r\n                {item}\r\n              </span>\r\n            </label>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}