{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{getPersons,getCategories,getCountries}from'./services/api';import{getCategoryColor,getCategoryColorDark,getCategoryColorMuted}from'./utils/categoryColors';import'./App.css';// Компонент выпадающего фильтра\nimport{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const FilterDropdown=_ref=>{let{title,items,selectedItems,onSelectionChange,getItemColor,icon}=_ref;const isActive=selectedItems.length>0;return/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{className:`filter-btn ${isActive?'active':''}`,style:{minWidth:'150px',display:'flex',alignItems:'center',gap:'0.5rem'},children:[icon,title,\" \",isActive&&`(${selectedItems.length})`]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-content\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'0.5rem',borderBottom:'1px solid rgba(139, 69, 19, 0.3)'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onSelectionChange(items);},style:{padding:'0.25rem 0.5rem',marginRight:'0.5rem',background:'#27ae60',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'0.7rem'},children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0432\\u0441\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onSelectionChange([]);},style:{padding:'0.25rem 0.5rem',background:'#e74c3c',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'0.7rem'},children:\"\\u0421\\u043D\\u044F\\u0442\\u044C \\u0432\\u0441\\u0435\"})]}),items.map(item=>/*#__PURE__*/_jsxs(\"label\",{className:\"filter-checkbox\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedItems.includes(item),onChange:e=>{e.stopPropagation();if(e.target.checked){onSelectionChange([...selectedItems,item]);}else{onSelectionChange(selectedItems.filter(i=>i!==item));}}}),/*#__PURE__*/_jsx(\"span\",{style:{color:getItemColor?getItemColor(item):'#f4e4c1',fontWeight:getItemColor?'bold':'normal'},children:item})]},item))]})]});};// Компонент панели фильтров\nconst FilterPanel=_ref2=>{let{filters,setFilters,allCategories,allCountries}=_ref2;// Состояние для полей ввода годов\nconst[yearInputs,setYearInputs]=useState({start:filters.timeRange.start.toString(),end:filters.timeRange.end.toString()});// Функция для применения фильтра по году\nconst applyYearFilter=(field,value)=>{const numValue=parseInt(value)||(field==='start'?-800:2000);setFilters(prev=>({...prev,timeRange:{...prev.timeRange,[field]:numValue}}));};// Функция для обработки нажатия Enter\nconst handleYearKeyPress=(field,e)=>{if(e.key==='Enter'){var _e$currentTarget$pare,_e$currentTarget$pare2;applyYearFilter(field,e.currentTarget.value);// Переводим фокус на следующий элемент\nconst inputs=(_e$currentTarget$pare=e.currentTarget.parentElement)===null||_e$currentTarget$pare===void 0?void 0:(_e$currentTarget$pare2=_e$currentTarget$pare.parentElement)===null||_e$currentTarget$pare2===void 0?void 0:_e$currentTarget$pare2.querySelectorAll('input');if(inputs){const currentIndex=Array.from(inputs).indexOf(e.currentTarget);const nextInput=inputs[currentIndex+1];if(nextInput){nextInput.focus();}}}};// Функция для сброса всех фильтров\nconst resetAllFilters=()=>{setFilters({categories:[],countries:[],timeRange:{start:-800,end:2000},showAchievements:true});setYearInputs({start:'-800',end:'2000'});};return/*#__PURE__*/_jsxs(\"div\",{className:\"filters-panel\",style:{background:'none',border:'none',boxShadow:'none',padding:0,display:'flex',gap:'1rem',alignItems:'center',flexWrap:'wrap',marginLeft:'auto',zIndex:10001},children:[/*#__PURE__*/_jsx(FilterDropdown,{title:\"\\u0420\\u043E\\u0434 \\u0434\\u0435\\u044F\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u0438\",items:allCategories,selectedItems:filters.categories,onSelectionChange:categories=>setFilters(prev=>({...prev,categories})),getItemColor:getCategoryColor,icon:/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"})})}),/*#__PURE__*/_jsx(FilterDropdown,{title:\"\\u0421\\u0442\\u0440\\u0430\\u043D\\u0430 \\u043F\\u0440\\u043E\\u0438\\u0441\\u0445\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\",items:allCountries,selectedItems:filters.countries,onSelectionChange:countries=>setFilters(prev=>({...prev,countries})),icon:/*#__PURE__*/_jsx(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"})})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'0.5rem',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{fontSize:'0.8rem',display:'block',marginBottom:'0.25rem',color:'#f4e4c1'},children:\"\\u041E\\u0442:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:yearInputs.start,onChange:e=>setYearInputs(prev=>({...prev,start:e.target.value})),onBlur:e=>applyYearFilter('start',e.target.value),onKeyPress:e=>handleYearKeyPress('start',e),style:{width:'80px',padding:'0.5rem',border:'2px solid #8b4513',borderRadius:'4px',background:'rgba(44, 24, 16, 0.8)',color:'#f4e4c1',fontSize:'0.8rem'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{fontSize:'0.8rem',display:'block',marginBottom:'0.25rem',color:'#f4e4c1'},children:\"\\u0414\\u043E:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:yearInputs.end,onChange:e=>setYearInputs(prev=>({...prev,end:e.target.value})),onBlur:e=>applyYearFilter('end',e.target.value),onKeyPress:e=>handleYearKeyPress('end',e),style:{width:'80px',padding:'0.5rem',border:'2px solid #8b4513',borderRadius:'4px',background:'rgba(44, 24, 16, 0.8)',color:'#f4e4c1',fontSize:'0.8rem'}})]}),/*#__PURE__*/_jsx(\"button\",{onClick:resetAllFilters,className:\"filter-btn\",style:{background:'linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%)',fontSize:'0.8rem',padding:'0.5rem 1rem'},children:\"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.5rem',padding:'0.5rem',borderRadius:'4px',background:filters.showAchievements?'rgba(255, 255, 255, 0.1)':'rgba(255, 255, 255, 0.05)',border:`1px solid ${filters.showAchievements?'rgba(255, 255, 255, 0.3)':'rgba(255, 255, 255, 0.1)'}`,transition:'all 0.2s ease'},children:/*#__PURE__*/_jsxs(\"label\",{style:{fontSize:'0.8rem',color:'#f4e4c1',display:'flex',alignItems:'center',gap:'0.5rem',cursor:'pointer',margin:0},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filters.showAchievements,onChange:e=>setFilters(prev=>({...prev,showAchievements:e.target.checked})),style:{width:'16px',height:'16px',cursor:'pointer',accentColor:'#f4e4c1'}}),/*#__PURE__*/_jsx(\"svg\",{width:\"14\",height:\"14\",viewBox:\"0 0 24 24\",fill:\"currentColor\",style:{opacity:filters.showAchievements?1:0.5},children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u041C\\u0430\\u0440\\u043A\\u0435\\u0440\\u044B \\u0434\\u043E\\u0441\\u0442\\u0438\\u0436\\u0435\\u043D\\u0438\\u0439\"})]})})]})]});};function App(){const[hoveredPerson,setHoveredPerson]=useState(null);const[mousePosition,setMousePosition]=useState({x:0,y:0});const[showTooltip,setShowTooltip]=useState(false);const[hoveredAchievement,setHoveredAchievement]=useState(null);const[achievementTooltipPosition,setAchievementTooltipPosition]=useState({x:0,y:0});const[showAchievementTooltip,setShowAchievementTooltip]=useState(false);const[isScrolled,setIsScrolled]=useState(false);const[activeAchievementMarker,setActiveAchievementMarker]=useState(null);const hoverTimerRef=useRef(null);const[filters,setFilters]=useState(()=>{const savedFilters=localStorage.getItem('chronoline-filters');if(savedFilters){const parsed=JSON.parse(savedFilters);return{categories:parsed.categories||[],countries:parsed.countries||[],timeRange:parsed.timeRange||{start:-800,end:2000},showAchievements:parsed.showAchievements!==undefined?parsed.showAchievements:true};}return{categories:[],countries:[],timeRange:{start:-800,end:2000},showAchievements:true};});// Сохраняем фильтры в localStorage при изменении\nuseEffect(()=>{localStorage.setItem('chronoline-filters',JSON.stringify(filters));},[filters]);// Очищаем таймер при размонтировании компонента\nuseEffect(()=>{return()=>{if(hoverTimerRef.current){clearTimeout(hoverTimerRef.current);}};},[]);const[persons,setPersons]=useState([]);const[allCategories,setAllCategories]=useState([]);const[allCountries,setAllCountries]=useState([]);const[isLoading,setIsLoading]=useState(true);// Единый useEffect для загрузки и фильтрации данных\nuseEffect(()=>{const fetchData=async()=>{try{setIsLoading(true);// Формируем параметры для запроса\nconst filtersToApply={};if(filters.categories.length>0){filtersToApply.category=filters.categories.join(',');}if(filters.countries.length>0){filtersToApply.country=filters.countries.join(',');}filtersToApply.startYear=filters.timeRange.start;filtersToApply.endYear=filters.timeRange.end;// Загружаем персон с учетом фильтров\nconst personsData=await getPersons(filtersToApply);setPersons(personsData);// Загружаем категории и страны только если они еще не загружены\nif(allCategories.length===0||allCountries.length===0){const[categoriesData,countriesData]=await Promise.all([getCategories(),getCountries()]);setAllCategories(categoriesData);setAllCountries(countriesData);}}catch(error){console.error(\"Ошибка при загрузке данных:\",error);}finally{setIsLoading(false);}};fetchData();},[filters]);// Перезагружаем данные при изменении фильтров\n// Функция для получения приоритета категории\nconst getCategoryPriority=category=>{// Используем все категории из API, а не только жестко заданные\nreturn allCategories.indexOf(category);};// Функция фильтрации данных (теперь данные фильтруются на бэкенде, но сортировка остается)\nconst sortedData=[...persons].sort((a,b)=>{// Сначала сортируем по категориям\nconst categoryDiff=getCategoryPriority(a.category)-getCategoryPriority(b.category);if(categoryDiff!==0){return categoryDiff;}// Затем по году рождения\nreturn a.birthYear-b.birthYear;});// Отслеживаем скролл\nuseEffect(()=>{const handleScroll=()=>{const scrollTop=window.pageYOffset||document.documentElement.scrollTop;setIsScrolled(scrollTop>50);};window.addEventListener('scroll',handleScroll);return()=>window.removeEventListener('scroll',handleScroll);},[]);// Вычисляем реальный диапазон лет из отфильтрованных данных\nconst minYear=Math.min(...sortedData.map(p=>p.birthYear),filters.timeRange.start);const maxYear=Math.max(...sortedData.map(p=>p.deathYear),filters.timeRange.end);const totalYears=maxYear-minYear;// Настройки масштаба\nconst pixelsPerYear=3;// 3 пикселя на год\nconst LEFT_PADDING_PX=30;// отступ слева, чтобы крайняя левая подпись не упиралась в край\nconst timelineWidth=totalYears*pixelsPerYear+LEFT_PADDING_PX;// Функция для вычисления позиции в пикселях\nconst getPosition=year=>{return LEFT_PADDING_PX+(year-minYear)*pixelsPerYear;};// Функция для вычисления ширины полоски в пикселях\nconst getWidth=(birthYear,deathYear)=>{return(deathYear-birthYear)*pixelsPerYear;};// Генерируем границы веков\nconst generateCenturyBoundaries=()=>{const boundaries=[];const startCentury=Math.floor(minYear/100)*100;const endCentury=Math.ceil(maxYear/100)*100;for(let year=startCentury;year<=endCentury;year+=100){// Включаем границу, если она попадает в диапазон данных или является границей века\nif(year<=maxYear){boundaries.push(year);}}return boundaries;};const centuryBoundaries=generateCenturyBoundaries();// Функция для получения цвета века\nconst getCenturyColor=year=>{const colors=['rgba(255, 107, 107, 0.1)',// Светло-красный\n'rgba(78, 205, 196, 0.1)',// Светло-голубой\n'rgba(150, 206, 180, 0.1)',// Светло-зеленый\n'rgba(255, 234, 167, 0.1)',// Светло-оранжевый\n'rgba(221, 160, 221, 0.1)',// Светло-фиолетовый\n'rgba(120, 219, 255, 0.1)',// Светло-бирюзовый\n'rgba(255, 255, 229, 0.1)',// Светло-желтый\n'rgba(255, 229, 240, 0.1)'// Светло-розовый\n];const centuryIndex=Math.floor((year-minYear)/100);return colors[centuryIndex%colors.length];};// Функция для конвертации в римские цифры\nconst toRomanNumeral=num=>{const romanNumerals=[{value:1000,numeral:'M'},{value:900,numeral:'CM'},{value:500,numeral:'D'},{value:400,numeral:'CD'},{value:100,numeral:'C'},{value:90,numeral:'XC'},{value:50,numeral:'L'},{value:40,numeral:'XL'},{value:10,numeral:'X'},{value:9,numeral:'IX'},{value:5,numeral:'V'},{value:4,numeral:'IV'},{value:1,numeral:'I'}];let result='';let remaining=Math.abs(num);for(const{value,numeral}of romanNumerals){while(remaining>=value){result+=numeral;remaining-=value;}}return num<0?`-${result}`:result;};// Функция для получения номера века\nconst getCenturyNumber=year=>{if(year<0){// Для отрицательных лет: -1 до -100 = 1 век до н.э., -101 до -200 = 2 век до н.э.\nreturn Math.floor((Math.abs(year)-1)/100)+1;}else if(year===0){// Год 0 не существует в исторической хронологии\nreturn 1;}else{// Для положительных лет: 1-100 = 1 век, 101-200 = 2 век и т.д.\nreturn Math.floor((year-1)/100)+1;}};// Алгоритм размещения полосок на строках с полной группировкой по категориям\nconst calculateRowPlacement=people=>{const rows=[];const categoryGroups={};// Группируем людей по категориям\npeople.forEach(person=>{if(!categoryGroups[person.category]){categoryGroups[person.category]=[];}categoryGroups[person.category].push(person);});// Обрабатываем каждую категорию в заданном порядке\nallCategories.forEach(category=>{if(categoryGroups[category]){const categoryPeople=categoryGroups[category];const categoryRows=[];// Размещаем людей данной категории в отдельные строки\ncategoryPeople.forEach(person=>{let placed=false;// Проверяем каждую существующую строку для этой категории\nfor(let rowIndex=0;rowIndex<categoryRows.length;rowIndex++){const row=categoryRows[rowIndex];let canPlaceInRow=true;// Проверяем, не пересекается ли с кем-то в этой строке\nfor(const existingPerson of row){const BUFFER=20;// минимальный зазор между персонами\nif(person.birthYear-BUFFER<=existingPerson.deathYear&&person.deathYear+BUFFER>=existingPerson.birthYear){canPlaceInRow=false;break;}}// Если можно разместить в этой строке\nif(canPlaceInRow){categoryRows[rowIndex].push(person);placed=true;break;}}// Если не удалось разместить в существующих строках, создаем новую\nif(!placed){categoryRows.push([person]);}});// Добавляем строки данной категории к общему списку\nrows.push(...categoryRows);// Добавляем пустую строку для визуального разделения (кроме последней категории)\nif(category!==allCategories[allCategories.length-1]){rows.push([]);}}});return rows;};// Получаем размещение по строкам\nconst rowPlacement=calculateRowPlacement(sortedData);// Вычисляем общую высоту с учетом пустых строк\nconst totalHeight=rowPlacement.reduce((height,row)=>{return height+(row.length===0?20:70);// 20px для пустых строк, 70px для обычных (60px + 10px margin)\n},0);// Функция для создания разделителей категорий\n// Высота строки и отступ вниз для непустой строки\nconst ROW_HEIGHT=60;const ROW_MARGIN=10;// margin-bottom, используется только для непустых строк\nconst EMPTY_ROW_HEIGHT=20;// Подсчитываем абсолютный top каждой строки, чтобы точно позиционировать разделители\nconst rowTops=[];(()=>{let acc=0;rowPlacement.forEach(row=>{rowTops.push(acc);if(row.length===0){acc+=EMPTY_ROW_HEIGHT;}else{acc+=ROW_HEIGHT+ROW_MARGIN;}});})();const createCategoryDividers=()=>{const dividers=[];let currentCategory='';rowPlacement.forEach((row,rowIndex)=>{if(row.length>0){const firstPersonInRow=row[0];if(firstPersonInRow.category!==currentCategory){if(currentCategory!==''){// закрываем предыдущую категорию\ndividers.push({category:currentCategory,top:rowTops[rowIndex]-5});}currentCategory=firstPersonInRow.category;}}});// Добавляем разделитель для последней категории\nif(currentCategory!==''){dividers.push({category:currentCategory,top:rowTops[rowPlacement.length-1]-5});}return dividers;};const categoryDividers=createCategoryDividers();return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(\"header\",{className:`app-header ${isScrolled?'scrolled':''}`,style:{padding:isScrolled?'0.5rem 1.5rem':'1rem 1.5rem',transition:'all 0.3s ease'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'space-between',flexWrap:'wrap',gap:'1.5rem',position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:isScrolled?'1.5rem':'2rem',margin:0,transition:'font-size 0.3s ease'},children:\"Chronoline\"}),!isScrolled&&/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'0.9rem',opacity:0.8,margin:'0.25rem 0 0 0',transition:'opacity 0.3s ease'},children:\"\\u0412\\u0440\\u0435\\u043C\\u0435\\u043D\\u043D\\u044B\\u0435 \\u043B\\u0438\\u043D\\u0438\\u0438 \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u0447\\u0435\\u0441\\u043A\\u0438\\u0445 \\u043B\\u0438\\u0447\\u043D\\u043E\\u0441\\u0442\\u0435\\u0439\"})]}),/*#__PURE__*/_jsx(FilterPanel,{filters:filters,setFilters:setFilters,allCategories:allCategories,allCountries:allCountries})]})}),/*#__PURE__*/_jsxs(\"main\",{className:\"app-main\",children:[isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"loading-overlay\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-container\",style:{position:'relative',height:'calc(100vh - 140px)',overflow:'auto',padding:'1rem 0 2rem 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'0',left:'0',width:`${timelineWidth}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:1},children:centuryBoundaries.map((year,index)=>{const nextYear=centuryBoundaries[index+1]||year+100;const startPos=getPosition(year);const endPos=getPosition(nextYear);const width=endPos-startPos;// Вычисляем век на основе центра года в столетии\nconst centerYear=year+50;const centuryNumber=getCenturyNumber(centerYear);// Для отрицательных веков добавляем знак минус\nconst isNegativeCentury=year<0;const romanNumeral=isNegativeCentury?`-${toRomanNumeral(Math.abs(centuryNumber))}`:toRomanNumeral(centuryNumber);return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${startPos}px`,width:`${width}px`,height:'100%',background:getCenturyColor(year),opacity:0.3,zIndex:1},children:/*#__PURE__*/_jsx(\"div\",{className:\"century-label\",style:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',fontSize:'2rem',fontWeight:'bold',color:'rgba(244, 228, 193, 0.6)',textShadow:'2px 2px 4px rgba(0, 0, 0, 0.8)',pointerEvents:'none',zIndex:2,fontFamily:'serif'},children:romanNumeral})},`century-bg-${year}`);})}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'0',left:'0',width:`${timelineWidth}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:5},children:centuryBoundaries.map(year=>/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${getPosition(year)}px`,width:'2px',height:'100%',background:'linear-gradient(to bottom, #cd853f 0%, #cd853f 20%, rgba(205, 133, 63, 0.3) 100%)',zIndex:5}},`century-line-${year}`))}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'0',left:'0',width:`${timelineWidth}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:8},children:categoryDividers.map(divider=>/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:`${divider.top}px`,left:'0',width:'100%',height:'10px',background:`linear-gradient(to right, transparent 0%, ${getCategoryColor(divider.category)} 20%, ${getCategoryColor(divider.category)} 80%, transparent 100%)`,opacity:0.6,zIndex:8},children:/*#__PURE__*/_jsx(\"div\",{className:\"category-label\",style:{position:'absolute',left:'20px',top:'50%',transform:'translateY(-50%)',background:getCategoryColor(divider.category),color:'white',padding:'2px 8px',borderRadius:'4px',fontSize:'0.7rem',fontWeight:'bold',whiteSpace:'nowrap',zIndex:9},children:divider.category})},`category-divider-${divider.category}`))}),/*#__PURE__*/_jsx(\"div\",{style:{position:'relative',width:`${timelineWidth}px`,height:`${totalHeight+60}px`,zIndex:10},children:rowPlacement.map((row,rowIndex)=>/*#__PURE__*/_jsx(\"div\",{style:{position:'relative',height:row.length===0?'20px':'60px',marginBottom:row.length===0?'0px':'10px'},children:row.map(person=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',left:`${getPosition(person.birthYear)}px`,top:0,fontSize:'11px',color:'rgba(244, 228, 193, 0.6)',fontStyle:'italic',fontWeight:400,transform:'translateX(-100%) translateY(-10px)'},children:person.birthYear}),person.reignStart&&/*#__PURE__*/_jsxs(\"span\",{className:\"reign-label\",style:{position:'absolute',left:`${getPosition(person.reignStart)}px`,top:0,fontSize:'11px',color:'#E57373',// Темно-красный\nfontStyle:'italic',fontWeight:'bold',transform:'translateX(-100%) translateY(-22px)'},children:[\"\\uD83D\\uDC51 \",person.reignStart]}),person.reignEnd&&/*#__PURE__*/_jsx(\"span\",{className:\"reign-label\",style:{position:'absolute',left:`${getPosition(person.reignEnd)}px`,top:0,fontSize:'11px',color:'#E57373',// Темно-красный\nfontStyle:'italic',fontWeight:'bold',transform:'translateY(-22px)'},children:person.reignEnd}),/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',left:`${getPosition(person.deathYear)}px`,top:0,fontSize:'11px',color:'rgba(244, 228, 193, 0.6)',fontStyle:'italic',fontWeight:400,transform:'translateY(-10px)'},children:person.deathYear}),filters.showAchievements&&[person.achievementYear1,person.achievementYear2,person.achievementYear3].filter(year=>year!==undefined&&year!==null).map((year,index)=>{return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${getPosition(year)}px`,top:'-4px',width:'2px',height:'15px',backgroundColor:getCategoryColorDark(person.category),zIndex:(activeAchievementMarker===null||activeAchievementMarker===void 0?void 0:activeAchievementMarker.personId)===person.id&&(activeAchievementMarker===null||activeAchievementMarker===void 0?void 0:activeAchievementMarker.index)===index?10:3,transform:'translateX(-50%)',cursor:'pointer',transition:'all 0.2s ease'},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=getCategoryColor(person.category);e.currentTarget.style.boxShadow=`0 0 3px ${getCategoryColor(person.category)}`;// Находим span внутри и обновляем его стили\nconst span=e.currentTarget.querySelector('span');if(span){span.style.backgroundColor='rgba(44, 24, 16, 0.95)';span.style.borderColor=getCategoryColor(person.category);span.style.color=getCategoryColor(person.category);span.style.fontSize='9px';span.style.padding='2px 4px';span.style.borderRadius='3px';}// Устанавливаем активный маркер\nsetActiveAchievementMarker({personId:person.id,index});// Очищаем предыдущий таймер если он есть\nif(hoverTimerRef.current){clearTimeout(hoverTimerRef.current);}// Запускаем таймер для показа tooltip\nhoverTimerRef.current=setTimeout(()=>{setHoveredAchievement({person,year:year,index});setAchievementTooltipPosition({x:e.clientX,y:e.clientY});setShowAchievementTooltip(true);},500);},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=getCategoryColorDark(person.category);e.currentTarget.style.boxShadow='none';// Возвращаем стили span к исходным\nconst span=e.currentTarget.querySelector('span');if(span){span.style.backgroundColor='rgba(44, 24, 16, 0.9)';span.style.borderColor=getCategoryColorDark(person.category);span.style.color=getCategoryColorDark(person.category);span.style.fontSize='8px';span.style.padding='1px 3px';span.style.borderRadius='2px';}// Сбрасываем активный маркер\nsetActiveAchievementMarker(null);// Очищаем таймер и скрываем tooltip\nif(hoverTimerRef.current){clearTimeout(hoverTimerRef.current);hoverTimerRef.current=null;}setShowAchievementTooltip(false);setHoveredAchievement(null);},onMouseMove:e=>{setAchievementTooltipPosition({x:e.clientX,y:e.clientY});},onMouseOut:e=>{// Дополнительная проверка на случай, если onMouseLeave не сработал\nif(!e.currentTarget.contains(e.relatedTarget)){setActiveAchievementMarker(null);if(hoverTimerRef.current){clearTimeout(hoverTimerRef.current);hoverTimerRef.current=null;}setShowAchievementTooltip(false);setHoveredAchievement(null);}},children:/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',top:'-12px',left:'50%',transform:'translateX(-50%)',fontSize:'8px',color:getCategoryColorDark(person.category),fontWeight:'bold',whiteSpace:'nowrap',backgroundColor:'rgba(44, 24, 16, 0.9)',padding:'1px 3px',borderRadius:'2px',border:`1px solid ${getCategoryColorDark(person.category)}`,transition:'all 0.2s ease'},children:year})},index);}),person.reignStart&&person.reignEnd&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'-15px',left:`${getPosition(person.reignStart)}px`,width:`${getWidth(person.reignStart,person.reignEnd)}px`,height:'65px',backgroundColor:'rgba(211, 47, 47, 0.25)',pointerEvents:'none',borderLeft:'2px solid #D32F2F',borderRight:'2px solid #D32F2F',borderRadius:'3px',zIndex:1}}),/*#__PURE__*/_jsx(\"div\",{className:\"life-bar\",style:{position:'absolute',top:'10px',left:`${getPosition(person.birthYear)}px`,width:`${getWidth(person.birthYear,person.deathYear)}px`,height:'40px',background:`linear-gradient(135deg, ${getCategoryColorMuted(person.category)} 0%, #6a5a3a 100%)`,borderRadius:'6px',cursor:'pointer',display:'flex',alignItems:'center',padding:'0 12px',color:'white',fontSize:'14px',fontWeight:'bold',minWidth:'60px',boxShadow:'0 2px 8px rgba(0,0,0,0.15)',border:'1.5px solid #a8926a',opacity:1,zIndex:5},onMouseEnter:e=>{e.currentTarget.style.transform='translateY(-3px) scale(1.02)';e.currentTarget.style.boxShadow='0 8px 25px rgba(0, 0, 0, 0.4)';e.currentTarget.style.borderColor='rgba(255, 255, 255, 0.4)';setHoveredPerson(person);setMousePosition({x:e.clientX,y:e.clientY});setTimeout(()=>setShowTooltip(true),300);},onMouseLeave:e=>{e.currentTarget.style.transform='translateY(0) scale(1)';e.currentTarget.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.3)';e.currentTarget.style.borderColor='rgba(255, 255, 255, 0.2)';setHoveredPerson(null);setShowTooltip(false);},onMouseMove:e=>{setMousePosition({x:e.clientX,y:e.clientY});},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',lineHeight:'1.2'},children:/*#__PURE__*/_jsx(\"span\",{children:person.name})})})]},person.id))},rowIndex))})]})]}),hoveredPerson&&showTooltip&&/*#__PURE__*/_jsxs(\"div\",{className:\"tooltip\",style:{position:'fixed',left:`${mousePosition.x+15}px`,top:`${mousePosition.y-10}px`,padding:'1rem',zIndex:1000,maxWidth:'300px',minWidth:'250px',color:'#f4e4c1',pointerEvents:'none',opacity:0,transform:'translateY(10px) scale(0.95)',animation:'tooltipFadeIn 0.2s ease-out forwards'},children:[hoveredPerson.imageUrl&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'0.75rem',textAlign:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:hoveredPerson.imageUrl,alt:hoveredPerson.name,style:{width:'80px',height:'80px',borderRadius:'50%',objectFit:'cover',border:`2px solid ${getCategoryColor(hoveredPerson.category)}`,boxShadow:'0 2px 8px rgba(0, 0, 0, 0.3)'},onError:e=>{// Скрываем изображение если оно не загрузилось\ne.currentTarget.style.display='none';}})}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 0.5rem 0',color:getCategoryColor(hoveredPerson.category),fontSize:'1.1rem',fontWeight:'bold'},children:hoveredPerson.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.85rem',lineHeight:'1.4'},children:[/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.25rem 0',fontWeight:'bold'},children:[hoveredPerson.birthYear,\" - \",hoveredPerson.deathYear]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.25rem 0'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:getCategoryColor(hoveredPerson.category),fontWeight:'bold'},children:hoveredPerson.category}),\" \\u2022 \",hoveredPerson.country]}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0.5rem 0',fontStyle:'italic',opacity:0.8},children:hoveredPerson.description}),filters.showAchievements&&[hoveredPerson.achievementYear1,hoveredPerson.achievementYear2,hoveredPerson.achievementYear3].filter(year=>year!==undefined&&year!==null).length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'0.5rem'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{fontSize:'0.8rem',color:getCategoryColor(hoveredPerson.category)},children:\"\\uD83C\\uDFAF \\u041A\\u043B\\u044E\\u0447\\u0435\\u0432\\u044B\\u0435 \\u0434\\u043E\\u0441\\u0442\\u0438\\u0436\\u0435\\u043D\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(\"div\",{style:{margin:'0.25rem 0 0 0',fontSize:'0.8rem'},children:[hoveredPerson.achievementYear1,hoveredPerson.achievementYear2,hoveredPerson.achievementYear3].filter(year=>year!==undefined&&year!==null).map((year,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'0.1rem',display:'flex',alignItems:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:getCategoryColor(hoveredPerson.category),fontWeight:'bold',fontSize:'0.75rem'},children:year}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.75rem'},children:hoveredPerson.achievements[index]||'Ключевое достижение'})]},index))})]})]})]}),hoveredAchievement&&showAchievementTooltip&&/*#__PURE__*/_jsx(\"div\",{className:\"achievement-tooltip\",style:{position:'fixed',left:`${achievementTooltipPosition.x+15}px`,top:`${achievementTooltipPosition.y-10}px`,padding:'0.75rem',zIndex:1001,maxWidth:'250px',minWidth:'200px',color:'#f4e4c1',pointerEvents:'none',opacity:0,transform:'translateY(10px) scale(0.95)',animation:'tooltipFadeIn 0.2s ease-out forwards',backgroundColor:'rgba(44, 24, 16, 0.95)',borderRadius:'6px',border:`2px solid ${getCategoryColor(hoveredAchievement.person.category)}`,boxShadow:'0 4px 12px rgba(0, 0, 0, 0.3)'},children:/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.85rem',lineHeight:'1.4'},children:[hoveredAchievement.person.imageUrl&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'0.5rem',textAlign:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:hoveredAchievement.person.imageUrl,alt:hoveredAchievement.person.name,style:{width:'50px',height:'50px',borderRadius:'50%',objectFit:'cover',border:`2px solid ${getCategoryColor(hoveredAchievement.person.category)}`,boxShadow:'0 2px 6px rgba(0, 0, 0, 0.3)'},onError:e=>{// Скрываем изображение если оно не загрузилось\ne.currentTarget.style.display='none';}})}),/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 0.5rem 0',color:getCategoryColor(hoveredAchievement.person.category),fontSize:'1rem',fontWeight:'bold'},children:hoveredAchievement.person.name}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0.25rem 0',fontWeight:'bold',color:getCategoryColor(hoveredAchievement.person.category),fontSize:'0.9rem'},children:[\"\\uD83C\\uDFAF \",hoveredAchievement.year]}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0.25rem 0',fontSize:'0.8rem',fontStyle:'italic'},children:hoveredAchievement.person.achievements[hoveredAchievement.index]||'Ключевое достижение'})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","getPersons","getCategories","getCountries","getCategoryColor","getCategoryColorDark","getCategoryColorMuted","jsxs","_jsxs","jsx","_jsx","FilterDropdown","_ref","title","items","selectedItems","onSelectionChange","getItemColor","icon","isActive","length","className","children","style","minWidth","display","alignItems","gap","padding","borderBottom","onClick","e","stopPropagation","marginRight","background","color","border","borderRadius","cursor","fontSize","map","item","type","checked","includes","onChange","target","filter","i","fontWeight","FilterPanel","_ref2","filters","setFilters","allCategories","allCountries","yearInputs","setYearInputs","start","timeRange","toString","end","applyYearFilter","field","value","numValue","parseInt","prev","handleYearKeyPress","key","_e$currentTarget$pare","_e$currentTarget$pare2","currentTarget","inputs","parentElement","querySelectorAll","currentIndex","Array","from","indexOf","nextInput","focus","resetAllFilters","categories","countries","showAchievements","boxShadow","flexWrap","marginLeft","zIndex","width","height","viewBox","fill","d","marginBottom","onBlur","onKeyPress","transition","margin","accentColor","opacity","App","hoveredPerson","setHoveredPerson","mousePosition","setMousePosition","x","y","showTooltip","setShowTooltip","hoveredAchievement","setHoveredAchievement","achievementTooltipPosition","setAchievementTooltipPosition","showAchievementTooltip","setShowAchievementTooltip","isScrolled","setIsScrolled","activeAchievementMarker","setActiveAchievementMarker","hoverTimerRef","savedFilters","localStorage","getItem","parsed","JSON","parse","undefined","setItem","stringify","current","clearTimeout","persons","setPersons","setAllCategories","setAllCountries","isLoading","setIsLoading","fetchData","filtersToApply","category","join","country","startYear","endYear","personsData","categoriesData","countriesData","Promise","all","error","console","getCategoryPriority","sortedData","sort","a","b","categoryDiff","birthYear","handleScroll","scrollTop","window","pageYOffset","document","documentElement","addEventListener","removeEventListener","minYear","Math","min","p","maxYear","max","deathYear","totalYears","pixelsPerYear","LEFT_PADDING_PX","timelineWidth","getPosition","year","getWidth","generateCenturyBoundaries","boundaries","startCentury","floor","endCentury","ceil","push","centuryBoundaries","getCenturyColor","colors","centuryIndex","toRomanNumeral","num","romanNumerals","numeral","result","remaining","abs","getCenturyNumber","calculateRowPlacement","people","rows","categoryGroups","forEach","person","categoryPeople","categoryRows","placed","rowIndex","row","canPlaceInRow","existingPerson","BUFFER","rowPlacement","totalHeight","reduce","ROW_HEIGHT","ROW_MARGIN","EMPTY_ROW_HEIGHT","rowTops","acc","createCategoryDividers","dividers","currentCategory","firstPersonInRow","top","categoryDividers","justifyContent","position","overflow","left","pointerEvents","index","nextYear","startPos","endPos","centerYear","centuryNumber","isNegativeCentury","romanNumeral","transform","textShadow","fontFamily","divider","whiteSpace","Fragment","fontStyle","reignStart","reignEnd","achievementYear1","achievementYear2","achievementYear3","backgroundColor","personId","id","onMouseEnter","span","querySelector","borderColor","setTimeout","clientX","clientY","onMouseLeave","onMouseMove","onMouseOut","contains","relatedTarget","borderLeft","borderRight","flexDirection","lineHeight","name","maxWidth","animation","imageUrl","textAlign","src","alt","objectFit","onError","description","marginTop","achievements"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport { Person } from './types'\nimport { getPersons, getCategories, getCountries } from './services/api'\nimport { getCategoryColor, getCategoryColorDark, getCategoryColorMuted } from './utils/categoryColors'\nimport './App.css'\n\n// Компонент выпадающего фильтра\nconst FilterDropdown = ({ \n  title, \n  items, \n  selectedItems, \n  onSelectionChange, \n  getItemColor,\n  icon\n}: {\n  title: string\n  items: string[]\n  selectedItems: string[]\n  onSelectionChange: (items: string[]) => void\n  getItemColor?: (item: string) => string\n  icon?: React.ReactNode\n}) => {\n  const isActive = selectedItems.length > 0\n  \n  return (\n    <div className=\"filter-dropdown\">\n      <button \n        className={`filter-btn ${isActive ? 'active' : ''}`}\n        style={{ minWidth: '150px', display: 'flex', alignItems: 'center', gap: '0.5rem' }}\n      >\n        {icon}\n        {title} {isActive && `(${selectedItems.length})`}\n      </button>\n      <div className=\"filter-dropdown-content\">\n        <div style={{ padding: '0.5rem', borderBottom: '1px solid rgba(139, 69, 19, 0.3)' }}>\n          <button\n            onClick={(e) => {\n              e.stopPropagation()\n              onSelectionChange(items)\n            }}\n            style={{\n              padding: '0.25rem 0.5rem',\n              marginRight: '0.5rem',\n              background: '#27ae60',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer',\n              fontSize: '0.7rem'\n            }}\n          >\n            Выбрать все\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation()\n              onSelectionChange([])\n            }}\n            style={{\n              padding: '0.25rem 0.5rem',\n              background: '#e74c3c',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer',\n              fontSize: '0.7rem'\n            }}\n          >\n            Снять все\n          </button>\n        </div>\n        {items.map(item => (\n          <label key={item} className=\"filter-checkbox\" onClick={(e) => e.stopPropagation()}>\n            <input\n              type=\"checkbox\"\n              checked={selectedItems.includes(item)}\n              onChange={(e) => {\n                e.stopPropagation()\n                if (e.target.checked) {\n                  onSelectionChange([...selectedItems, item])\n                } else {\n                  onSelectionChange(selectedItems.filter(i => i !== item))\n                }\n              }}\n            />\n            <span style={{ \n              color: getItemColor ? getItemColor(item) : '#f4e4c1',\n              fontWeight: getItemColor ? 'bold' : 'normal'\n            }}>\n              {item}\n            </span>\n          </label>\n        ))}\n      </div>\n    </div>\n  )\n}\n\n// Компонент панели фильтров\nconst FilterPanel = ({ \n  filters, \n  setFilters, \n  allCategories, \n  allCountries \n}: {\n  filters: {\n    categories: string[]\n    countries: string[]\n    timeRange: { start: number; end: number }\n    showAchievements: boolean\n  }\n  setFilters: React.Dispatch<React.SetStateAction<{\n    categories: string[]\n    countries: string[]\n    timeRange: { start: number; end: number }\n    showAchievements: boolean\n  }>>\n  allCategories: string[]\n  allCountries: string[]\n}) => {\n  // Состояние для полей ввода годов\n  const [yearInputs, setYearInputs] = useState({\n    start: filters.timeRange.start.toString(),\n    end: filters.timeRange.end.toString()\n  })\n\n  // Функция для применения фильтра по году\n  const applyYearFilter = (field: 'start' | 'end', value: string) => {\n    const numValue = parseInt(value) || (field === 'start' ? -800 : 2000)\n    setFilters(prev => ({\n      ...prev,\n      timeRange: { ...prev.timeRange, [field]: numValue }\n    }))\n  }\n\n  // Функция для обработки нажатия Enter\n  const handleYearKeyPress = (field: 'start' | 'end', e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter') {\n      applyYearFilter(field, e.currentTarget.value)\n      // Переводим фокус на следующий элемент\n      const inputs = e.currentTarget.parentElement?.parentElement?.querySelectorAll('input')\n      if (inputs) {\n        const currentIndex = Array.from(inputs).indexOf(e.currentTarget)\n        const nextInput = inputs[currentIndex + 1] as HTMLInputElement\n        if (nextInput) {\n          nextInput.focus()\n        }\n      }\n    }\n  }\n\n  // Функция для сброса всех фильтров\n  const resetAllFilters = () => {\n    setFilters({\n      categories: [],\n      countries: [],\n      timeRange: { start: -800, end: 2000 },\n      showAchievements: true\n    })\n    setYearInputs({\n      start: '-800',\n      end: '2000'\n    })\n  }\n\n  return (\n    <div className=\"filters-panel\" style={{\n      background: 'none',\n      border: 'none',\n      boxShadow: 'none',\n      padding: 0,\n      display: 'flex',\n      gap: '1rem',\n      alignItems: 'center',\n      flexWrap: 'wrap',\n      marginLeft: 'auto',\n      zIndex: 10001\n    }}>\n      <FilterDropdown\n        title=\"Род деятельности\"\n        items={allCategories}\n        selectedItems={filters.categories}\n        onSelectionChange={(categories) => setFilters(prev => ({ ...prev, categories }))}\n        getItemColor={getCategoryColor}\n        icon={\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n          </svg>\n        }\n      />\n      <FilterDropdown\n        title=\"Страна происхождения\"\n        items={allCountries}\n        selectedItems={filters.countries}\n        onSelectionChange={(countries) => setFilters(prev => ({ ...prev, countries }))}\n        icon={\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>\n          </svg>\n        }\n      />\n      <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n        <div>\n          <label style={{ fontSize: '0.8rem', display: 'block', marginBottom: '0.25rem', color: '#f4e4c1' }}>\n            От:\n          </label>\n          <input\n            type=\"number\"\n            value={yearInputs.start}\n            onChange={(e) => setYearInputs(prev => ({ ...prev, start: e.target.value }))}\n            onBlur={(e) => applyYearFilter('start', e.target.value)}\n            onKeyPress={(e) => handleYearKeyPress('start', e)}\n            style={{\n              width: '80px',\n              padding: '0.5rem',\n              border: '2px solid #8b4513',\n              borderRadius: '4px',\n              background: 'rgba(44, 24, 16, 0.8)',\n              color: '#f4e4c1',\n              fontSize: '0.8rem'\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ fontSize: '0.8rem', display: 'block', marginBottom: '0.25rem', color: '#f4e4c1' }}>\n            До:\n          </label>\n          <input\n            type=\"number\"\n            value={yearInputs.end}\n            onChange={(e) => setYearInputs(prev => ({ ...prev, end: e.target.value }))}\n            onBlur={(e) => applyYearFilter('end', e.target.value)}\n            onKeyPress={(e) => handleYearKeyPress('end', e)}\n            style={{\n              width: '80px',\n              padding: '0.5rem',\n              border: '2px solid #8b4513',\n              borderRadius: '4px',\n              background: 'rgba(44, 24, 16, 0.8)',\n              color: '#f4e4c1',\n              fontSize: '0.8rem'\n            }}\n          />\n        </div>\n        <button\n          onClick={resetAllFilters}\n          className=\"filter-btn\"\n          style={{ background: 'linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%)', fontSize: '0.8rem', padding: '0.5rem 1rem' }}\n        >\n          Сбросить\n        </button>\n        \n        {/* Переключатель маркеров достижений */}\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          gap: '0.5rem',\n          padding: '0.5rem',\n          borderRadius: '4px',\n          background: filters.showAchievements ? 'rgba(255, 255, 255, 0.1)' : 'rgba(255, 255, 255, 0.05)',\n          border: `1px solid ${filters.showAchievements ? 'rgba(255, 255, 255, 0.3)' : 'rgba(255, 255, 255, 0.1)'}`,\n          transition: 'all 0.2s ease'\n        }}>\n          <label style={{ \n            fontSize: '0.8rem', \n            color: '#f4e4c1',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            cursor: 'pointer',\n            margin: 0\n          }}>\n            <input\n              type=\"checkbox\"\n              checked={filters.showAchievements}\n              onChange={(e) => setFilters(prev => ({ ...prev, showAchievements: e.target.checked }))}\n              style={{ \n                width: '16px', \n                height: '16px',\n                cursor: 'pointer',\n                accentColor: '#f4e4c1'\n              }}\n            />\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"currentColor\" style={{ opacity: filters.showAchievements ? 1 : 0.5 }}>\n              <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n            </svg>\n            <span>Маркеры достижений</span>\n          </label>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction App() {\n\n  const [hoveredPerson, setHoveredPerson] = useState<Person | null>(null)\n  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 })\n  const [showTooltip, setShowTooltip] = useState(false)\n  const [hoveredAchievement, setHoveredAchievement] = useState<{ person: Person; year: number; index: number } | null>(null)\n  const [achievementTooltipPosition, setAchievementTooltipPosition] = useState({ x: 0, y: 0 })\n  const [showAchievementTooltip, setShowAchievementTooltip] = useState(false)\n  const [isScrolled, setIsScrolled] = useState(false)\n  const [activeAchievementMarker, setActiveAchievementMarker] = useState<{ personId: string; index: number } | null>(null)\n  const hoverTimerRef = useRef<NodeJS.Timeout | null>(null)\n  const [filters, setFilters] = useState(() => {\n    const savedFilters = localStorage.getItem('chronoline-filters');\n    if (savedFilters) {\n      const parsed = JSON.parse(savedFilters);\n      return {\n        categories: parsed.categories || [],\n        countries: parsed.countries || [],\n        timeRange: parsed.timeRange || { start: -800, end: 2000 },\n        showAchievements: parsed.showAchievements !== undefined ? parsed.showAchievements : true\n      };\n    }\n    return {\n      categories: [] as string[],\n      countries: [] as string[],\n      timeRange: { start: -800, end: 2000 },\n      showAchievements: true\n    };\n  })\n\n  // Сохраняем фильтры в localStorage при изменении\n  useEffect(() => {\n    localStorage.setItem('chronoline-filters', JSON.stringify(filters));\n  }, [filters]);\n\n  // Очищаем таймер при размонтировании компонента\n  useEffect(() => {\n    return () => {\n      if (hoverTimerRef.current) {\n        clearTimeout(hoverTimerRef.current);\n      }\n    };\n  }, []);\n  const [persons, setPersons] = useState<Person[]>([])\n  const [allCategories, setAllCategories] = useState<string[]>([])\n  const [allCountries, setAllCountries] = useState<string[]>([])\n  const [isLoading, setIsLoading] = useState(true);\n\n\n  // Единый useEffect для загрузки и фильтрации данных\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        setIsLoading(true);\n\n        // Формируем параметры для запроса\n        const filtersToApply: any = {};\n        if (filters.categories.length > 0) {\n          filtersToApply.category = filters.categories.join(',');\n        }\n        if (filters.countries.length > 0) {\n          filtersToApply.country = filters.countries.join(',');\n        }\n        filtersToApply.startYear = filters.timeRange.start;\n        filtersToApply.endYear = filters.timeRange.end;\n\n        // Загружаем персон с учетом фильтров\n        const personsData = await getPersons(filtersToApply);\n        setPersons(personsData);\n\n        // Загружаем категории и страны только если они еще не загружены\n        if (allCategories.length === 0 || allCountries.length === 0) {\n          const [categoriesData, countriesData] = await Promise.all([\n            getCategories(),\n            getCountries()\n          ]);\n          setAllCategories(categoriesData);\n          setAllCountries(countriesData);\n        }\n      } catch (error) {\n        console.error(\"Ошибка при загрузке данных:\", error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [filters]); // Перезагружаем данные при изменении фильтров\n\n    // Функция для получения приоритета категории\n  const getCategoryPriority = (category: string) => {\n    // Используем все категории из API, а не только жестко заданные\n    return allCategories.indexOf(category)\n  }\n\n  // Функция фильтрации данных (теперь данные фильтруются на бэкенде, но сортировка остается)\n  const sortedData = [...persons].sort((a, b) => {\n    // Сначала сортируем по категориям\n    const categoryDiff = getCategoryPriority(a.category) - getCategoryPriority(b.category)\n    if (categoryDiff !== 0) {\n      return categoryDiff\n    }\n    // Затем по году рождения\n    return a.birthYear - b.birthYear\n  })\n\n  // Отслеживаем скролл\n  useEffect(() => {\n    const handleScroll = () => {\n      const scrollTop = window.pageYOffset || document.documentElement.scrollTop\n      setIsScrolled(scrollTop > 50)\n    }\n\n    window.addEventListener('scroll', handleScroll)\n    return () => window.removeEventListener('scroll', handleScroll)\n  }, [])\n\n\n\n  // Вычисляем реальный диапазон лет из отфильтрованных данных\n  const minYear = Math.min(...sortedData.map(p => p.birthYear), filters.timeRange.start)\n  const maxYear = Math.max(...sortedData.map(p => p.deathYear), filters.timeRange.end)\n  const totalYears = maxYear - minYear\n\n  // Настройки масштаба\n  const pixelsPerYear = 3 // 3 пикселя на год\n  const LEFT_PADDING_PX = 30 // отступ слева, чтобы крайняя левая подпись не упиралась в край\n  const timelineWidth = totalYears * pixelsPerYear + LEFT_PADDING_PX\n\n  // Функция для вычисления позиции в пикселях\n  const getPosition = (year: number) => {\n    return LEFT_PADDING_PX + (year - minYear) * pixelsPerYear\n  }\n\n  // Функция для вычисления ширины полоски в пикселях\n  const getWidth = (birthYear: number, deathYear: number) => {\n    return (deathYear - birthYear) * pixelsPerYear\n  }\n\n  // Генерируем границы веков\n  const generateCenturyBoundaries = () => {\n    const boundaries = []\n    const startCentury = Math.floor(minYear / 100) * 100\n    const endCentury = Math.ceil(maxYear / 100) * 100\n    \n    for (let year = startCentury; year <= endCentury; year += 100) {\n      // Включаем границу, если она попадает в диапазон данных или является границей века\n      if (year <= maxYear) {\n        boundaries.push(year)\n      }\n    }\n    return boundaries\n  }\n\n  const centuryBoundaries = generateCenturyBoundaries()\n\n  // Функция для получения цвета века\n  const getCenturyColor = (year: number) => {\n    const colors = [\n      'rgba(255, 107, 107, 0.1)', // Светло-красный\n      'rgba(78, 205, 196, 0.1)', // Светло-голубой\n      'rgba(150, 206, 180, 0.1)', // Светло-зеленый\n      'rgba(255, 234, 167, 0.1)', // Светло-оранжевый\n      'rgba(221, 160, 221, 0.1)', // Светло-фиолетовый\n      'rgba(120, 219, 255, 0.1)', // Светло-бирюзовый\n      'rgba(255, 255, 229, 0.1)', // Светло-желтый\n      'rgba(255, 229, 240, 0.1)', // Светло-розовый\n    ]\n    \n    const centuryIndex = Math.floor((year - minYear) / 100)\n    return colors[centuryIndex % colors.length]\n  }\n\n  // Функция для конвертации в римские цифры\n  const toRomanNumeral = (num: number): string => {\n    const romanNumerals = [\n      { value: 1000, numeral: 'M' },\n      { value: 900, numeral: 'CM' },\n      { value: 500, numeral: 'D' },\n      { value: 400, numeral: 'CD' },\n      { value: 100, numeral: 'C' },\n      { value: 90, numeral: 'XC' },\n      { value: 50, numeral: 'L' },\n      { value: 40, numeral: 'XL' },\n      { value: 10, numeral: 'X' },\n      { value: 9, numeral: 'IX' },\n      { value: 5, numeral: 'V' },\n      { value: 4, numeral: 'IV' },\n      { value: 1, numeral: 'I' }\n    ]\n\n    let result = ''\n    let remaining = Math.abs(num)\n\n    for (const { value, numeral } of romanNumerals) {\n      while (remaining >= value) {\n        result += numeral\n        remaining -= value\n      }\n    }\n\n    return num < 0 ? `-${result}` : result\n  }\n\n  // Функция для получения номера века\n  const getCenturyNumber = (year: number): number => {\n    if (year < 0) {\n      // Для отрицательных лет: -1 до -100 = 1 век до н.э., -101 до -200 = 2 век до н.э.\n      return Math.floor((Math.abs(year) - 1) / 100) + 1\n    } else if (year === 0) {\n      // Год 0 не существует в исторической хронологии\n      return 1\n    } else {\n      // Для положительных лет: 1-100 = 1 век, 101-200 = 2 век и т.д.\n      return Math.floor((year - 1) / 100) + 1\n    }\n  }\n\n  // Алгоритм размещения полосок на строках с полной группировкой по категориям\n  const calculateRowPlacement = (people: Person[]) => {\n    const rows: Person[][] = []\n    const categoryGroups: { [key: string]: Person[] } = {}\n    \n    // Группируем людей по категориям\n    people.forEach(person => {\n      if (!categoryGroups[person.category]) {\n        categoryGroups[person.category] = []\n      }\n      categoryGroups[person.category].push(person)\n    })\n    \n    // Обрабатываем каждую категорию в заданном порядке\n    allCategories.forEach(category => {\n      if (categoryGroups[category]) {\n        const categoryPeople = categoryGroups[category]\n        const categoryRows: Person[][] = []\n        \n        // Размещаем людей данной категории в отдельные строки\n        categoryPeople.forEach(person => {\n          let placed = false\n          \n          // Проверяем каждую существующую строку для этой категории\n          for (let rowIndex = 0; rowIndex < categoryRows.length; rowIndex++) {\n            const row = categoryRows[rowIndex]\n            let canPlaceInRow = true\n            \n            // Проверяем, не пересекается ли с кем-то в этой строке\n            for (const existingPerson of row) {\n              const BUFFER = 20; // минимальный зазор между персонами\n              if (\n                person.birthYear - BUFFER <= existingPerson.deathYear &&\n                person.deathYear + BUFFER >= existingPerson.birthYear\n              ) {\n                canPlaceInRow = false\n                break\n              }\n            }\n            \n            // Если можно разместить в этой строке\n            if (canPlaceInRow) {\n              categoryRows[rowIndex].push(person)\n              placed = true\n              break\n            }\n          }\n          \n          // Если не удалось разместить в существующих строках, создаем новую\n          if (!placed) {\n            categoryRows.push([person])\n          }\n        })\n        \n        // Добавляем строки данной категории к общему списку\n        rows.push(...categoryRows)\n        \n        // Добавляем пустую строку для визуального разделения (кроме последней категории)\n        if (category !== allCategories[allCategories.length - 1]) {\n          rows.push([])\n        }\n      }\n    })\n    \n    return rows\n  }\n\n  // Получаем размещение по строкам\n  const rowPlacement = calculateRowPlacement(sortedData)\n\n  // Вычисляем общую высоту с учетом пустых строк\n  const totalHeight = rowPlacement.reduce((height, row) => {\n    return height + (row.length === 0 ? 20 : 70) // 20px для пустых строк, 70px для обычных (60px + 10px margin)\n  }, 0)\n\n  // Функция для создания разделителей категорий\n    // Высота строки и отступ вниз для непустой строки\n  const ROW_HEIGHT = 60;\n  const ROW_MARGIN = 10; // margin-bottom, используется только для непустых строк\n  const EMPTY_ROW_HEIGHT = 20;\n\n  // Подсчитываем абсолютный top каждой строки, чтобы точно позиционировать разделители\n  const rowTops: number[] = [];\n  (() => {\n    let acc = 0;\n    rowPlacement.forEach(row => {\n      rowTops.push(acc);\n      if (row.length === 0) {\n        acc += EMPTY_ROW_HEIGHT;\n      } else {\n        acc += ROW_HEIGHT + ROW_MARGIN;\n      }\n    });\n  })();\n\n  const createCategoryDividers = () => {\n    const dividers: { category: string; top: number }[] = [];\n    let currentCategory = '';\n\n    rowPlacement.forEach((row, rowIndex) => {\n      if (row.length > 0) {\n        const firstPersonInRow = row[0];\n        if (firstPersonInRow.category !== currentCategory) {\n          if (currentCategory !== '') {\n            // закрываем предыдущую категорию\n            dividers.push({ category: currentCategory, top: rowTops[rowIndex] - 5 });\n          }\n          currentCategory = firstPersonInRow.category;\n        }\n      }\n    });\n\n    // Добавляем разделитель для последней категории\n    if (currentCategory !== '') {\n      dividers.push({ category: currentCategory, top: rowTops[rowPlacement.length - 1] - 5 });\n    }\n\n    return dividers;\n  };\n\n  const categoryDividers = createCategoryDividers();\n\n\n\n  return (\n    <div className=\"app\">\n      <header \n        className={`app-header ${isScrolled ? 'scrolled' : ''}`}\n        style={{\n          padding: isScrolled ? '0.5rem 1.5rem' : '1rem 1.5rem',\n          transition: 'all 0.3s ease'\n        }}\n      >\n        <div style={{ \n          display: 'flex', \n          alignItems: 'flex-start', \n          justifyContent: 'space-between',\n          flexWrap: 'wrap',\n          gap: '1.5rem',\n          position: 'relative'\n        }}>\n          <div>\n            <h1 style={{ \n              fontSize: isScrolled ? '1.5rem' : '2rem',\n              margin: 0,\n              transition: 'font-size 0.3s ease'\n            }}>\n              Chronoline\n            </h1>\n            {!isScrolled && (\n              <p style={{ \n                fontSize: '0.9rem', \n                opacity: 0.8, \n                margin: '0.25rem 0 0 0',\n                transition: 'opacity 0.3s ease'\n              }}>\n                Временные линии исторических личностей\n              </p>\n            )}\n          </div>\n\n          {/* Фильтры прямо в шапке */}\n          <FilterPanel\n            filters={filters}\n            setFilters={setFilters}\n            allCategories={allCategories}\n            allCountries={allCountries}\n          />\n        </div>\n      </header>\n      \n      <main className=\"app-main\">\n        {isLoading && (\n          <div className=\"loading-overlay\">\n            <div className=\"spinner\"></div>\n            <span>Загрузка данных...</span>\n          </div>\n        )}\n        {/* Временная линия на весь экран */}\n        <div className=\"timeline-container\" style={{ \n          position: 'relative', \n          height: 'calc(100vh - 140px)',\n          overflow: 'auto',\n          padding: '1rem 0 2rem 0'\n        }}>\n\n          {/* Разноцветная заливка веков */}\n          <div style={{\n            position: 'absolute',\n            top: '0',\n            left: '0',\n            width: `${timelineWidth}px`,\n            height: `${totalHeight + 200}px`,\n            pointerEvents: 'none',\n            zIndex: 1\n          }}>\n            {centuryBoundaries.map((year, index) => {\n              const nextYear = centuryBoundaries[index + 1] || (year + 100)\n              const startPos = getPosition(year)\n              const endPos = getPosition(nextYear)\n              const width = endPos - startPos\n\n              // Вычисляем век на основе центра года в столетии\n              const centerYear = year + 50\n              const centuryNumber = getCenturyNumber(centerYear)\n              // Для отрицательных веков добавляем знак минус\n              const isNegativeCentury = year < 0\n              const romanNumeral = isNegativeCentury ? `-${toRomanNumeral(Math.abs(centuryNumber))}` : toRomanNumeral(centuryNumber)\n              \n              return (\n                <div key={`century-bg-${year}`} style={{\n                  position: 'absolute',\n                  left: `${startPos}px`,\n                  width: `${width}px`,\n                  height: '100%',\n                  background: getCenturyColor(year),\n                  opacity: 0.3,\n                  zIndex: 1\n                }}>\n                  {/* Римская цифра века в центре */}\n                  <div className=\"century-label\" style={{\n                    position: 'absolute',\n                    top: '50%',\n                    left: '50%',\n                    transform: 'translate(-50%, -50%)',\n                    fontSize: '2rem',\n                    fontWeight: 'bold',\n                    color: 'rgba(244, 228, 193, 0.6)',\n                    textShadow: '2px 2px 4px rgba(0, 0, 0, 0.8)',\n                    pointerEvents: 'none',\n                    zIndex: 2,\n                    fontFamily: 'serif'\n                  }}>\n                    {romanNumeral}\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n\n          {/* Границы веков на всю высоту */}\n          <div style={{\n            position: 'absolute',\n            top: '0',\n            left: '0',\n            width: `${timelineWidth}px`,\n            height: `${totalHeight + 200}px`,\n            pointerEvents: 'none',\n            zIndex: 5\n          }}>\n            {centuryBoundaries.map((year) => (\n              <div key={`century-line-${year}`} style={{\n                position: 'absolute',\n                left: `${getPosition(year)}px`,\n                width: '2px',\n                height: '100%',\n                background: 'linear-gradient(to bottom, #cd853f 0%, #cd853f 20%, rgba(205, 133, 63, 0.3) 100%)',\n                zIndex: 5\n              }} />\n            ))}\n          </div>\n\n          {/* Разделители категорий */}\n          <div style={{\n            position: 'absolute',\n            top: '0',\n            left: '0',\n            width: `${timelineWidth}px`,\n            height: `${totalHeight + 200}px`,\n            pointerEvents: 'none',\n            zIndex: 8\n          }}>\n            {categoryDividers.map((divider) => (\n              <div key={`category-divider-${divider.category}`} style={{\n                position: 'absolute',\n                top: `${divider.top}px`,\n                left: '0',\n                width: '100%',\n                height: '10px',\n                background: `linear-gradient(to right, transparent 0%, ${getCategoryColor(divider.category)} 20%, ${getCategoryColor(divider.category)} 80%, transparent 100%)`,\n                opacity: 0.6,\n                zIndex: 8\n              }}>\n                <div className=\"category-label\" style={{\n                  position: 'absolute',\n                  left: '20px',\n                  top: '50%',\n                  transform: 'translateY(-50%)',\n                  background: getCategoryColor(divider.category),\n                  color: 'white',\n                  padding: '2px 8px',\n                  borderRadius: '4px',\n                  fontSize: '0.7rem',\n                  fontWeight: 'bold',\n                  whiteSpace: 'nowrap',\n                  zIndex: 9\n                }}>\n                  {divider.category}\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {/* Полоски жизни */}\n          <div style={{ \n            position: 'relative',\n            width: `${timelineWidth}px`,\n            height: `${totalHeight + 60}px`,\n            zIndex: 10\n          }}>\n            {rowPlacement.map((row, rowIndex) => (\n              <div key={rowIndex} style={{\n                position: 'relative',\n                height: row.length === 0 ? '20px' : '60px',\n                marginBottom: row.length === 0 ? '0px' : '10px'\n              }}>\n                {row.map((person) => (\n                  <React.Fragment key={person.id}>\n                    {/* Годы жизни и правления над полоской */}\n                    <span style={{\n                      position: 'absolute',\n                      left: `${getPosition(person.birthYear)}px`,\n                      top: 0,\n                      fontSize: '11px',\n                      color: 'rgba(244, 228, 193, 0.6)',\n                      fontStyle: 'italic',\n                      fontWeight: 400,\n                      transform: 'translateX(-100%) translateY(-10px)'\n                    }}>{person.birthYear}</span>\n\n                    {person.reignStart && (\n                      <span className=\"reign-label\" style={{\n                        position: 'absolute',\n                        left: `${getPosition(person.reignStart)}px`,\n                        top: 0,\n                        fontSize: '11px',\n                        color: '#E57373', // Темно-красный\n                        fontStyle: 'italic',\n                        fontWeight: 'bold',\n                        transform: 'translateX(-100%) translateY(-22px)'\n                      }}>👑 {person.reignStart}</span>\n                    )}\n\n                    {person.reignEnd && (\n                      <span className=\"reign-label\" style={{\n                        position: 'absolute',\n                        left: `${getPosition(person.reignEnd)}px`,\n                        top: 0,\n                        fontSize: '11px',\n                        color: '#E57373', // Темно-красный\n                        fontStyle: 'italic',\n                        fontWeight: 'bold',\n                        transform: 'translateY(-22px)'\n                      }}>{person.reignEnd}</span>\n                    )}\n                    \n                    <span style={{\n                      position: 'absolute',\n                      left: `${getPosition(person.deathYear)}px`,\n                      top: 0,\n                      fontSize: '11px',\n                      color: 'rgba(244, 228, 193, 0.6)',\n                      fontStyle: 'italic',\n                      fontWeight: 400,\n                      transform: 'translateY(-10px)'\n                    }}>{person.deathYear}</span>\n\n                    {/* Маркеры ключевых достижений */}\n                    {filters.showAchievements && [person.achievementYear1, person.achievementYear2, person.achievementYear3]\n                      .filter(year => year !== undefined && year !== null)\n                      .map((year, index) => {\n                        return (\n                          <div key={index} style={{\n                            position: 'absolute',\n                            left: `${getPosition(year as number)}px`,\n                            top: '-4px',\n                            width: '2px',\n                            height: '15px',\n                            backgroundColor: getCategoryColorDark(person.category),\n                            zIndex: activeAchievementMarker?.personId === person.id && activeAchievementMarker?.index === index ? 10 : 3,\n                            transform: 'translateX(-50%)',\n                            cursor: 'pointer',\n                            transition: 'all 0.2s ease'\n                          }}\n                          onMouseEnter={(e) => {\n                            e.currentTarget.style.backgroundColor = getCategoryColor(person.category);\n                            e.currentTarget.style.boxShadow = `0 0 3px ${getCategoryColor(person.category)}`;\n                            // Находим span внутри и обновляем его стили\n                            const span = e.currentTarget.querySelector('span');\n                            if (span) {\n                              span.style.backgroundColor = 'rgba(44, 24, 16, 0.95)';\n                              span.style.borderColor = getCategoryColor(person.category);\n                              span.style.color = getCategoryColor(person.category);\n                              span.style.fontSize = '9px';\n                              span.style.padding = '2px 4px';\n                              span.style.borderRadius = '3px';\n                            }\n                            \n                            // Устанавливаем активный маркер\n                            setActiveAchievementMarker({ personId: person.id, index });\n                            \n                            // Очищаем предыдущий таймер если он есть\n                            if (hoverTimerRef.current) {\n                              clearTimeout(hoverTimerRef.current);\n                            }\n                            \n                            // Запускаем таймер для показа tooltip\n                            hoverTimerRef.current = setTimeout(() => {\n                              setHoveredAchievement({ person, year: year as number, index });\n                              setAchievementTooltipPosition({ x: e.clientX, y: e.clientY });\n                              setShowAchievementTooltip(true);\n                            }, 500);\n                          }}\n                          onMouseLeave={(e) => {\n                            e.currentTarget.style.backgroundColor = getCategoryColorDark(person.category);\n                            e.currentTarget.style.boxShadow = 'none';\n                            // Возвращаем стили span к исходным\n                            const span = e.currentTarget.querySelector('span');\n                            if (span) {\n                              span.style.backgroundColor = 'rgba(44, 24, 16, 0.9)';\n                              span.style.borderColor = getCategoryColorDark(person.category);\n                              span.style.color = getCategoryColorDark(person.category);\n                              span.style.fontSize = '8px';\n                              span.style.padding = '1px 3px';\n                              span.style.borderRadius = '2px';\n                            }\n                            \n                            // Сбрасываем активный маркер\n                            setActiveAchievementMarker(null);\n                            \n                            // Очищаем таймер и скрываем tooltip\n                            if (hoverTimerRef.current) {\n                              clearTimeout(hoverTimerRef.current);\n                              hoverTimerRef.current = null;\n                            }\n                            setShowAchievementTooltip(false);\n                            setHoveredAchievement(null);\n                          }}\n                          onMouseMove={(e) => {\n                            setAchievementTooltipPosition({ x: e.clientX, y: e.clientY });\n                          }}\n                          onMouseOut={(e) => {\n                            // Дополнительная проверка на случай, если onMouseLeave не сработал\n                            if (!e.currentTarget.contains(e.relatedTarget as Node)) {\n                              setActiveAchievementMarker(null);\n                              if (hoverTimerRef.current) {\n                                clearTimeout(hoverTimerRef.current);\n                                hoverTimerRef.current = null;\n                              }\n                              setShowAchievementTooltip(false);\n                              setHoveredAchievement(null);\n                            }\n                          }}\n                          >\n                            <span style={{\n                              position: 'absolute',\n                              top: '-12px',\n                              left: '50%',\n                              transform: 'translateX(-50%)',\n                              fontSize: '8px',\n                              color: getCategoryColorDark(person.category),\n                              fontWeight: 'bold',\n                              whiteSpace: 'nowrap',\n                              backgroundColor: 'rgba(44, 24, 16, 0.9)',\n                              padding: '1px 3px',\n                              borderRadius: '2px',\n                              border: `1px solid ${getCategoryColorDark(person.category)}`,\n                              transition: 'all 0.2s ease'\n                            }}>\n                              {year}\n                            </span>\n                          </div>\n                        );\n                      })}\n\n                    {/* полоса правления */}\n                    {person.reignStart && person.reignEnd && (\n                      <div style={{\n                        position: 'absolute',\n                        top: '-15px',\n                        left: `${getPosition(person.reignStart)}px`,\n                        width: `${getWidth(person.reignStart, person.reignEnd)}px`,\n                        height: '65px',\n                        backgroundColor: 'rgba(211, 47, 47, 0.25)',\n                        pointerEvents: 'none',\n                        borderLeft: '2px solid #D32F2F',\n                        borderRight: '2px solid #D32F2F',\n                        borderRadius: '3px',\n                        zIndex: 1\n                      }} />\n                    )}\n\n                    <div\n                      className=\"life-bar\"\n                      style={{\n                        position: 'absolute',\n                        top: '10px',\n                        left: `${getPosition(person.birthYear)}px`,\n                        width: `${getWidth(person.birthYear, person.deathYear)}px`,\n                        height: '40px',\n                        background: `linear-gradient(135deg, ${getCategoryColorMuted(person.category)} 0%, #6a5a3a 100%)`,\n                        borderRadius: '6px',\n                        cursor: 'pointer',\n                        display: 'flex',\n                        alignItems: 'center',\n                        padding: '0 12px',\n                        color: 'white',\n                        fontSize: '14px',\n                        fontWeight: 'bold',\n                        minWidth: '60px',\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n                        border: '1.5px solid #a8926a',\n                        opacity: 1,\n                        zIndex: 5\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'translateY(-3px) scale(1.02)'\n                        e.currentTarget.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.4)'\n                        e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.4)'\n                        setHoveredPerson(person)\n                        setMousePosition({ x: e.clientX, y: e.clientY })\n                        setTimeout(() => setShowTooltip(true), 300)\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'translateY(0) scale(1)'\n                        e.currentTarget.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)'\n                        e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.2)'\n                        setHoveredPerson(null)\n                        setShowTooltip(false)\n                      }}\n                      onMouseMove={(e) => {\n                        setMousePosition({ x: e.clientX, y: e.clientY })\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', lineHeight: '1.2' }}>\n                        <span>{person.name}</span>\n                      </div>\n                    </div>\n                  </React.Fragment>\n                ))}\n              </div>\n            ))}\n          </div>\n        </div>\n      </main>\n\n      {/* Всплывающее окно с информацией */}\n      {hoveredPerson && showTooltip && (\n        <div className=\"tooltip\" style={{ \n          position: 'fixed',\n          left: `${mousePosition.x + 15}px`,\n          top: `${mousePosition.y - 10}px`,\n          padding: '1rem',\n          zIndex: 1000,\n          maxWidth: '300px',\n          minWidth: '250px',\n          color: '#f4e4c1',\n          pointerEvents: 'none',\n          opacity: 0,\n          transform: 'translateY(10px) scale(0.95)',\n          animation: 'tooltipFadeIn 0.2s ease-out forwards'\n        }}>\n          {/* Фотография человека, если есть */}\n          {hoveredPerson.imageUrl && (\n            <div style={{ \n              marginBottom: '0.75rem',\n              textAlign: 'center'\n            }}>\n              <img \n                src={hoveredPerson.imageUrl} \n                alt={hoveredPerson.name}\n                style={{\n                  width: '80px',\n                  height: '80px',\n                  borderRadius: '50%',\n                  objectFit: 'cover',\n                  border: `2px solid ${getCategoryColor(hoveredPerson.category)}`,\n                  boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)'\n                }}\n                onError={(e) => {\n                  // Скрываем изображение если оно не загрузилось\n                  e.currentTarget.style.display = 'none';\n                }}\n              />\n            </div>\n          )}\n          \n          <h3 style={{ \n            margin: '0 0 0.5rem 0', \n            color: getCategoryColor(hoveredPerson.category),\n            fontSize: '1.1rem',\n            fontWeight: 'bold'\n          }}>\n            {hoveredPerson.name}\n          </h3>\n          \n          <div style={{ fontSize: '0.85rem', lineHeight: '1.4' }}>\n            <p style={{ margin: '0.25rem 0', fontWeight: 'bold' }}>\n              {hoveredPerson.birthYear} - {hoveredPerson.deathYear}\n            </p>\n            <p style={{ margin: '0.25rem 0' }}>\n              <span style={{ color: getCategoryColor(hoveredPerson.category), fontWeight: 'bold' }}>\n                {hoveredPerson.category}\n              </span> • {hoveredPerson.country}\n            </p>\n            <p style={{ margin: '0.5rem 0', fontStyle: 'italic', opacity: 0.8 }}>\n              {hoveredPerson.description}\n            </p>\n            \n            {/* Ключевые достижения по годам */}\n            {filters.showAchievements && ([hoveredPerson.achievementYear1, hoveredPerson.achievementYear2, hoveredPerson.achievementYear3]\n              .filter(year => year !== undefined && year !== null).length > 0) && (\n              <div style={{ marginTop: '0.5rem' }}>\n                <strong style={{ fontSize: '0.8rem', color: getCategoryColor(hoveredPerson.category) }}>\n                  🎯 Ключевые достижения:\n                </strong>\n                <div style={{ \n                  margin: '0.25rem 0 0 0',\n                  fontSize: '0.8rem'\n                }}>\n                  {[hoveredPerson.achievementYear1, hoveredPerson.achievementYear2, hoveredPerson.achievementYear3]\n                    .filter(year => year !== undefined && year !== null)\n                    .map((year, index) => (\n                      <div key={index} style={{ \n                        marginBottom: '0.1rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '0.5rem'\n                      }}>\n                        <span style={{ \n                          color: getCategoryColor(hoveredPerson.category),\n                          fontWeight: 'bold',\n                          fontSize: '0.75rem'\n                        }}>\n                          {year}\n                        </span>\n                        <span style={{ fontSize: '0.75rem' }}>\n                          {hoveredPerson.achievements[index] || 'Ключевое достижение'}\n                        </span>\n                      </div>\n                    ))}\n                </div>\n              </div>\n            )}\n\n\n          </div>\n        </div>\n      )}\n\n      {/* Всплывающее окно для достижений */}\n      {hoveredAchievement && showAchievementTooltip && (\n        <div className=\"achievement-tooltip\" style={{ \n          position: 'fixed',\n          left: `${achievementTooltipPosition.x + 15}px`,\n          top: `${achievementTooltipPosition.y - 10}px`,\n          padding: '0.75rem',\n          zIndex: 1001,\n          maxWidth: '250px',\n          minWidth: '200px',\n          color: '#f4e4c1',\n          pointerEvents: 'none',\n          opacity: 0,\n          transform: 'translateY(10px) scale(0.95)',\n          animation: 'tooltipFadeIn 0.2s ease-out forwards',\n          backgroundColor: 'rgba(44, 24, 16, 0.95)',\n          borderRadius: '6px',\n          border: `2px solid ${getCategoryColor(hoveredAchievement.person.category)}`,\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\n        }}>\n          <div style={{ fontSize: '0.85rem', lineHeight: '1.4' }}>\n            {/* Фотография человека, если есть */}\n            {hoveredAchievement.person.imageUrl && (\n              <div style={{ \n                marginBottom: '0.5rem',\n                textAlign: 'center'\n              }}>\n                <img \n                  src={hoveredAchievement.person.imageUrl} \n                  alt={hoveredAchievement.person.name}\n                  style={{\n                    width: '50px',\n                    height: '50px',\n                    borderRadius: '50%',\n                    objectFit: 'cover',\n                    border: `2px solid ${getCategoryColor(hoveredAchievement.person.category)}`,\n                    boxShadow: '0 2px 6px rgba(0, 0, 0, 0.3)'\n                  }}\n                  onError={(e) => {\n                    // Скрываем изображение если оно не загрузилось\n                    e.currentTarget.style.display = 'none';\n                  }}\n                />\n              </div>\n            )}\n            \n            <h4 style={{ \n              margin: '0 0 0.5rem 0', \n              color: getCategoryColor(hoveredAchievement.person.category),\n              fontSize: '1rem',\n              fontWeight: 'bold'\n            }}>\n              {hoveredAchievement.person.name}\n            </h4>\n            \n            <p style={{ \n              margin: '0.25rem 0', \n              fontWeight: 'bold',\n              color: getCategoryColor(hoveredAchievement.person.category),\n              fontSize: '0.9rem'\n            }}>\n              🎯 {hoveredAchievement.year}\n            </p>\n            \n            <p style={{ \n              margin: '0.25rem 0', \n              fontSize: '0.8rem',\n              fontStyle: 'italic'\n            }}>\n              {hoveredAchievement.person.achievements[hoveredAchievement.index] || 'Ключевое достижение'}\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default App "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}