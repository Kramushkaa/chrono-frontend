{"ast":null,"code":"import{useState,useRef,useCallback,useEffect}from'react';export const useTimelineDrag=_ref=>{let{timelineWidth,containerWidth}=_ref;const[isDragging,setIsDragging]=useState(false);const[dragStartX,setDragStartX]=useState(0);const[dragStartY,setDragStartY]=useState(0);const[scrollLeft,setScrollLeft]=useState(0);const[scrollTop,setScrollTop]=useState(0);const[isDraggingTimeline,setIsDraggingTimeline]=useState(false);const timelineRef=useRef(null);const dragStartTime=useRef(0);const handleMouseDown=useCallback(e=>{var _timelineRef$current,_timelineRef$current2;const target=e.target;const isInteractive=target.closest('.life-bar')||target.closest('.achievement-marker')||target.closest('button')||target.closest('[role=\"button\"]');if(isInteractive)return;setIsDragging(true);setDragStartX(e.clientX);setDragStartY(e.clientY);setScrollLeft(((_timelineRef$current=timelineRef.current)===null||_timelineRef$current===void 0?void 0:_timelineRef$current.scrollLeft)||0);setScrollTop(((_timelineRef$current2=timelineRef.current)===null||_timelineRef$current2===void 0?void 0:_timelineRef$current2.scrollTop)||0);dragStartTime.current=Date.now();e.preventDefault();},[]);const handleMouseMove=useCallback(e=>{if(!isDragging)return;// Предотвращаем скролл страницы во время перетаскивания\ne.preventDefault();const deltaX=e.clientX-dragStartX;const deltaY=e.clientY-dragStartY;const newScrollLeft=scrollLeft-deltaX;const newScrollTop=scrollTop-deltaY;if(timelineRef.current){const maxScrollLeft=timelineRef.current.scrollWidth-timelineRef.current.clientWidth;const maxScrollTop=timelineRef.current.scrollHeight-timelineRef.current.clientHeight;timelineRef.current.scrollLeft=Math.max(0,Math.min(maxScrollLeft,newScrollLeft));timelineRef.current.scrollTop=Math.max(0,Math.min(maxScrollTop,newScrollTop));}},[isDragging,dragStartX,dragStartY,scrollLeft,scrollTop]);const handleMouseUp=useCallback(()=>{if(!isDragging)return;const dragDuration=Date.now()-dragStartTime.current;if(dragDuration<200){setIsDraggingTimeline(false);}else{setIsDraggingTimeline(true);setTimeout(()=>setIsDraggingTimeline(false),100);}setIsDragging(false);},[isDragging]);const handleTouchStart=useCallback(e=>{var _timelineRef$current3,_timelineRef$current4;const target=e.target;const isInteractive=target.closest('.life-bar')||target.closest('.achievement-marker')||target.closest('button')||target.closest('[role=\"button\"]');if(isInteractive)return;setIsDragging(true);setDragStartX(e.touches[0].clientX);setDragStartY(e.touches[0].clientY);setScrollLeft(((_timelineRef$current3=timelineRef.current)===null||_timelineRef$current3===void 0?void 0:_timelineRef$current3.scrollLeft)||0);setScrollTop(((_timelineRef$current4=timelineRef.current)===null||_timelineRef$current4===void 0?void 0:_timelineRef$current4.scrollTop)||0);dragStartTime.current=Date.now();},[]);const handleTouchMove=useCallback(e=>{if(!isDragging)return;// Предотвращаем скролл страницы во время перетаскивания\ne.preventDefault();const deltaX=e.touches[0].clientX-dragStartX;const deltaY=e.touches[0].clientY-dragStartY;const newScrollLeft=scrollLeft-deltaX;const newScrollTop=scrollTop-deltaY;if(timelineRef.current){const maxScrollLeft=timelineRef.current.scrollWidth-timelineRef.current.clientWidth;const maxScrollTop=timelineRef.current.scrollHeight-timelineRef.current.clientHeight;timelineRef.current.scrollLeft=Math.max(0,Math.min(maxScrollLeft,newScrollLeft));timelineRef.current.scrollTop=Math.max(0,Math.min(maxScrollTop,newScrollTop));}},[isDragging,dragStartX,dragStartY,scrollLeft,scrollTop]);const handleTouchEnd=useCallback(()=>{if(!isDragging)return;const dragDuration=Date.now()-dragStartTime.current;if(dragDuration<200){setIsDraggingTimeline(false);}else{setIsDraggingTimeline(true);setTimeout(()=>setIsDraggingTimeline(false),100);}setIsDragging(false);},[isDragging]);useEffect(()=>{return()=>{setIsDragging(false);setIsDraggingTimeline(false);};},[]);return{timelineRef,isDragging,isDraggingTimeline,handleMouseDown,handleMouseMove,handleMouseUp,handleTouchStart,handleTouchMove,handleTouchEnd};};","map":{"version":3,"names":["useState","useRef","useCallback","useEffect","useTimelineDrag","_ref","timelineWidth","containerWidth","isDragging","setIsDragging","dragStartX","setDragStartX","dragStartY","setDragStartY","scrollLeft","setScrollLeft","scrollTop","setScrollTop","isDraggingTimeline","setIsDraggingTimeline","timelineRef","dragStartTime","handleMouseDown","e","_timelineRef$current","_timelineRef$current2","target","isInteractive","closest","clientX","clientY","current","Date","now","preventDefault","handleMouseMove","deltaX","deltaY","newScrollLeft","newScrollTop","maxScrollLeft","scrollWidth","clientWidth","maxScrollTop","scrollHeight","clientHeight","Math","max","min","handleMouseUp","dragDuration","setTimeout","handleTouchStart","_timelineRef$current3","_timelineRef$current4","touches","handleTouchMove","handleTouchEnd"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/hooks/useTimelineDrag.ts"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from 'react'\n\ninterface UseTimelineDragProps {\n  timelineWidth: number\n  containerWidth: number\n}\n\nexport const useTimelineDrag = ({ timelineWidth, containerWidth }: UseTimelineDragProps) => {\n  const [isDragging, setIsDragging] = useState(false)\n  const [dragStartX, setDragStartX] = useState(0)\n  const [dragStartY, setDragStartY] = useState(0)\n  const [scrollLeft, setScrollLeft] = useState(0)\n  const [scrollTop, setScrollTop] = useState(0)\n  const [isDraggingTimeline, setIsDraggingTimeline] = useState(false)\n  const timelineRef = useRef<HTMLDivElement>(null)\n  const dragStartTime = useRef<number>(0)\n\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\n    const target = e.target as HTMLElement\n    const isInteractive = target.closest('.life-bar') || \n                         target.closest('.achievement-marker') ||\n                         target.closest('button') ||\n                         target.closest('[role=\"button\"]')\n    \n    if (isInteractive) return\n\n    setIsDragging(true)\n    setDragStartX(e.clientX)\n    setDragStartY(e.clientY)\n    setScrollLeft(timelineRef.current?.scrollLeft || 0)\n    setScrollTop(timelineRef.current?.scrollTop || 0)\n    dragStartTime.current = Date.now()\n    e.preventDefault()\n  }, [])\n\n  const handleMouseMove = useCallback((e: React.MouseEvent) => {\n    if (!isDragging) return\n\n    // Предотвращаем скролл страницы во время перетаскивания\n    e.preventDefault()\n\n    const deltaX = e.clientX - dragStartX\n    const deltaY = e.clientY - dragStartY\n    const newScrollLeft = scrollLeft - deltaX\n    const newScrollTop = scrollTop - deltaY\n    \n    if (timelineRef.current) {\n      const maxScrollLeft = timelineRef.current.scrollWidth - timelineRef.current.clientWidth\n      const maxScrollTop = timelineRef.current.scrollHeight - timelineRef.current.clientHeight\n      \n      timelineRef.current.scrollLeft = Math.max(0, Math.min(maxScrollLeft, newScrollLeft))\n      timelineRef.current.scrollTop = Math.max(0, Math.min(maxScrollTop, newScrollTop))\n    }\n  }, [isDragging, dragStartX, dragStartY, scrollLeft, scrollTop])\n\n  const handleMouseUp = useCallback(() => {\n    if (!isDragging) return\n\n    const dragDuration = Date.now() - dragStartTime.current\n    \n    if (dragDuration < 200) {\n      setIsDraggingTimeline(false)\n    } else {\n      setIsDraggingTimeline(true)\n      setTimeout(() => setIsDraggingTimeline(false), 100)\n    }\n\n    setIsDragging(false)\n  }, [isDragging])\n\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    const target = e.target as HTMLElement\n    const isInteractive = target.closest('.life-bar') || \n                         target.closest('.achievement-marker') ||\n                         target.closest('button') ||\n                         target.closest('[role=\"button\"]')\n    \n    if (isInteractive) return\n\n    setIsDragging(true)\n    setDragStartX(e.touches[0].clientX)\n    setDragStartY(e.touches[0].clientY)\n    setScrollLeft(timelineRef.current?.scrollLeft || 0)\n    setScrollTop(timelineRef.current?.scrollTop || 0)\n    dragStartTime.current = Date.now()\n  }, [])\n\n  const handleTouchMove = useCallback((e: React.TouchEvent) => {\n    if (!isDragging) return\n\n    // Предотвращаем скролл страницы во время перетаскивания\n    e.preventDefault()\n\n    const deltaX = e.touches[0].clientX - dragStartX\n    const deltaY = e.touches[0].clientY - dragStartY\n    const newScrollLeft = scrollLeft - deltaX\n    const newScrollTop = scrollTop - deltaY\n    \n    if (timelineRef.current) {\n      const maxScrollLeft = timelineRef.current.scrollWidth - timelineRef.current.clientWidth\n      const maxScrollTop = timelineRef.current.scrollHeight - timelineRef.current.clientHeight\n      \n      timelineRef.current.scrollLeft = Math.max(0, Math.min(maxScrollLeft, newScrollLeft))\n      timelineRef.current.scrollTop = Math.max(0, Math.min(maxScrollTop, newScrollTop))\n    }\n  }, [isDragging, dragStartX, dragStartY, scrollLeft, scrollTop])\n\n  const handleTouchEnd = useCallback(() => {\n    if (!isDragging) return\n\n    const dragDuration = Date.now() - dragStartTime.current\n    \n    if (dragDuration < 200) {\n      setIsDraggingTimeline(false)\n    } else {\n      setIsDraggingTimeline(true)\n      setTimeout(() => setIsDraggingTimeline(false), 100)\n    }\n\n    setIsDragging(false)\n  }, [isDragging])\n\n  useEffect(() => {\n    return () => {\n      setIsDragging(false)\n      setIsDraggingTimeline(false)\n    }\n  }, [])\n\n  return {\n    timelineRef,\n    isDragging,\n    isDraggingTimeline,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseUp,\n    handleTouchStart,\n    handleTouchMove,\n    handleTouchEnd\n  }\n} "],"mappings":"AAAA,OAASA,QAAQ,CAAEC,MAAM,CAAEC,WAAW,CAAEC,SAAS,KAAQ,OAAO,CAOhE,MAAO,MAAM,CAAAC,eAAe,CAAGC,IAAA,EAA6D,IAA5D,CAAEC,aAAa,CAAEC,cAAqC,CAAC,CAAAF,IAAA,CACrF,KAAM,CAACG,UAAU,CAAEC,aAAa,CAAC,CAAGT,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACU,UAAU,CAAEC,aAAa,CAAC,CAAGX,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACY,UAAU,CAAEC,aAAa,CAAC,CAAGb,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACc,UAAU,CAAEC,aAAa,CAAC,CAAGf,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACgB,SAAS,CAAEC,YAAY,CAAC,CAAGjB,QAAQ,CAAC,CAAC,CAAC,CAC7C,KAAM,CAACkB,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CACnE,KAAM,CAAAoB,WAAW,CAAGnB,MAAM,CAAiB,IAAI,CAAC,CAChD,KAAM,CAAAoB,aAAa,CAAGpB,MAAM,CAAS,CAAC,CAAC,CAEvC,KAAM,CAAAqB,eAAe,CAAGpB,WAAW,CAAEqB,CAAmB,EAAK,KAAAC,oBAAA,CAAAC,qBAAA,CAC3D,KAAM,CAAAC,MAAM,CAAGH,CAAC,CAACG,MAAqB,CACtC,KAAM,CAAAC,aAAa,CAAGD,MAAM,CAACE,OAAO,CAAC,WAAW,CAAC,EAC5BF,MAAM,CAACE,OAAO,CAAC,qBAAqB,CAAC,EACrCF,MAAM,CAACE,OAAO,CAAC,QAAQ,CAAC,EACxBF,MAAM,CAACE,OAAO,CAAC,iBAAiB,CAAC,CAEtD,GAAID,aAAa,CAAE,OAEnBlB,aAAa,CAAC,IAAI,CAAC,CACnBE,aAAa,CAACY,CAAC,CAACM,OAAO,CAAC,CACxBhB,aAAa,CAACU,CAAC,CAACO,OAAO,CAAC,CACxBf,aAAa,CAAC,EAAAS,oBAAA,CAAAJ,WAAW,CAACW,OAAO,UAAAP,oBAAA,iBAAnBA,oBAAA,CAAqBV,UAAU,GAAI,CAAC,CAAC,CACnDG,YAAY,CAAC,EAAAQ,qBAAA,CAAAL,WAAW,CAACW,OAAO,UAAAN,qBAAA,iBAAnBA,qBAAA,CAAqBT,SAAS,GAAI,CAAC,CAAC,CACjDK,aAAa,CAACU,OAAO,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAClCV,CAAC,CAACW,cAAc,CAAC,CAAC,CACpB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,eAAe,CAAGjC,WAAW,CAAEqB,CAAmB,EAAK,CAC3D,GAAI,CAACf,UAAU,CAAE,OAEjB;AACAe,CAAC,CAACW,cAAc,CAAC,CAAC,CAElB,KAAM,CAAAE,MAAM,CAAGb,CAAC,CAACM,OAAO,CAAGnB,UAAU,CACrC,KAAM,CAAA2B,MAAM,CAAGd,CAAC,CAACO,OAAO,CAAGlB,UAAU,CACrC,KAAM,CAAA0B,aAAa,CAAGxB,UAAU,CAAGsB,MAAM,CACzC,KAAM,CAAAG,YAAY,CAAGvB,SAAS,CAAGqB,MAAM,CAEvC,GAAIjB,WAAW,CAACW,OAAO,CAAE,CACvB,KAAM,CAAAS,aAAa,CAAGpB,WAAW,CAACW,OAAO,CAACU,WAAW,CAAGrB,WAAW,CAACW,OAAO,CAACW,WAAW,CACvF,KAAM,CAAAC,YAAY,CAAGvB,WAAW,CAACW,OAAO,CAACa,YAAY,CAAGxB,WAAW,CAACW,OAAO,CAACc,YAAY,CAExFzB,WAAW,CAACW,OAAO,CAACjB,UAAU,CAAGgC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,GAAG,CAACR,aAAa,CAAEF,aAAa,CAAC,CAAC,CACpFlB,WAAW,CAACW,OAAO,CAACf,SAAS,CAAG8B,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,GAAG,CAACL,YAAY,CAAEJ,YAAY,CAAC,CAAC,CACnF,CACF,CAAC,CAAE,CAAC/B,UAAU,CAAEE,UAAU,CAAEE,UAAU,CAAEE,UAAU,CAAEE,SAAS,CAAC,CAAC,CAE/D,KAAM,CAAAiC,aAAa,CAAG/C,WAAW,CAAC,IAAM,CACtC,GAAI,CAACM,UAAU,CAAE,OAEjB,KAAM,CAAA0C,YAAY,CAAGlB,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGZ,aAAa,CAACU,OAAO,CAEvD,GAAImB,YAAY,CAAG,GAAG,CAAE,CACtB/B,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CAAC,IAAM,CACLA,qBAAqB,CAAC,IAAI,CAAC,CAC3BgC,UAAU,CAAC,IAAMhC,qBAAqB,CAAC,KAAK,CAAC,CAAE,GAAG,CAAC,CACrD,CAEAV,aAAa,CAAC,KAAK,CAAC,CACtB,CAAC,CAAE,CAACD,UAAU,CAAC,CAAC,CAEhB,KAAM,CAAA4C,gBAAgB,CAAGlD,WAAW,CAAEqB,CAAmB,EAAK,KAAA8B,qBAAA,CAAAC,qBAAA,CAC5D,KAAM,CAAA5B,MAAM,CAAGH,CAAC,CAACG,MAAqB,CACtC,KAAM,CAAAC,aAAa,CAAGD,MAAM,CAACE,OAAO,CAAC,WAAW,CAAC,EAC5BF,MAAM,CAACE,OAAO,CAAC,qBAAqB,CAAC,EACrCF,MAAM,CAACE,OAAO,CAAC,QAAQ,CAAC,EACxBF,MAAM,CAACE,OAAO,CAAC,iBAAiB,CAAC,CAEtD,GAAID,aAAa,CAAE,OAEnBlB,aAAa,CAAC,IAAI,CAAC,CACnBE,aAAa,CAACY,CAAC,CAACgC,OAAO,CAAC,CAAC,CAAC,CAAC1B,OAAO,CAAC,CACnChB,aAAa,CAACU,CAAC,CAACgC,OAAO,CAAC,CAAC,CAAC,CAACzB,OAAO,CAAC,CACnCf,aAAa,CAAC,EAAAsC,qBAAA,CAAAjC,WAAW,CAACW,OAAO,UAAAsB,qBAAA,iBAAnBA,qBAAA,CAAqBvC,UAAU,GAAI,CAAC,CAAC,CACnDG,YAAY,CAAC,EAAAqC,qBAAA,CAAAlC,WAAW,CAACW,OAAO,UAAAuB,qBAAA,iBAAnBA,qBAAA,CAAqBtC,SAAS,GAAI,CAAC,CAAC,CACjDK,aAAa,CAACU,OAAO,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CACpC,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAuB,eAAe,CAAGtD,WAAW,CAAEqB,CAAmB,EAAK,CAC3D,GAAI,CAACf,UAAU,CAAE,OAEjB;AACAe,CAAC,CAACW,cAAc,CAAC,CAAC,CAElB,KAAM,CAAAE,MAAM,CAAGb,CAAC,CAACgC,OAAO,CAAC,CAAC,CAAC,CAAC1B,OAAO,CAAGnB,UAAU,CAChD,KAAM,CAAA2B,MAAM,CAAGd,CAAC,CAACgC,OAAO,CAAC,CAAC,CAAC,CAACzB,OAAO,CAAGlB,UAAU,CAChD,KAAM,CAAA0B,aAAa,CAAGxB,UAAU,CAAGsB,MAAM,CACzC,KAAM,CAAAG,YAAY,CAAGvB,SAAS,CAAGqB,MAAM,CAEvC,GAAIjB,WAAW,CAACW,OAAO,CAAE,CACvB,KAAM,CAAAS,aAAa,CAAGpB,WAAW,CAACW,OAAO,CAACU,WAAW,CAAGrB,WAAW,CAACW,OAAO,CAACW,WAAW,CACvF,KAAM,CAAAC,YAAY,CAAGvB,WAAW,CAACW,OAAO,CAACa,YAAY,CAAGxB,WAAW,CAACW,OAAO,CAACc,YAAY,CAExFzB,WAAW,CAACW,OAAO,CAACjB,UAAU,CAAGgC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,GAAG,CAACR,aAAa,CAAEF,aAAa,CAAC,CAAC,CACpFlB,WAAW,CAACW,OAAO,CAACf,SAAS,CAAG8B,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,GAAG,CAACL,YAAY,CAAEJ,YAAY,CAAC,CAAC,CACnF,CACF,CAAC,CAAE,CAAC/B,UAAU,CAAEE,UAAU,CAAEE,UAAU,CAAEE,UAAU,CAAEE,SAAS,CAAC,CAAC,CAE/D,KAAM,CAAAyC,cAAc,CAAGvD,WAAW,CAAC,IAAM,CACvC,GAAI,CAACM,UAAU,CAAE,OAEjB,KAAM,CAAA0C,YAAY,CAAGlB,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGZ,aAAa,CAACU,OAAO,CAEvD,GAAImB,YAAY,CAAG,GAAG,CAAE,CACtB/B,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CAAC,IAAM,CACLA,qBAAqB,CAAC,IAAI,CAAC,CAC3BgC,UAAU,CAAC,IAAMhC,qBAAqB,CAAC,KAAK,CAAC,CAAE,GAAG,CAAC,CACrD,CAEAV,aAAa,CAAC,KAAK,CAAC,CACtB,CAAC,CAAE,CAACD,UAAU,CAAC,CAAC,CAEhBL,SAAS,CAAC,IAAM,CACd,MAAO,IAAM,CACXM,aAAa,CAAC,KAAK,CAAC,CACpBU,qBAAqB,CAAC,KAAK,CAAC,CAC9B,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CACLC,WAAW,CACXZ,UAAU,CACVU,kBAAkB,CAClBI,eAAe,CACfa,eAAe,CACfc,aAAa,CACbG,gBAAgB,CAChBI,eAAe,CACfC,cACF,CAAC,CACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}