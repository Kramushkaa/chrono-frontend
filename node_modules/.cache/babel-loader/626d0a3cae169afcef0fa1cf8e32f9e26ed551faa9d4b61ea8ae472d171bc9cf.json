{"ast":null,"code":"import React,{useRef,useEffect,useState,useCallback}from'react';import{createPortal}from'react-dom';import{useMobile}from'../hooks/useMobile';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const FilterDropdown=_ref=>{let{title,items,selectedItems,onSelectionChange,getItemColor,icon,textLabel}=_ref;const isActive=selectedItems.length>0;const dropdownRef=useRef(null);const contentRef=useRef(null);const[dropdownPosition,setDropdownPosition]=useState('bottom');const[horizontalPosition,setHorizontalPosition]=useState('left');const[isOpen,setIsOpen]=useState(false);const[portalContainer,setPortalContainer]=useState(null);const isMobile=useMobile();const closeTimeoutRef=useRef(null);const isMouseOverRef=useRef(false);// Create portal container for mobile popups\nuseEffect(()=>{if(isMobile&&isOpen){const container=document.createElement('div');container.style.position='fixed';container.style.top='0';container.style.left='0';container.style.width='100%';container.style.height='100%';container.style.zIndex='10003';container.style.pointerEvents='auto';container.style.backgroundColor='rgba(0, 0, 0, 0.3)';// Semi-transparent overlay\n// Add click handler to close dropdown when clicking overlay\ncontainer.addEventListener('click',e=>{if(e.target===container){setIsOpen(false);}});document.body.appendChild(container);setPortalContainer(container);return()=>{if(container.parentNode){container.parentNode.removeChild(container);}setPortalContainer(null);};}},[isMobile,isOpen]);// Функция для определения позиции dropdown\nconst updateDropdownPosition=useCallback(()=>{if(!dropdownRef.current||!contentRef.current)return;const dropdownRect=dropdownRef.current.getBoundingClientRect();const viewportHeight=window.innerHeight;const viewportWidth=window.innerWidth;// Оценка высоты контента (примерная)\nconst estimatedContentHeight=Math.min(items.length*30+80,300);// 30px на элемент + 80px для кнопок\n// Проверяем, помещается ли dropdown снизу\nconst spaceBelow=viewportHeight-dropdownRect.bottom;const spaceAbove=dropdownRect.top;if(spaceBelow<estimatedContentHeight&&spaceAbove>estimatedContentHeight){setDropdownPosition('top');}else{setDropdownPosition('bottom');}// Проверяем горизонтальное позиционирование для всех устройств\nconst dropdownWidth=isMobile?Math.min(250,viewportWidth-20):300;// Ограничиваем ширину на мобильных\nconst spaceRight=viewportWidth-dropdownRect.left;const spaceLeft=dropdownRect.right;// На мобильных устройствах приоритет отдаем центрированию\nif(isMobile){// Если dropdown шире, чем доступное пространство, центрируем его\nif(dropdownWidth>=viewportWidth-20){setHorizontalPosition('center');}else if(spaceRight<dropdownWidth&&spaceLeft>dropdownWidth){setHorizontalPosition('right');}else{setHorizontalPosition('left');}}else{// На десктопе используем старую логику\nif(spaceRight<dropdownWidth&&spaceLeft>dropdownWidth){setHorizontalPosition('right');}else{setHorizontalPosition('left');}}},[items.length,isMobile]);// Обновляем позицию dropdown при изменении размера окна\nuseEffect(()=>{const handleResize=()=>{if(isOpen){updateDropdownPosition();}};window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[isOpen,updateDropdownPosition]);// Дополнительная проверка для мобильных устройств\nuseEffect(()=>{if(isMobile&&isOpen){const checkPosition=()=>{if(contentRef.current){const rect=contentRef.current.getBoundingClientRect();const viewportWidth=window.innerWidth;// Если dropdown выходит за пределы экрана, пересчитываем позицию\nif(rect.left<0||rect.right>viewportWidth){updateDropdownPosition();}// Если dropdown слишком высокий, пересчитываем вертикальную позицию\nif(rect.bottom>window.innerHeight){setDropdownPosition('top');}}};// Проверяем позицию после рендера\nsetTimeout(checkPosition,100);}},[isMobile,isOpen,updateDropdownPosition]);// Очистка таймера при размонтировании\nuseEffect(()=>{return()=>{if(closeTimeoutRef.current){clearTimeout(closeTimeoutRef.current);}};},[]);// Улучшенные обработчики для разных устройств\nconst handleMouseEnter=()=>{if(!isMobile){// Очищаем таймер закрытия\nif(closeTimeoutRef.current){clearTimeout(closeTimeoutRef.current);closeTimeoutRef.current=null;}isMouseOverRef.current=true;setIsOpen(true);// Небольшая задержка для корректного расчета позиции\nsetTimeout(updateDropdownPosition,0);}};const handleMouseLeave=()=>{if(!isMobile){isMouseOverRef.current=false;// Добавляем задержку перед закрытием, чтобы избежать преждевременного закрытия\n// при быстром движении курсора\ncloseTimeoutRef.current=setTimeout(()=>{if(!isMouseOverRef.current){setIsOpen(false);}},150);// Увеличиваем задержку до 150ms\n}};const handleClick=()=>{if(isMobile){setIsOpen(!isOpen);if(!isOpen){// На мобильных устройствах добавляем дополнительную задержку\nsetTimeout(updateDropdownPosition,50);}}};// Обработка клика вне dropdown для мобильных устройств\nuseEffect(()=>{const handleClickOutside=event=>{if(isMobile&&isOpen){var _dropdownRef$current,_contentRef$current,_closest,_ref2;const target=event.target;const isClickInsideDropdown=(_dropdownRef$current=dropdownRef.current)===null||_dropdownRef$current===void 0?void 0:_dropdownRef$current.contains(target);const isClickInsideContent=(_contentRef$current=contentRef.current)===null||_contentRef$current===void 0?void 0:_contentRef$current.contains(target);// Проверяем, что клик не на кнопке или чекбоксе внутри dropdown\nconst isClickOnInteractiveElement=target===null||target===void 0?void 0:(_closest=(_ref2=target).closest)===null||_closest===void 0?void 0:_closest.call(_ref2,'button, input[type=\"checkbox\"], label');if(!isClickInsideDropdown&&!isClickInsideContent&&!isClickOnInteractiveElement){setIsOpen(false);}}};if(isMobile&&isOpen){document.addEventListener('mousedown',handleClickOutside);}return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[isMobile,isOpen]);// Обработчики для контента dropdown\nconst handleContentMouseEnter=()=>{if(!isMobile){isMouseOverRef.current=true;// Очищаем таймер закрытия при наведении на контент\nif(closeTimeoutRef.current){clearTimeout(closeTimeoutRef.current);closeTimeoutRef.current=null;}}};const handleContentMouseLeave=()=>{if(!isMobile){isMouseOverRef.current=false;// Добавляем задержку перед закрытием контента\ncloseTimeoutRef.current=setTimeout(()=>{if(!isMouseOverRef.current){setIsOpen(false);}},150);}};// Calculate popup position for mobile\nconst getMobilePopupPosition=()=>{if(!dropdownRef.current)return{top:'50%',left:'50%',transform:'translate(-50%, -50%)'};const buttonRect=dropdownRef.current.getBoundingClientRect();const viewportWidth=window.innerWidth;const viewportHeight=window.innerHeight;// Position dropdown below the button\nlet top=buttonRect.bottom+8;// 8px gap below button\nlet left=buttonRect.left;// Ensure dropdown doesn't go off-screen\nconst estimatedDropdownWidth=Math.min(250,viewportWidth-20);const estimatedDropdownHeight=Math.min(300,viewportHeight*0.6);// Adjust horizontal position if dropdown would go off-screen\nif(left+estimatedDropdownWidth>viewportWidth-10){left=viewportWidth-estimatedDropdownWidth-10;}if(left<10){left=10;}// If dropdown would go off-screen at the bottom, position it above the button\nif(top+estimatedDropdownHeight>viewportHeight-10){top=buttonRect.top-estimatedDropdownHeight-8;}// Ensure dropdown doesn't go off-screen at the top\nif(top<10){top=10;}return{top:`${top}px`,left:`${left}px`,transform:'none'};};// Render dropdown content\nconst renderDropdownContent=()=>{const mobilePopupStyle=isMobile?getMobilePopupPosition():{top:'',left:'',transform:''};return/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown-content\",ref:contentRef,onMouseEnter:handleContentMouseEnter,onMouseLeave:handleContentMouseLeave,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),role:\"listbox\",\"aria-label\":`Список ${title}`,\"aria-multiselectable\":\"true\",style:{position:isMobile?'fixed':'absolute',top:isMobile?mobilePopupStyle.top:dropdownPosition==='bottom'?'100%':'auto',bottom:isMobile?'auto':dropdownPosition==='top'?'100%':'auto',left:isMobile?mobilePopupStyle.left:horizontalPosition==='left'?'0':horizontalPosition==='center'?'50%':'auto',right:isMobile?'auto':horizontalPosition==='right'?'0':'auto',transform:isMobile?mobilePopupStyle.transform:horizontalPosition==='center'?'translateX(-50%)':'none',zIndex:isMobile?10003:1000,maxHeight:isMobile?'50vh':'300px',overflowY:'auto',display:'block',minWidth:isMobile?'200px':'250px',maxWidth:isMobile?'280px':'300px',width:isMobile?'auto':isMobile&&horizontalPosition==='center'?'calc(100vw - 40px)':'auto',background:'rgba(44, 24, 16, 0.98)',border:'2px solid rgba(244, 228, 193, 0.3)',borderRadius:isMobile?'12px':'6px',boxShadow:isMobile?'0 8px 32px rgba(0, 0, 0, 0.5)':'0 4px 12px rgba(0, 0, 0, 0.3)',backdropFilter:'blur(10px)',pointerEvents:isMobile?'auto':'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:isMobile?'0.8rem':'0.5rem',borderBottom:'1px solid rgba(139, 69, 19, 0.3)',display:'flex',gap:'0.5rem',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.preventDefault();e.stopPropagation();onSelectionChange(items);},onMouseDown:e=>e.stopPropagation(),\"aria-label\":`Выбрать все ${title}`,style:{padding:isMobile?'0.5rem 0.8rem':'0.25rem 0.5rem',background:'#27ae60',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:isMobile?'0.8rem':'0.7rem',flex:isMobile?'1':'auto',minHeight:isMobile?'44px':'auto'},children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0432\\u0441\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.preventDefault();e.stopPropagation();onSelectionChange([]);},onMouseDown:e=>e.stopPropagation(),\"aria-label\":`Снять все ${title}`,style:{padding:isMobile?'0.5rem 0.8rem':'0.25rem 0.5rem',background:'#e74c3c',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:isMobile?'0.8rem':'0.7rem',flex:isMobile?'1':'auto',minHeight:isMobile?'44px':'auto'},children:\"\\u0421\\u043D\\u044F\\u0442\\u044C \\u0432\\u0441\\u0435\"})]}),items.map(item=>/*#__PURE__*/_jsxs(\"label\",{className:\"filter-checkbox\",onClick:e=>{e.preventDefault();e.stopPropagation();},onMouseDown:e=>e.stopPropagation(),role:\"option\",\"aria-selected\":selectedItems.includes(item),style:{display:'flex',alignItems:'center',gap:'0.5rem',padding:isMobile?'0.6rem 0.5rem':'0.4rem 0.5rem',cursor:'pointer',transition:'background-color 0.2s ease',borderRadius:'3px',margin:'0.1rem 0',minHeight:isMobile?'44px':'auto'// Минимальная высота для мобильных устройств\n},onMouseEnter:e=>{if(!isMobile){e.currentTarget.style.backgroundColor='rgba(139, 69, 19, 0.1)';}},onMouseLeave:e=>{if(!isMobile){e.currentTarget.style.backgroundColor='transparent';}},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedItems.includes(item),onChange:e=>{e.preventDefault();e.stopPropagation();if(e.target.checked){onSelectionChange([...selectedItems,item]);}else{onSelectionChange(selectedItems.filter(i=>i!==item));}},onMouseDown:e=>e.stopPropagation(),\"aria-label\":`Выбрать ${item}`,style:{margin:0,cursor:'pointer'}}),/*#__PURE__*/_jsx(\"span\",{style:{color:getItemColor?getItemColor(item):'#f4e4c1',fontWeight:getItemColor?'bold':'normal',fontSize:'0.8rem'},children:item})]},item))]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"filter-dropdown\",ref:dropdownRef,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,children:[/*#__PURE__*/_jsxs(\"button\",{className:`filter-btn ${isActive?'active':''}`,style:{minWidth:'auto',padding:isMobile?'0.5rem 0.8rem':'0.3rem 0.6rem',display:'flex',alignItems:'center',gap:'0.3rem',background:isActive?'rgba(139, 69, 19, 0.15)':'rgba(139, 69, 19, 0.08)',border:`1px solid ${isActive?'rgba(139, 69, 19, 0.3)':'rgba(139, 69, 19, 0.2)'}`,borderRadius:'4px',color:'#f4e4c1',fontSize:isMobile?'0.9rem':'0.7rem',cursor:'pointer',transition:'all 0.2s ease',whiteSpace:'nowrap'},onClick:handleClick,\"aria-haspopup\":\"listbox\",\"aria-expanded\":isOpen,\"aria-label\":`${title} - ${selectedItems.length} выбрано из ${items.length}`,children:[icon&&/*#__PURE__*/_jsx(\"span\",{className:\"filter-icon\",children:icon}),/*#__PURE__*/_jsx(\"span\",{className:\"filter-text\",children:textLabel||title}),isActive&&/*#__PURE__*/_jsxs(\"span\",{className:\"filter-count\",children:[\"(\",selectedItems.length,\")\"]})]}),isOpen&&(isMobile&&portalContainer?(/*#__PURE__*/createPortal(renderDropdownContent(),portalContainer)):renderDropdownContent())]});};","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","createPortal","useMobile","jsx","_jsx","jsxs","_jsxs","FilterDropdown","_ref","title","items","selectedItems","onSelectionChange","getItemColor","icon","textLabel","isActive","length","dropdownRef","contentRef","dropdownPosition","setDropdownPosition","horizontalPosition","setHorizontalPosition","isOpen","setIsOpen","portalContainer","setPortalContainer","isMobile","closeTimeoutRef","isMouseOverRef","container","document","createElement","style","position","top","left","width","height","zIndex","pointerEvents","backgroundColor","addEventListener","e","target","body","appendChild","parentNode","removeChild","updateDropdownPosition","current","dropdownRect","getBoundingClientRect","viewportHeight","window","innerHeight","viewportWidth","innerWidth","estimatedContentHeight","Math","min","spaceBelow","bottom","spaceAbove","dropdownWidth","spaceRight","spaceLeft","right","handleResize","removeEventListener","checkPosition","rect","setTimeout","clearTimeout","handleMouseEnter","handleMouseLeave","handleClick","handleClickOutside","event","_dropdownRef$current","_contentRef$current","_closest","_ref2","isClickInsideDropdown","contains","isClickInsideContent","isClickOnInteractiveElement","closest","call","handleContentMouseEnter","handleContentMouseLeave","getMobilePopupPosition","transform","buttonRect","estimatedDropdownWidth","estimatedDropdownHeight","renderDropdownContent","mobilePopupStyle","className","ref","onMouseEnter","onMouseLeave","onClick","stopPropagation","onMouseDown","role","maxHeight","overflowY","display","minWidth","maxWidth","background","border","borderRadius","boxShadow","backdropFilter","children","padding","borderBottom","gap","flexWrap","preventDefault","color","cursor","fontSize","flex","minHeight","map","item","includes","alignItems","transition","margin","currentTarget","type","checked","onChange","filter","i","fontWeight","whiteSpace"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/components/FilterDropdown.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState, useCallback } from 'react'\r\nimport { createPortal } from 'react-dom'\r\nimport { useMobile } from '../hooks/useMobile'\r\n\r\ninterface FilterDropdownProps {\r\n  title: string\r\n  items: string[]\r\n  selectedItems: string[]\r\n  onSelectionChange: (items: string[]) => void\r\n  getItemColor?: (item: string) => string\r\n  icon?: React.ReactNode\r\n  textLabel?: string\r\n}\r\n\r\nexport const FilterDropdown: React.FC<FilterDropdownProps> = ({ \r\n  title, \r\n  items, \r\n  selectedItems, \r\n  onSelectionChange, \r\n  getItemColor,\r\n  icon,\r\n  textLabel\r\n}) => {\r\n  const isActive = selectedItems.length > 0\r\n  const dropdownRef = useRef<HTMLDivElement>(null)\r\n  const contentRef = useRef<HTMLDivElement>(null)\r\n  const [dropdownPosition, setDropdownPosition] = useState<'bottom' | 'top'>('bottom')\r\n  const [horizontalPosition, setHorizontalPosition] = useState<'left' | 'right' | 'center'>('left')\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const [portalContainer, setPortalContainer] = useState<HTMLElement | null>(null)\r\n  const isMobile = useMobile()\r\n  const closeTimeoutRef = useRef<NodeJS.Timeout | null>(null)\r\n  const isMouseOverRef = useRef(false)\r\n  \r\n  // Create portal container for mobile popups\r\n  useEffect(() => {\r\n    if (isMobile && isOpen) {\r\n      const container = document.createElement('div')\r\n      container.style.position = 'fixed'\r\n      container.style.top = '0'\r\n      container.style.left = '0'\r\n      container.style.width = '100%'\r\n      container.style.height = '100%'\r\n      container.style.zIndex = '10003'\r\n      container.style.pointerEvents = 'auto'\r\n      container.style.backgroundColor = 'rgba(0, 0, 0, 0.3)' // Semi-transparent overlay\r\n      \r\n      // Add click handler to close dropdown when clicking overlay\r\n      container.addEventListener('click', (e) => {\r\n        if (e.target === container) {\r\n          setIsOpen(false)\r\n        }\r\n      })\r\n      \r\n      document.body.appendChild(container)\r\n      setPortalContainer(container)\r\n      \r\n      return () => {\r\n        if (container.parentNode) {\r\n          container.parentNode.removeChild(container)\r\n        }\r\n        setPortalContainer(null)\r\n      }\r\n    }\r\n  }, [isMobile, isOpen])\r\n  \r\n  // Функция для определения позиции dropdown\r\n  const updateDropdownPosition = useCallback(() => {\r\n    if (!dropdownRef.current || !contentRef.current) return\r\n    \r\n    const dropdownRect = dropdownRef.current.getBoundingClientRect()\r\n    const viewportHeight = window.innerHeight\r\n    const viewportWidth = window.innerWidth\r\n    \r\n    // Оценка высоты контента (примерная)\r\n    const estimatedContentHeight = Math.min(items.length * 30 + 80, 300) // 30px на элемент + 80px для кнопок\r\n    \r\n    // Проверяем, помещается ли dropdown снизу\r\n    const spaceBelow = viewportHeight - dropdownRect.bottom\r\n    const spaceAbove = dropdownRect.top\r\n    \r\n    if (spaceBelow < estimatedContentHeight && spaceAbove > estimatedContentHeight) {\r\n      setDropdownPosition('top')\r\n    } else {\r\n      setDropdownPosition('bottom')\r\n    }\r\n    \r\n    // Проверяем горизонтальное позиционирование для всех устройств\r\n    const dropdownWidth = isMobile ? Math.min(250, viewportWidth - 20) : 300 // Ограничиваем ширину на мобильных\r\n    const spaceRight = viewportWidth - dropdownRect.left\r\n    const spaceLeft = dropdownRect.right\r\n    \r\n    // На мобильных устройствах приоритет отдаем центрированию\r\n    if (isMobile) {\r\n      // Если dropdown шире, чем доступное пространство, центрируем его\r\n      if (dropdownWidth >= viewportWidth - 20) {\r\n        setHorizontalPosition('center')\r\n      } else if (spaceRight < dropdownWidth && spaceLeft > dropdownWidth) {\r\n        setHorizontalPosition('right')\r\n      } else {\r\n        setHorizontalPosition('left')\r\n      }\r\n    } else {\r\n      // На десктопе используем старую логику\r\n      if (spaceRight < dropdownWidth && spaceLeft > dropdownWidth) {\r\n        setHorizontalPosition('right')\r\n      } else {\r\n        setHorizontalPosition('left')\r\n      }\r\n    }\r\n  }, [items.length, isMobile])\r\n\r\n  // Обновляем позицию dropdown при изменении размера окна\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      if (isOpen) {\r\n        updateDropdownPosition()\r\n      }\r\n    }\r\n    \r\n    window.addEventListener('resize', handleResize)\r\n    return () => window.removeEventListener('resize', handleResize)\r\n  }, [isOpen, updateDropdownPosition])\r\n  \r\n  // Дополнительная проверка для мобильных устройств\r\n  useEffect(() => {\r\n    if (isMobile && isOpen) {\r\n      const checkPosition = () => {\r\n        if (contentRef.current) {\r\n          const rect = contentRef.current.getBoundingClientRect()\r\n          const viewportWidth = window.innerWidth\r\n          \r\n          // Если dropdown выходит за пределы экрана, пересчитываем позицию\r\n          if (rect.left < 0 || rect.right > viewportWidth) {\r\n            updateDropdownPosition()\r\n          }\r\n          // Если dropdown слишком высокий, пересчитываем вертикальную позицию\r\n          if (rect.bottom > window.innerHeight) {\r\n            setDropdownPosition('top')\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Проверяем позицию после рендера\r\n      setTimeout(checkPosition, 100)\r\n    }\r\n  }, [isMobile, isOpen, updateDropdownPosition])\r\n  \r\n  // Очистка таймера при размонтировании\r\n  useEffect(() => {\r\n    return () => {\r\n      if (closeTimeoutRef.current) {\r\n        clearTimeout(closeTimeoutRef.current)\r\n      }\r\n    }\r\n  }, [])\r\n  \r\n  // Улучшенные обработчики для разных устройств\r\n  const handleMouseEnter = () => {\r\n    if (!isMobile) {\r\n      // Очищаем таймер закрытия\r\n      if (closeTimeoutRef.current) {\r\n        clearTimeout(closeTimeoutRef.current)\r\n        closeTimeoutRef.current = null\r\n      }\r\n      \r\n      isMouseOverRef.current = true\r\n      setIsOpen(true)\r\n      // Небольшая задержка для корректного расчета позиции\r\n      setTimeout(updateDropdownPosition, 0)\r\n    }\r\n  }\r\n  \r\n  const handleMouseLeave = () => {\r\n    if (!isMobile) {\r\n      isMouseOverRef.current = false\r\n      \r\n      // Добавляем задержку перед закрытием, чтобы избежать преждевременного закрытия\r\n      // при быстром движении курсора\r\n      closeTimeoutRef.current = setTimeout(() => {\r\n        if (!isMouseOverRef.current) {\r\n          setIsOpen(false)\r\n        }\r\n      }, 150) // Увеличиваем задержку до 150ms\r\n    }\r\n  }\r\n  \r\n  const handleClick = () => {\r\n    if (isMobile) {\r\n      setIsOpen(!isOpen)\r\n      if (!isOpen) {\r\n        // На мобильных устройствах добавляем дополнительную задержку\r\n        setTimeout(updateDropdownPosition, 50)\r\n      }\r\n    }\r\n  }\r\n  \r\n  // Обработка клика вне dropdown для мобильных устройств\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (isMobile && isOpen) {\r\n        const target = event.target as Node\r\n        const isClickInsideDropdown = dropdownRef.current?.contains(target)\r\n        const isClickInsideContent = contentRef.current?.contains(target)\r\n        \r\n        // Проверяем, что клик не на кнопке или чекбоксе внутри dropdown\r\n        const isClickOnInteractiveElement = (target as Element)?.closest?.('button, input[type=\"checkbox\"], label')\r\n        \r\n        if (!isClickInsideDropdown && !isClickInsideContent && !isClickOnInteractiveElement) {\r\n          setIsOpen(false)\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (isMobile && isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside)\r\n    }\r\n    \r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside)\r\n    }\r\n  }, [isMobile, isOpen])\r\n  \r\n  // Обработчики для контента dropdown\r\n  const handleContentMouseEnter = () => {\r\n    if (!isMobile) {\r\n      isMouseOverRef.current = true\r\n      // Очищаем таймер закрытия при наведении на контент\r\n      if (closeTimeoutRef.current) {\r\n        clearTimeout(closeTimeoutRef.current)\r\n        closeTimeoutRef.current = null\r\n      }\r\n    }\r\n  }\r\n  \r\n  const handleContentMouseLeave = () => {\r\n    if (!isMobile) {\r\n      isMouseOverRef.current = false\r\n      \r\n      // Добавляем задержку перед закрытием контента\r\n      closeTimeoutRef.current = setTimeout(() => {\r\n        if (!isMouseOverRef.current) {\r\n          setIsOpen(false)\r\n        }\r\n      }, 150)\r\n    }\r\n  }\r\n\r\n  // Calculate popup position for mobile\r\n  const getMobilePopupPosition = () => {\r\n    if (!dropdownRef.current) return { top: '50%', left: '50%', transform: 'translate(-50%, -50%)' }\r\n    \r\n    const buttonRect = dropdownRef.current.getBoundingClientRect()\r\n    const viewportWidth = window.innerWidth\r\n    const viewportHeight = window.innerHeight\r\n    \r\n    // Position dropdown below the button\r\n    let top = buttonRect.bottom + 8 // 8px gap below button\r\n    let left = buttonRect.left\r\n    \r\n    // Ensure dropdown doesn't go off-screen\r\n    const estimatedDropdownWidth = Math.min(250, viewportWidth - 20)\r\n    const estimatedDropdownHeight = Math.min(300, viewportHeight * 0.6)\r\n    \r\n    // Adjust horizontal position if dropdown would go off-screen\r\n    if (left + estimatedDropdownWidth > viewportWidth - 10) {\r\n      left = viewportWidth - estimatedDropdownWidth - 10\r\n    }\r\n    if (left < 10) {\r\n      left = 10\r\n    }\r\n    \r\n    // If dropdown would go off-screen at the bottom, position it above the button\r\n    if (top + estimatedDropdownHeight > viewportHeight - 10) {\r\n      top = buttonRect.top - estimatedDropdownHeight - 8\r\n    }\r\n    \r\n    // Ensure dropdown doesn't go off-screen at the top\r\n    if (top < 10) {\r\n      top = 10\r\n    }\r\n    \r\n    return {\r\n      top: `${top}px`,\r\n      left: `${left}px`,\r\n      transform: 'none'\r\n    }\r\n  }\r\n\r\n  // Render dropdown content\r\n  const renderDropdownContent = () => {\r\n    const mobilePopupStyle = isMobile ? getMobilePopupPosition() : { top: '', left: '', transform: '' }\r\n    \r\n    return (\r\n      <div \r\n        className=\"filter-dropdown-content\"\r\n        ref={contentRef}\r\n        onMouseEnter={handleContentMouseEnter}\r\n        onMouseLeave={handleContentMouseLeave}\r\n        onClick={(e) => e.stopPropagation()}\r\n        onMouseDown={(e) => e.stopPropagation()}\r\n        role=\"listbox\"\r\n        aria-label={`Список ${title}`}\r\n        aria-multiselectable=\"true\"\r\n        style={{\r\n          position: isMobile ? 'fixed' : 'absolute',\r\n          top: isMobile ? mobilePopupStyle.top : (dropdownPosition === 'bottom' ? '100%' : 'auto'),\r\n          bottom: isMobile ? 'auto' : (dropdownPosition === 'top' ? '100%' : 'auto'),\r\n          left: isMobile ? mobilePopupStyle.left : (horizontalPosition === 'left' ? '0' : horizontalPosition === 'center' ? '50%' : 'auto'),\r\n          right: isMobile ? 'auto' : (horizontalPosition === 'right' ? '0' : 'auto'),\r\n          transform: isMobile ? mobilePopupStyle.transform : (horizontalPosition === 'center' ? 'translateX(-50%)' : 'none'),\r\n          zIndex: isMobile ? 10003 : 1000,\r\n          maxHeight: isMobile ? '50vh' : '300px',\r\n          overflowY: 'auto',\r\n          display: 'block',\r\n          minWidth: isMobile ? '200px' : '250px',\r\n          maxWidth: isMobile ? '280px' : '300px',\r\n          width: isMobile ? 'auto' : (isMobile && horizontalPosition === 'center' ? 'calc(100vw - 40px)' : 'auto'),\r\n          background: 'rgba(44, 24, 16, 0.98)',\r\n          border: '2px solid rgba(244, 228, 193, 0.3)',\r\n          borderRadius: isMobile ? '12px' : '6px',\r\n          boxShadow: isMobile ? '0 8px 32px rgba(0, 0, 0, 0.5)' : '0 4px 12px rgba(0, 0, 0, 0.3)',\r\n          backdropFilter: 'blur(10px)',\r\n          pointerEvents: isMobile ? 'auto' : 'auto'\r\n        }}\r\n      >\r\n        <div style={{ \r\n          padding: isMobile ? '0.8rem' : '0.5rem', \r\n          borderBottom: '1px solid rgba(139, 69, 19, 0.3)',\r\n          display: 'flex',\r\n          gap: '0.5rem',\r\n          flexWrap: 'wrap'\r\n        }}>\r\n          <button\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              onSelectionChange(items)\r\n            }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n            aria-label={`Выбрать все ${title}`}\r\n            style={{\r\n              padding: isMobile ? '0.5rem 0.8rem' : '0.25rem 0.5rem',\r\n              background: '#27ae60',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontSize: isMobile ? '0.8rem' : '0.7rem',\r\n              flex: isMobile ? '1' : 'auto',\r\n              minHeight: isMobile ? '44px' : 'auto'\r\n            }}\r\n          >\r\n            Выбрать все\r\n          </button>\r\n          <button\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              onSelectionChange([])\r\n            }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n            aria-label={`Снять все ${title}`}\r\n            style={{\r\n              padding: isMobile ? '0.5rem 0.8rem' : '0.25rem 0.5rem',\r\n              background: '#e74c3c',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontSize: isMobile ? '0.8rem' : '0.7rem',\r\n              flex: isMobile ? '1' : 'auto',\r\n              minHeight: isMobile ? '44px' : 'auto'\r\n            }}\r\n          >\r\n            Снять все\r\n          </button>\r\n        </div>\r\n        {items.map(item => (\r\n          <label \r\n            key={item} \r\n            className=\"filter-checkbox\" \r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n            }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n            role=\"option\"\r\n            aria-selected={selectedItems.includes(item)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: isMobile ? '0.6rem 0.5rem' : '0.4rem 0.5rem',\r\n              cursor: 'pointer',\r\n              transition: 'background-color 0.2s ease',\r\n              borderRadius: '3px',\r\n              margin: '0.1rem 0',\r\n              minHeight: isMobile ? '44px' : 'auto' // Минимальная высота для мобильных устройств\r\n            }}\r\n            onMouseEnter={(e) => {\r\n              if (!isMobile) {\r\n                e.currentTarget.style.backgroundColor = 'rgba(139, 69, 19, 0.1)'\r\n              }\r\n            }}\r\n            onMouseLeave={(e) => {\r\n              if (!isMobile) {\r\n                e.currentTarget.style.backgroundColor = 'transparent'\r\n              }\r\n            }}\r\n          >\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={selectedItems.includes(item)}\r\n              onChange={(e) => {\r\n                e.preventDefault()\r\n                e.stopPropagation()\r\n                if (e.target.checked) {\r\n                  onSelectionChange([...selectedItems, item])\r\n                } else {\r\n                  onSelectionChange(selectedItems.filter(i => i !== item))\r\n                }\r\n              }}\r\n              onMouseDown={(e) => e.stopPropagation()}\r\n              aria-label={`Выбрать ${item}`}\r\n              style={{\r\n                margin: 0,\r\n                cursor: 'pointer'\r\n              }}\r\n            />\r\n            <span style={{ \r\n              color: getItemColor ? getItemColor(item) : '#f4e4c1',\r\n              fontWeight: getItemColor ? 'bold' : 'normal',\r\n              fontSize: '0.8rem'\r\n            }}>\r\n              {item}\r\n            </span>\r\n          </label>\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n  \r\n  return (\r\n    <div \r\n      className=\"filter-dropdown\" \r\n      ref={dropdownRef}\r\n      onMouseEnter={handleMouseEnter}\r\n      onMouseLeave={handleMouseLeave}\r\n    >\r\n      <button \r\n        className={`filter-btn ${isActive ? 'active' : ''}`}\r\n        style={{ \r\n          minWidth: 'auto',\r\n          padding: isMobile ? '0.5rem 0.8rem' : '0.3rem 0.6rem',\r\n          display: 'flex', \r\n          alignItems: 'center', \r\n          gap: '0.3rem',\r\n          background: isActive ? 'rgba(139, 69, 19, 0.15)' : 'rgba(139, 69, 19, 0.08)',\r\n          border: `1px solid ${isActive ? 'rgba(139, 69, 19, 0.3)' : 'rgba(139, 69, 19, 0.2)'}`,\r\n          borderRadius: '4px',\r\n          color: '#f4e4c1',\r\n          fontSize: isMobile ? '0.9rem' : '0.7rem',\r\n          cursor: 'pointer',\r\n          transition: 'all 0.2s ease',\r\n          whiteSpace: 'nowrap'\r\n        }}\r\n        onClick={handleClick}\r\n        aria-haspopup=\"listbox\"\r\n        aria-expanded={isOpen}\r\n        aria-label={`${title} - ${selectedItems.length} выбрано из ${items.length}`}\r\n      >\r\n        {icon && <span className=\"filter-icon\">{icon}</span>}\r\n        <span className=\"filter-text\">{textLabel || title}</span>\r\n        {isActive && <span className=\"filter-count\">({selectedItems.length})</span>}\r\n      </button>\r\n      {isOpen && (\r\n        isMobile && portalContainer ? (\r\n          createPortal(renderDropdownContent(), portalContainer)\r\n        ) : (\r\n          renderDropdownContent()\r\n        )\r\n      )}\r\n    </div>\r\n  )\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}