{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{useAuth}from'../context';import{useNavigate}from'react-router-dom';import{LoginForm}from'./Auth/LoginForm';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function UserMenu(_ref){let{style,className}=_ref;const{isAuthenticated,user,logout}=useAuth();const[open,setOpen]=useState(false);const navigate=useNavigate();const ref=useRef(null);useEffect(()=>{const onDoc=e=>{if(!ref.current)return;if(!ref.current.contains(e.target))setOpen(false);};document.addEventListener('mousedown',onDoc);return()=>document.removeEventListener('mousedown',onDoc);},[]);return/*#__PURE__*/_jsxs(\"div\",{ref:ref,className:className,style:{position:'relative',...style},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setOpen(v=>!v),\"aria-haspopup\":\"menu\",\"aria-expanded\":open,title:isAuthenticated?(user===null||user===void 0?void 0:user.username)||(user===null||user===void 0?void 0:user.email)||'Профиль':'Войти',style:{padding:'6px 10px',background:'rgba(244, 228, 193, 0.12)',border:'1px solid rgba(244, 228, 193, 0.3)',color:'#f4e4c1',borderRadius:6,cursor:'pointer'},children:isAuthenticated?(user===null||user===void 0?void 0:user.username)||'Профиль':'Войти'}),open&&/*#__PURE__*/_jsx(\"div\",{role:\"menu\",style:{position:'absolute',right:0,marginTop:6,minWidth:260,background:'rgba(29, 29, 27, 0.98)',border:'1px solid rgba(244, 228, 193, 0.15)',borderRadius:8,padding:12,boxShadow:'0 6px 24px rgba(0,0,0,0.4)',zIndex:1000},children:isAuthenticated?/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:8},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,color:'#f4e4c1'},children:(user===null||user===void 0?void 0:user.username)||(user===null||user===void 0?void 0:user.email)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setOpen(false);navigate('/profile');},style:{padding:'6px 8px',borderRadius:6,cursor:'pointer'},children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{setOpen(false);await logout();},style:{padding:'6px 8px',borderRadius:6,cursor:'pointer'},children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]}):/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:10},children:[/*#__PURE__*/_jsx(LoginForm,{onSuccess:()=>setOpen(false)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setOpen(false);navigate('/register');},style:{padding:'6px 8px',borderRadius:6,cursor:'pointer'},children:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]})})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","useAuth","useNavigate","LoginForm","jsx","_jsx","jsxs","_jsxs","UserMenu","_ref","style","className","isAuthenticated","user","logout","open","setOpen","navigate","ref","onDoc","e","current","contains","target","document","addEventListener","removeEventListener","position","children","onClick","v","title","username","email","padding","background","border","color","borderRadius","cursor","role","right","marginTop","minWidth","boxShadow","zIndex","display","gap","fontWeight","onSuccess"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/components/UserMenu.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { useAuth } from '../context';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { LoginForm } from './Auth/LoginForm';\r\n\r\ntype UserMenuProps = {\r\n  style?: React.CSSProperties;\r\n  className?: string;\r\n};\r\n\r\nexport function UserMenu({ style, className }: UserMenuProps) {\r\n  const { isAuthenticated, user, logout } = useAuth();\r\n  const [open, setOpen] = useState(false);\r\n  const navigate = useNavigate();\r\n  const ref = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const onDoc = (e: MouseEvent) => {\r\n      if (!ref.current) return;\r\n      if (!ref.current.contains(e.target as Node)) setOpen(false);\r\n    };\r\n    document.addEventListener('mousedown', onDoc);\r\n    return () => document.removeEventListener('mousedown', onDoc);\r\n  }, []);\r\n\r\n  return (\r\n    <div ref={ref} className={className} style={{ position: 'relative', ...style }}>\r\n      <button\r\n        onClick={() => setOpen((v) => !v)}\r\n        aria-haspopup=\"menu\"\r\n        aria-expanded={open}\r\n        title={isAuthenticated ? (user?.username || user?.email || 'Профиль') : 'Войти'}\r\n        style={{\r\n          padding: '6px 10px',\r\n          background: 'rgba(244, 228, 193, 0.12)',\r\n          border: '1px solid rgba(244, 228, 193, 0.3)',\r\n          color: '#f4e4c1',\r\n          borderRadius: 6,\r\n          cursor: 'pointer',\r\n        }}\r\n      >\r\n        {isAuthenticated ? (user?.username || 'Профиль') : 'Войти'}\r\n      </button>\r\n\r\n      {open && (\r\n        <div\r\n          role=\"menu\"\r\n          style={{\r\n            position: 'absolute',\r\n            right: 0,\r\n            marginTop: 6,\r\n            minWidth: 260,\r\n            background: 'rgba(29, 29, 27, 0.98)',\r\n            border: '1px solid rgba(244, 228, 193, 0.15)',\r\n            borderRadius: 8,\r\n            padding: 12,\r\n            boxShadow: '0 6px 24px rgba(0,0,0,0.4)',\r\n            zIndex: 1000,\r\n          }}\r\n        >\r\n          {isAuthenticated ? (\r\n            <div style={{ display: 'grid', gap: 8 }}>\r\n              <div style={{ fontWeight: 600, color: '#f4e4c1' }}>\r\n                {user?.username || user?.email}\r\n              </div>\r\n              <button\r\n                onClick={() => {\r\n                  setOpen(false);\r\n                  navigate('/profile');\r\n                }}\r\n                style={{ padding: '6px 8px', borderRadius: 6, cursor: 'pointer' }}\r\n              >\r\n                Профиль\r\n              </button>\r\n              <button\r\n                onClick={async () => {\r\n                  setOpen(false);\r\n                  await logout();\r\n                }}\r\n                style={{ padding: '6px 8px', borderRadius: 6, cursor: 'pointer' }}\r\n              >\r\n                Выйти\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div style={{ display: 'grid', gap: 10 }}>\r\n              <LoginForm onSuccess={() => setOpen(false)} />\r\n              <button\r\n                onClick={() => {\r\n                  setOpen(false);\r\n                  navigate('/register');\r\n                }}\r\n                style={{ padding: '6px 8px', borderRadius: 6, cursor: 'pointer' }}\r\n              >\r\n                Зарегистрироваться\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}