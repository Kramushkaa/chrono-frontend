{"ast":null,"code":"import React from'react';import{useMobile}from'../hooks/useMobile';import{useTimelineDrag}from'../hooks/useTimelineDrag';import{getPosition,getWidth,getCenturyColor,getCenturyNumber,toRomanNumeral}from'../utils/timelineUtils';// Типы для элементов временной линии\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export const Timeline=_ref=>{let{isLoading,timelineWidth,totalHeight,centuryBoundaries,minYear,pixelsPerYear,LEFT_PADDING_PX,rowPlacement,filters,groupingType,categoryDividers,getGroupColor,getGroupColorDark,getGroupColorMuted,getPersonGroup,hoveredPerson,setHoveredPerson,mousePosition,setMousePosition,showTooltip,setShowTooltip,handlePersonHover,activeAchievementMarker,setActiveAchievementMarker,hoveredAchievement,setHoveredAchievement,achievementTooltipPosition,setAchievementTooltipPosition,showAchievementTooltip,setShowAchievementTooltip,hoverTimerRef,sortedData,selectedPerson,setSelectedPerson}=_ref;const isMobile=useMobile();// Хук для перетаскивания timeline\nconst{timelineRef,isDragging,isDraggingTimeline,handleMouseDown,handleMouseMove,handleMouseUp,handleTouchStart,handleTouchMove,handleTouchEnd}=useTimelineDrag({timelineWidth,containerWidth:window.innerWidth});// Функция для определения пустых веков на основе отфильтрованных данных\nconst getEmptyCenturies=()=>{if(!sortedData||sortedData.length===0)return new Set();// Используем отфильтрованные данные для определения диапазона\nconst minYear=Math.min(...sortedData.map(p=>p.birthYear));const maxYear=Math.max(...sortedData.map(p=>p.deathYear));const startCentury=Math.floor(minYear/100)*100;const endCentury=Math.ceil(maxYear/100)*100;const emptyCenturies=new Set();for(let centuryStart=startCentury;centuryStart<=endCentury;centuryStart+=100){const centuryEnd=centuryStart+99;const hasDataInCentury=sortedData.some(person=>person.birthYear<=centuryEnd&&person.deathYear>=centuryStart);if(!hasDataInCentury){emptyCenturies.add(centuryStart);}}return emptyCenturies;};// Создаем массив для отображения веков с промежутками\nconst getTimelineElements=()=>{if(!filters.hideEmptyCenturies){return centuryBoundaries.map(year=>({type:'century',year}));}const emptyCenturies=getEmptyCenturies();const visibleCenturies=centuryBoundaries.filter(year=>!emptyCenturies.has(year));const elements=[];for(let i=0;i<visibleCenturies.length;i++){const currentYear=visibleCenturies[i];// Добавляем промежуток перед веком (кроме первого)\nif(i>0){const prevYear=visibleCenturies[i-1];const gapStart=prevYear+100;const gapEnd=currentYear;// Находим все скрытые века в промежутке\nconst hiddenCenturies=[];for(let year=gapStart;year<gapEnd;year+=100){if(emptyCenturies.has(year)){hiddenCenturies.push(year);}}if(hiddenCenturies.length>0){elements.push({type:'gap',startYear:gapStart,endYear:gapEnd,hiddenCenturies});}}// Добавляем сам век\nelements.push({type:'century',year:currentYear});}return elements;};const timelineElements=getTimelineElements();// Функция для вычисления позиции с учетом промежутков\nconst getAdjustedPosition=year=>{if(!filters.hideEmptyCenturies){return getPosition(year,minYear,pixelsPerYear,LEFT_PADDING_PX);}// Находим позицию года в оригинальной шкале\nconst originalPosition=getPosition(year,minYear,pixelsPerYear,LEFT_PADDING_PX);// Вычисляем смещение, проходя по всем промежуткам до этого года\nlet totalOffset=0;for(const element of timelineElements){if(element.type==='gap'){const gapStart=getPosition(element.startYear,minYear,pixelsPerYear,LEFT_PADDING_PX);const gapEnd=getPosition(element.endYear,minYear,pixelsPerYear,LEFT_PADDING_PX);const originalGapWidth=gapEnd-gapStart;const newGapWidth=pixelsPerYear*10;// 10 лет\n// Если год находится после этого промежутка, добавляем смещение\nif(year>=element.endYear){totalOffset+=originalGapWidth-newGapWidth;}}}return originalPosition-totalOffset;};// Функция для вычисления ширины с учетом промежутков\nconst getAdjustedWidth=(startYear,endYear)=>{if(!filters.hideEmptyCenturies){return getWidth(startYear,endYear,pixelsPerYear);}const startPos=getAdjustedPosition(startYear);const endPos=getAdjustedPosition(endYear);return endPos-startPos;};// Функция для вычисления скорректированной ширины таймлайна\nconst getAdjustedTimelineWidth=()=>{if(!filters.hideEmptyCenturies){return timelineWidth;}// Вычисляем общую ширину, проходя по всем элементам\nlet totalWidth=0;for(const element of timelineElements){if(element.type==='century'){// Век занимает 100 лет\ntotalWidth+=pixelsPerYear*100;}else if(element.type==='gap'){// Промежуток занимает 10 лет\ntotalWidth+=pixelsPerYear*10;}}return totalWidth+LEFT_PADDING_PX+50;// Добавляем отступы\n};// Функция для создания повторяющихся меток веков через каждые 90vh\nconst createRepeatingCenturyLabels=()=>{const viewportHeight=window.innerHeight;const labels=[];// Создаем метки для каждого века\ntimelineElements.forEach(element=>{if(element.type==='century'){const year=element.year;const centerYear=year+50;const centuryNumber=getCenturyNumber(centerYear);const isNegativeCentury=year<0;const romanNumeral=isNegativeCentury?`${toRomanNumeral(Math.abs(centuryNumber))} в. до н.э`:`${toRomanNumeral(centuryNumber)} в.`;const startPos=getAdjustedPosition(year);const nextYear=year+100;const endPos=getAdjustedPosition(nextYear);const centerPos=startPos+(endPos-startPos)/2;// Центр века\n// Создаем метки через каждые 90vh\nfor(let top=0;top<totalHeight;top+=viewportHeight*0.9){labels.push({id:`century-label-${year}-${top}`,year,romanNumeral,left:centerPos,top:top+viewportHeight/2,// Центрируем по вертикали в каждом экране\ntype:'century'});}}else if(element.type==='gap'){var _element$hiddenCentur;const startPos=getAdjustedPosition(element.startYear);const gapWidth=pixelsPerYear*10;// 10 лет = 1/10 века\nconst centerPos=startPos+gapWidth/2;// Центр промежутка\nconst hiddenCenturiesText=((_element$hiddenCentur=element.hiddenCenturies)===null||_element$hiddenCentur===void 0?void 0:_element$hiddenCentur.map(year=>{const centuryNumber=getCenturyNumber(year+50);const isNegativeCentury=year<0;const romanNumeral=isNegativeCentury?`${toRomanNumeral(Math.abs(centuryNumber))} в. до н.э`:`${toRomanNumeral(centuryNumber)} в.`;return romanNumeral;}).join(', '))||'';// Создаем метки для промежутков через каждые 90vh\nfor(let top=0;top<totalHeight;top+=viewportHeight*0.9){labels.push({id:`gap-label-${element.startYear}-${top}`,year:element.startYear,romanNumeral:hiddenCenturiesText,left:centerPos,top:top+viewportHeight/2,type:'gap'});}}});return labels;};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-content\",id:\"timeline-content\",role:\"presentation\",\"aria-hidden\":\"true\",style:{position:'relative',height:'100%',overflow:'visible',padding:isMobile?'0':'1rem 0 2rem 0'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"timeline-background\",id:\"timeline-background\",role:\"presentation\",\"aria-hidden\":\"true\",style:{position:'absolute',top:'0',left:'0',width:`${getAdjustedTimelineWidth()}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:1},children:timelineElements.map((element,index)=>{if(element.type==='century'){const year=element.year;// Каждый век занимает ровно 100 лет\nconst nextYear=year+100;const startPos=getAdjustedPosition(year);const endPos=getAdjustedPosition(nextYear);const width=endPos-startPos;// Вычисляем век на основе центра года в столетии\nconst centerYear=year+50;const centuryNumber=getCenturyNumber(centerYear);// Для отрицательных веков добавляем знак минус\nconst isNegativeCentury=year<0;const romanNumeral=isNegativeCentury?`-${toRomanNumeral(Math.abs(centuryNumber))}`:toRomanNumeral(centuryNumber);return/*#__PURE__*/_jsx(\"div\",{className:\"century-background\",id:`century-${year}`,role:\"presentation\",\"aria-label\":`Век ${romanNumeral}`,style:{position:'absolute',left:`${startPos}px`,width:`${width}px`,height:'100%',background:getCenturyColor(year,minYear),opacity:0.3,zIndex:1}},`century-bg-${year}`);}else if(element.type==='gap'){// Промежуток между веками - компактный размер (1/10 века)\nconst gapWidth=pixelsPerYear*10;// 10 лет = 1/10 века\nconst startPos=getAdjustedPosition(element.startYear);return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${startPos}px`,width:`${gapWidth}px`,height:'100%',background:'rgba(139, 69, 19, 0.1)',border:'1px dashed rgba(139, 69, 19, 0.3)',zIndex:1}},`gap-${element.startYear}`);}return null;})}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'0',left:'0',width:`${getAdjustedTimelineWidth()}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:5},children:timelineElements.map(element=>{if(element.type==='century'){return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${getAdjustedPosition(element.year)}px`,width:'2px',height:'100%',background:'linear-gradient(to bottom, #cd853f 0%, #cd853f 20%, rgba(205, 133, 63, 0.3) 100%)',zIndex:5}},`century-line-${element.year}`);}else if(element.type==='gap'){return/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${getAdjustedPosition(element.startYear)}px`,width:'2px',height:'100%',background:'linear-gradient(to bottom, #cd853f 0%, #cd853f 20%, rgba(205, 133, 63, 0.3) 100%)',zIndex:5}},`gap-line-${element.startYear}`);}return null;})}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'0',left:'0',width:`${getAdjustedTimelineWidth()}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:6},children:createRepeatingCenturyLabels().map(label=>/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${label.left}px`,top:`${label.top}px`,transform:'translate(-50%, -50%)',fontSize:label.type==='century'?'1.5rem':'0.8rem',fontWeight:'bold',color:label.type==='century'?'rgba(244, 228, 193, 0.4)':'rgba(139, 69, 19, 0.5)',textShadow:'1px 1px 2px rgba(0, 0, 0, 0.6)',pointerEvents:'none',fontFamily:label.type==='century'?'serif':'sans-serif',textAlign:'center',maxWidth:'200px',wordWrap:'break-word'},children:label.type==='century'?label.romanNumeral:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0421\\u043A\\u0440\\u044B\\u0442\\u043E:\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.7rem',marginTop:'2px'},children:label.romanNumeral})]})},label.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"category-dividers\",id:\"category-dividers\",role:\"presentation\",\"aria-hidden\":\"true\",style:{position:'absolute',top:'0',left:'0',width:`${getAdjustedTimelineWidth()}px`,height:`${totalHeight+200}px`,pointerEvents:'none',zIndex:8},children:categoryDividers.map(divider=>/*#__PURE__*/_jsx(\"div\",{className:\"category-divider\",id:`divider-${divider.category}`,role:\"separator\",\"aria-label\":`Разделитель группы: ${divider.category}`,style:{position:'absolute',top:`${divider.top}px`,left:'0',width:'100%',height:'10px',background:`linear-gradient(to right, transparent 0%, ${getGroupColor(divider.category)} 20%, ${getGroupColor(divider.category)} 80%, transparent 100%)`,opacity:0.6,zIndex:8},children:/*#__PURE__*/_jsx(\"div\",{className:\"category-label\",id:`category-label-${divider.category}`,\"aria-label\":`Группа: ${divider.category}`,style:{position:'absolute',left:'20px',top:'50%',transform:'translateY(-50%)',background:getGroupColor(divider.category),color:'white',padding:'2px 8px',borderRadius:'4px',fontSize:'0.7rem',fontWeight:'bold',whiteSpace:'nowrap',zIndex:9},children:divider.category})},`category-divider-${divider.category}`))}),/*#__PURE__*/_jsx(\"div\",{className:\"person-timeline\",id:\"person-timeline\",role:\"list\",\"aria-label\":\"\\u0412\\u0440\\u0435\\u043C\\u0435\\u043D\\u043D\\u044B\\u0435 \\u043B\\u0438\\u043D\\u0438\\u0438 \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u0447\\u0435\\u0441\\u043A\\u0438\\u0445 \\u043B\\u0438\\u0447\\u043D\\u043E\\u0441\\u0442\\u0435\\u0439\",style:{position:'relative',width:`${getAdjustedTimelineWidth()}px`,height:`${totalHeight+60}px`,zIndex:10},children:rowPlacement.map((row,rowIndex)=>/*#__PURE__*/_jsx(\"div\",{className:\"timeline-row\",id:`timeline-row-${rowIndex}`,role:\"listitem\",\"aria-label\":`Строка ${rowIndex+1} временной линии`,style:{position:'relative',height:row.length===0?'20px':'60px',marginBottom:row.length===0?'0px':'10px'},children:row.map(person=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"birth-year-label\",id:`birth-year-${person.id}`,\"aria-label\":`Год рождения: ${person.birthYear}`,style:{position:'absolute',left:`${getAdjustedPosition(person.birthYear)}px`,top:0,fontSize:'11px',color:'rgba(244, 228, 193, 0.6)',fontStyle:'italic',fontWeight:400,transform:'translateX(-100%) translateY(-10px)'},children:person.birthYear}),person.reignStart&&/*#__PURE__*/_jsxs(\"span\",{className:\"reign-label\",id:`reign-start-${person.id}`,\"aria-label\":`Начало правления: ${person.reignStart}`,style:{position:'absolute',left:`${getAdjustedPosition(person.reignStart)}px`,top:0,fontSize:'11px',color:'#E57373',// Темно-красный\nfontStyle:'italic',fontWeight:'bold',transform:'translateX(-100%) translateY(-22px)'},children:[\"\\uD83D\\uDC51 \",person.reignStart]}),person.reignEnd&&/*#__PURE__*/_jsx(\"span\",{className:\"reign-label\",id:`reign-end-${person.id}`,\"aria-label\":`Конец правления: ${person.reignEnd}`,style:{position:'absolute',left:`${getAdjustedPosition(person.reignEnd)}px`,top:0,fontSize:'11px',color:'#E57373',// Темно-красный\nfontStyle:'italic',fontWeight:'bold',transform:'translateY(-22px)'},children:person.reignEnd}),/*#__PURE__*/_jsx(\"span\",{className:\"death-year-label\",id:`death-year-${person.id}`,\"aria-label\":`Год смерти: ${person.deathYear}`,style:{position:'absolute',left:`${getAdjustedPosition(person.deathYear)}px`,top:0,fontSize:'11px',color:'rgba(244, 228, 193, 0.6)',fontStyle:'italic',fontWeight:400,transform:'translateY(-10px)'},children:person.deathYear}),filters.showAchievements&&[person.achievementYear1,person.achievementYear2,person.achievementYear3].filter(year=>year!==undefined&&year!==null).map((year,index)=>{return/*#__PURE__*/_jsx(\"div\",{className:\"achievement-marker\",id:`achievement-${person.id}-${index}`,role:\"button\",\"aria-label\":`Достижение ${index+1} в ${year} году`,tabIndex:0,style:{position:'absolute',left:`${getAdjustedPosition(year)}px`,top:'-4px',width:'2px',// Возвращаем стандартную ширину\nheight:'15px',// Возвращаем стандартную высоту\nbackgroundColor:getGroupColorDark(getPersonGroup(person)),zIndex:(activeAchievementMarker===null||activeAchievementMarker===void 0?void 0:activeAchievementMarker.personId)===person.id&&(activeAchievementMarker===null||activeAchievementMarker===void 0?void 0:activeAchievementMarker.index)===index?10:3,transform:'translateX(-50%)',cursor:'pointer',transition:'all 0.2s ease'// Убираем псевдоэлементы, так как они не работают в inline стилях\n},onMouseEnter:e=>{if(!isMobile){e.currentTarget.style.backgroundColor=getGroupColor(getPersonGroup(person));e.currentTarget.style.boxShadow=`0 0 3px ${getGroupColor(getPersonGroup(person))}`;// Устанавливаем активный маркер\nsetActiveAchievementMarker({personId:person.id,index});// Скрываем tooltip человека при наведении на маркер достижения\nif((hoveredPerson===null||hoveredPerson===void 0?void 0:hoveredPerson.id)===person.id){handlePersonHover(null,0,0);}// Очищаем предыдущий таймер если он есть\nif(hoverTimerRef.current){clearTimeout(hoverTimerRef.current);}// Запускаем таймер для показа tooltip\nhoverTimerRef.current=setTimeout(()=>{setAchievementTooltipPosition({x:e.clientX,y:e.clientY});setHoveredAchievement({person,year:year,index});setShowAchievementTooltip(true);},500);}},onMouseLeave:e=>{if(!isMobile){e.currentTarget.style.backgroundColor=getGroupColorDark(getPersonGroup(person));e.currentTarget.style.boxShadow='none';// Сбрасываем активный маркер\nsetActiveAchievementMarker(null);// Очищаем таймер и скрываем tooltip достижения\nif(hoverTimerRef.current){clearTimeout(hoverTimerRef.current);hoverTimerRef.current=null;}setShowAchievementTooltip(false);setHoveredAchievement(null);// Также скрываем tooltip человека, если он был показан\nif((hoveredPerson===null||hoveredPerson===void 0?void 0:hoveredPerson.id)===person.id){handlePersonHover(null,0,0);}}},onMouseMove:e=>{if(!isMobile&&hoveredAchievement&&hoveredAchievement.person.id===person.id&&hoveredAchievement.index===index){setAchievementTooltipPosition({x:e.clientX,y:e.clientY});}},onTouchStart:e=>{if(isMobile){e.preventDefault();e.currentTarget.style.backgroundColor=getGroupColor(getPersonGroup(person));e.currentTarget.style.boxShadow=`0 0 3px ${getGroupColor(getPersonGroup(person))}`;// Устанавливаем активный маркер\nsetActiveAchievementMarker({personId:person.id,index});// Скрываем tooltip человека при касании маркера достижения\nif((hoveredPerson===null||hoveredPerson===void 0?void 0:hoveredPerson.id)===person.id){handlePersonHover(null,0,0);}// Показываем tooltip сразу на мобильных\nconst touch=e.touches[0];setAchievementTooltipPosition({x:touch.clientX,y:touch.clientY});setHoveredAchievement({person,year:year,index});setShowAchievementTooltip(true);}},onTouchEnd:e=>{if(isMobile){// Убираем визуальные эффекты при отпускании, но НЕ скрываем tooltip\ne.currentTarget.style.backgroundColor=getGroupColorDark(getPersonGroup(person));e.currentTarget.style.boxShadow='none';// Сбрасываем активный маркер\nsetActiveAchievementMarker(null);// НЕ скрываем tooltip достижения - он будет скрыт только по клику вне или по кнопке закрытия\n// Но скрываем tooltip человека, если он был показан\nif((hoveredPerson===null||hoveredPerson===void 0?void 0:hoveredPerson.id)===person.id){handlePersonHover(null,0,0);}}},onKeyDown:e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();// Показываем tooltip при нажатии Enter или Space\nsetHoveredAchievement({person,year:year,index});// Используем позицию элемента для tooltip при нажатии клавиши\nconst rect=e.currentTarget.getBoundingClientRect();setAchievementTooltipPosition({x:rect.left+rect.width/2,y:rect.top-10});setShowAchievementTooltip(true);}},children:/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',top:'-12px',left:'50%',transform:'translateX(-50%)',fontSize:'8px',color:getGroupColorDark(getPersonGroup(person)),fontWeight:'bold',whiteSpace:'nowrap',backgroundColor:'rgba(44, 24, 16, 0.9)',padding:'1px 3px',borderRadius:'2px',border:`1px solid ${getGroupColorDark(getPersonGroup(person))}`,transition:'all 0.2s ease'},children:year})},index);}),person.reignStart&&person.reignEnd&&/*#__PURE__*/_jsx(\"div\",{className:\"reign-bar\",id:`reign-bar-${person.id}`,role:\"presentation\",\"aria-label\":`Период правления: ${person.reignStart} - ${person.reignEnd}`,style:{position:'absolute',top:'-15px',left:`${getAdjustedPosition(person.reignStart)}px`,width:`${getAdjustedWidth(person.reignStart,person.reignEnd)}px`,height:'65px',backgroundColor:'rgba(211, 47, 47, 0.25)',pointerEvents:'none',borderLeft:'2px solid #D32F2F',borderRight:'2px solid #D32F2F',borderRadius:'3px',zIndex:1}}),/*#__PURE__*/_jsx(\"div\",{className:\"life-bar\",id:`life-bar-${person.id}`,role:\"button\",\"aria-label\":`${person.name}, ${person.birthYear} - ${person.deathYear}, ${person.category}`,tabIndex:0,style:{position:'absolute',top:'10px',left:`${getAdjustedPosition(person.birthYear)}px`,width:`${getAdjustedWidth(person.birthYear,person.deathYear)}px`,height:'40px',background:`linear-gradient(135deg, ${getGroupColorMuted(getPersonGroup(person))} 0%, #6a5a3a 100%)`,borderRadius:'6px',cursor:'pointer',display:'flex',alignItems:'center',padding:'0 12px',color:'white',fontSize:'14px',fontWeight:'bold',minWidth:'60px',boxShadow:'0 2px 8px rgba(0,0,0,0.15)',border:'1.5px solid #a8926a',opacity:(selectedPerson===null||selectedPerson===void 0?void 0:selectedPerson.id)===person.id?0.8:1,zIndex:5,transform:(selectedPerson===null||selectedPerson===void 0?void 0:selectedPerson.id)===person.id?'scale(1.05)':'scale(1)',transition:'all 0.2s ease'},onMouseEnter:e=>{if(!isMobile){e.currentTarget.style.transform='translateY(-3px) scale(1.02)';e.currentTarget.style.boxShadow='0 8px 25px rgba(0, 0, 0, 0.4)';e.currentTarget.style.borderColor='rgba(255, 255, 255, 0.4)';// Скрываем tooltip достижения при наведении на lifebar\nif((hoveredAchievement===null||hoveredAchievement===void 0?void 0:hoveredAchievement.person.id)===person.id){setShowAchievementTooltip(false);setHoveredAchievement(null);setActiveAchievementMarker(null);}// Используем handlePersonHover для правильной обработки\nhandlePersonHover(person,e.clientX,e.clientY);}},onMouseLeave:e=>{if(!isMobile){e.currentTarget.style.transform=(selectedPerson===null||selectedPerson===void 0?void 0:selectedPerson.id)===person.id?'scale(1.05)':'translateY(0) scale(1)';e.currentTarget.style.boxShadow='0 4px 12px rgba(0, 0, 0, 0.3)';e.currentTarget.style.borderColor='rgba(255, 255, 255, 0.2)';// Используем handlePersonHover для правильной обработки с задержкой\nhandlePersonHover(null,0,0);}},onMouseMove:e=>{if(!isMobile&&(hoveredPerson===null||hoveredPerson===void 0?void 0:hoveredPerson.id)===person.id){setMousePosition({x:e.clientX,y:e.clientY});}},onKeyDown:e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();if(isMobile){setSelectedPerson(person);}else{setHoveredPerson(person);setShowTooltip(true);}}},onTouchStart:e=>{if(isMobile){// Скрываем tooltip достижения при касании lifebar\nif((hoveredAchievement===null||hoveredAchievement===void 0?void 0:hoveredAchievement.person.id)===person.id){setShowAchievementTooltip(false);setHoveredAchievement(null);setActiveAchievementMarker(null);}}},onClick:()=>{if(isMobile){setSelectedPerson(person);}},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',lineHeight:'1.2'},children:/*#__PURE__*/_jsx(\"span\",{children:person.name})})})]},person.id))},rowIndex))})]})});};","map":{"version":3,"names":["React","useMobile","useTimelineDrag","getPosition","getWidth","getCenturyColor","getCenturyNumber","toRomanNumeral","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Timeline","_ref","isLoading","timelineWidth","totalHeight","centuryBoundaries","minYear","pixelsPerYear","LEFT_PADDING_PX","rowPlacement","filters","groupingType","categoryDividers","getGroupColor","getGroupColorDark","getGroupColorMuted","getPersonGroup","hoveredPerson","setHoveredPerson","mousePosition","setMousePosition","showTooltip","setShowTooltip","handlePersonHover","activeAchievementMarker","setActiveAchievementMarker","hoveredAchievement","setHoveredAchievement","achievementTooltipPosition","setAchievementTooltipPosition","showAchievementTooltip","setShowAchievementTooltip","hoverTimerRef","sortedData","selectedPerson","setSelectedPerson","isMobile","timelineRef","isDragging","isDraggingTimeline","handleMouseDown","handleMouseMove","handleMouseUp","handleTouchStart","handleTouchMove","handleTouchEnd","containerWidth","window","innerWidth","getEmptyCenturies","length","Set","Math","min","map","p","birthYear","maxYear","max","deathYear","startCentury","floor","endCentury","ceil","emptyCenturies","centuryStart","centuryEnd","hasDataInCentury","some","person","add","getTimelineElements","hideEmptyCenturies","year","type","visibleCenturies","filter","has","elements","i","currentYear","prevYear","gapStart","gapEnd","hiddenCenturies","push","startYear","endYear","timelineElements","getAdjustedPosition","originalPosition","totalOffset","element","originalGapWidth","newGapWidth","getAdjustedWidth","startPos","endPos","getAdjustedTimelineWidth","totalWidth","createRepeatingCenturyLabels","viewportHeight","innerHeight","labels","forEach","centerYear","centuryNumber","isNegativeCentury","romanNumeral","abs","nextYear","centerPos","top","id","left","_element$hiddenCentur","gapWidth","hiddenCenturiesText","join","children","className","role","style","position","height","overflow","padding","width","pointerEvents","zIndex","index","background","opacity","border","label","transform","fontSize","fontWeight","color","textShadow","fontFamily","textAlign","maxWidth","wordWrap","marginTop","divider","category","borderRadius","whiteSpace","row","rowIndex","marginBottom","fontStyle","reignStart","reignEnd","showAchievements","achievementYear1","achievementYear2","achievementYear3","undefined","tabIndex","backgroundColor","personId","cursor","transition","onMouseEnter","e","currentTarget","boxShadow","current","clearTimeout","setTimeout","x","clientX","y","clientY","onMouseLeave","onMouseMove","onTouchStart","preventDefault","touch","touches","onTouchEnd","onKeyDown","key","rect","getBoundingClientRect","borderLeft","borderRight","name","display","alignItems","minWidth","borderColor","onClick","flexDirection","lineHeight"],"sources":["C:/Users/Selecty/Documents/PetProjects/chronoline-frontend/src/components/Timeline.tsx"],"sourcesContent":["import React from 'react'\r\nimport { useMobile } from '../hooks/useMobile'\r\nimport { useTimelineDrag } from '../hooks/useTimelineDrag'\r\nimport { Person } from '../types'\r\nimport { \r\n  getPosition, \r\n  getWidth, \r\n  getCenturyColor, \r\n  getCenturyNumber, \r\n  toRomanNumeral\r\n} from '../utils/timelineUtils'\r\n\r\ninterface TimelineProps {\r\n  isLoading: boolean\r\n  timelineWidth: number\r\n  totalHeight: number\r\n  centuryBoundaries: number[]\r\n  minYear: number\r\n  pixelsPerYear: number\r\n  LEFT_PADDING_PX: number\r\n  rowPlacement: Person[][]\r\n  filters: {\r\n    showAchievements: boolean\r\n    hideEmptyCenturies: boolean\r\n  }\r\n  groupingType: 'category' | 'country' | 'none'\r\n  categoryDividers: { category: string; top: number }[]\r\n  getGroupColor: (groupName: string) => string\r\n  getGroupColorDark: (groupName: string) => string\r\n  getGroupColorMuted: (groupName: string) => string\r\n  getPersonGroup: (person: Person) => string\r\n  hoveredPerson: Person | null\r\n  setHoveredPerson: (person: Person | null) => void\r\n  mousePosition: { x: number; y: number }\r\n  setMousePosition: (position: { x: number; y: number }) => void\r\n  showTooltip: boolean\r\n  setShowTooltip: (show: boolean) => void\r\n  handlePersonHover: (person: Person | null, x: number, y: number) => void\r\n  activeAchievementMarker: { personId: string; index: number } | null\r\n  setActiveAchievementMarker: (marker: { personId: string; index: number } | null) => void\r\n  hoveredAchievement: { person: Person; year: number; index: number } | null\r\n  setHoveredAchievement: (achievement: { person: Person; year: number; index: number } | null) => void\r\n  achievementTooltipPosition: { x: number; y: number }\r\n  setAchievementTooltipPosition: (position: { x: number; y: number }) => void\r\n  showAchievementTooltip: boolean\r\n  setShowAchievementTooltip: (show: boolean) => void\r\n  hoverTimerRef: React.MutableRefObject<NodeJS.Timeout | null>\r\n  sortedData: Person[]\r\n  selectedPerson: Person | null\r\n  setSelectedPerson: (person: Person | null) => void\r\n}\r\n\r\n// Типы для элементов временной линии\r\ntype TimelineElement = \r\n  | { type: 'century'; year: number }\r\n  | { type: 'gap'; startYear: number; endYear: number; hiddenCenturies: number[] }\r\n\r\nexport const Timeline: React.FC<TimelineProps> = ({\r\n  isLoading,\r\n  timelineWidth,\r\n  totalHeight,\r\n  centuryBoundaries,\r\n  minYear,\r\n  pixelsPerYear,\r\n  LEFT_PADDING_PX,\r\n  rowPlacement,\r\n  filters,\r\n  groupingType,\r\n  categoryDividers,\r\n  getGroupColor,\r\n  getGroupColorDark,\r\n  getGroupColorMuted,\r\n  getPersonGroup,\r\n  hoveredPerson,\r\n  setHoveredPerson,\r\n  mousePosition,\r\n  setMousePosition,\r\n  showTooltip,\r\n  setShowTooltip,\r\n  handlePersonHover,\r\n  activeAchievementMarker,\r\n  setActiveAchievementMarker,\r\n  hoveredAchievement,\r\n  setHoveredAchievement,\r\n  achievementTooltipPosition,\r\n  setAchievementTooltipPosition,\r\n  showAchievementTooltip,\r\n  setShowAchievementTooltip,\r\n  hoverTimerRef,\r\n  sortedData,\r\n  selectedPerson,\r\n  setSelectedPerson\r\n}) => {\r\n  const isMobile = useMobile()\r\n\r\n  // Хук для перетаскивания timeline\r\n  const {\r\n    timelineRef,\r\n    isDragging,\r\n    isDraggingTimeline,\r\n    handleMouseDown,\r\n    handleMouseMove,\r\n    handleMouseUp,\r\n    handleTouchStart,\r\n    handleTouchMove,\r\n    handleTouchEnd\r\n  } = useTimelineDrag({\r\n    timelineWidth,\r\n    containerWidth: window.innerWidth\r\n  })\r\n\r\n  // Функция для определения пустых веков на основе отфильтрованных данных\r\n  const getEmptyCenturies = () => {\r\n    if (!sortedData || sortedData.length === 0) return new Set();\r\n    \r\n    // Используем отфильтрованные данные для определения диапазона\r\n    const minYear = Math.min(...sortedData.map(p => p.birthYear));\r\n    const maxYear = Math.max(...sortedData.map(p => p.deathYear));\r\n    \r\n    const startCentury = Math.floor(minYear / 100) * 100;\r\n    const endCentury = Math.ceil(maxYear / 100) * 100;\r\n    \r\n    const emptyCenturies = new Set<number>();\r\n    \r\n    for (let centuryStart = startCentury; centuryStart <= endCentury; centuryStart += 100) {\r\n      const centuryEnd = centuryStart + 99;\r\n      const hasDataInCentury = sortedData.some(person => \r\n        (person.birthYear <= centuryEnd && person.deathYear >= centuryStart)\r\n      );\r\n      \r\n      if (!hasDataInCentury) {\r\n        emptyCenturies.add(centuryStart);\r\n      }\r\n    }\r\n    \r\n    return emptyCenturies;\r\n  };\r\n\r\n  // Создаем массив для отображения веков с промежутками\r\n  const getTimelineElements = (): TimelineElement[] => {\r\n    if (!filters.hideEmptyCenturies) {\r\n      return centuryBoundaries.map(year => ({ type: 'century', year }));\r\n    }\r\n\r\n    const emptyCenturies = getEmptyCenturies();\r\n    const visibleCenturies = centuryBoundaries.filter(year => !emptyCenturies.has(year));\r\n    \r\n    const elements: TimelineElement[] = [];\r\n    \r\n    for (let i = 0; i < visibleCenturies.length; i++) {\r\n      const currentYear = visibleCenturies[i];\r\n      \r\n      // Добавляем промежуток перед веком (кроме первого)\r\n      if (i > 0) {\r\n        const prevYear = visibleCenturies[i - 1];\r\n        const gapStart = prevYear + 100;\r\n        const gapEnd = currentYear;\r\n        \r\n        // Находим все скрытые века в промежутке\r\n        const hiddenCenturies: number[] = [];\r\n        for (let year = gapStart; year < gapEnd; year += 100) {\r\n          if (emptyCenturies.has(year)) {\r\n            hiddenCenturies.push(year);\r\n          }\r\n        }\r\n        \r\n        if (hiddenCenturies.length > 0) {\r\n          elements.push({\r\n            type: 'gap',\r\n            startYear: gapStart,\r\n            endYear: gapEnd,\r\n            hiddenCenturies\r\n          });\r\n        }\r\n      }\r\n      \r\n      // Добавляем сам век\r\n      elements.push({ type: 'century', year: currentYear });\r\n    }\r\n    \r\n    return elements;\r\n  };\r\n\r\n  const timelineElements = getTimelineElements();\r\n\r\n  // Функция для вычисления позиции с учетом промежутков\r\n  const getAdjustedPosition = (year: number) => {\r\n    if (!filters.hideEmptyCenturies) {\r\n      return getPosition(year, minYear, pixelsPerYear, LEFT_PADDING_PX);\r\n    }\r\n\r\n    // Находим позицию года в оригинальной шкале\r\n    const originalPosition = getPosition(year, minYear, pixelsPerYear, LEFT_PADDING_PX);\r\n    \r\n    // Вычисляем смещение, проходя по всем промежуткам до этого года\r\n    let totalOffset = 0;\r\n    \r\n    for (const element of timelineElements) {\r\n      if (element.type === 'gap') {\r\n        const gapStart = getPosition(element.startYear, minYear, pixelsPerYear, LEFT_PADDING_PX);\r\n        const gapEnd = getPosition(element.endYear, minYear, pixelsPerYear, LEFT_PADDING_PX);\r\n        const originalGapWidth = gapEnd - gapStart;\r\n        const newGapWidth = pixelsPerYear * 10; // 10 лет\r\n        \r\n        // Если год находится после этого промежутка, добавляем смещение\r\n        if (year >= element.endYear) {\r\n          totalOffset += (originalGapWidth - newGapWidth);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return originalPosition - totalOffset;\r\n  };\r\n\r\n  // Функция для вычисления ширины с учетом промежутков\r\n  const getAdjustedWidth = (startYear: number, endYear: number) => {\r\n    if (!filters.hideEmptyCenturies) {\r\n      return getWidth(startYear, endYear, pixelsPerYear);\r\n    }\r\n\r\n    const startPos = getAdjustedPosition(startYear);\r\n    const endPos = getAdjustedPosition(endYear);\r\n    return endPos - startPos;\r\n  };\r\n\r\n  // Функция для вычисления скорректированной ширины таймлайна\r\n  const getAdjustedTimelineWidth = () => {\r\n    if (!filters.hideEmptyCenturies) {\r\n      return timelineWidth;\r\n    }\r\n\r\n    // Вычисляем общую ширину, проходя по всем элементам\r\n    let totalWidth = 0;\r\n    \r\n    for (const element of timelineElements) {\r\n      if (element.type === 'century') {\r\n        // Век занимает 100 лет\r\n        totalWidth += pixelsPerYear * 100;\r\n      } else if (element.type === 'gap') {\r\n        // Промежуток занимает 10 лет\r\n        totalWidth += pixelsPerYear * 10;\r\n      }\r\n    }\r\n\r\n    return totalWidth + LEFT_PADDING_PX + 50; // Добавляем отступы\r\n  };\r\n\r\n  // Функция для создания повторяющихся меток веков через каждые 90vh\r\n  const createRepeatingCenturyLabels = () => {\r\n    const viewportHeight = window.innerHeight;\r\n    const labels: Array<{\r\n      id: string;\r\n      year: number;\r\n      romanNumeral: string;\r\n      left: number;\r\n      top: number;\r\n      type: 'century' | 'gap';\r\n    }> = [];\r\n    \r\n    // Создаем метки для каждого века\r\n    timelineElements.forEach((element) => {\r\n      if (element.type === 'century') {\r\n        const year = element.year;\r\n        const centerYear = year + 50;\r\n        const centuryNumber = getCenturyNumber(centerYear);\r\n        const isNegativeCentury = year < 0;\r\n        const romanNumeral = isNegativeCentury ? `${toRomanNumeral(Math.abs(centuryNumber))} в. до н.э` : `${toRomanNumeral(centuryNumber)} в.`;\r\n        const startPos = getAdjustedPosition(year);\r\n        const nextYear = year + 100;\r\n        const endPos = getAdjustedPosition(nextYear);\r\n        const centerPos = startPos + (endPos - startPos) / 2; // Центр века\r\n        \r\n        // Создаем метки через каждые 90vh\r\n        for (let top = 0; top < totalHeight; top += viewportHeight * 0.9) {\r\n          labels.push({\r\n            id: `century-label-${year}-${top}`,\r\n            year,\r\n            romanNumeral,\r\n            left: centerPos,\r\n            top: top + viewportHeight / 2, // Центрируем по вертикали в каждом экране\r\n            type: 'century'\r\n          });\r\n        }\r\n      } else if (element.type === 'gap') {\r\n        const startPos = getAdjustedPosition(element.startYear);\r\n        const gapWidth = pixelsPerYear * 10; // 10 лет = 1/10 века\r\n        const centerPos = startPos + gapWidth / 2; // Центр промежутка\r\n        const hiddenCenturiesText = element.hiddenCenturies?.map(year => {\r\n          const centuryNumber = getCenturyNumber(year + 50);\r\n          const isNegativeCentury = year < 0;\r\n          const romanNumeral = isNegativeCentury ? `${toRomanNumeral(Math.abs(centuryNumber))} в. до н.э` : `${toRomanNumeral(centuryNumber)} в.`;\r\n          return romanNumeral;\r\n        }).join(', ') || '';\r\n        \r\n        // Создаем метки для промежутков через каждые 90vh\r\n        for (let top = 0; top < totalHeight; top += viewportHeight * 0.9) {\r\n          labels.push({\r\n            id: `gap-label-${element.startYear}-${top}`,\r\n            year: element.startYear,\r\n            romanNumeral: hiddenCenturiesText,\r\n            left: centerPos,\r\n            top: top + viewportHeight / 2,\r\n            type: 'gap'\r\n          });\r\n        }\r\n      }\r\n    });\r\n    \r\n    return labels;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Временная линия на весь экран */}\r\n      <div \r\n        className=\"timeline-content\" \r\n        id=\"timeline-content\"\r\n        role=\"presentation\" \r\n        aria-hidden=\"true\"\r\n        style={{ \r\n          position: 'relative', \r\n          height: '100%',\r\n          overflow: 'visible',\r\n          padding: isMobile ? '0' : '1rem 0 2rem 0'\r\n        }}\r\n      >\r\n        {/* Разноцветная заливка веков */}\r\n        <div \r\n          className=\"timeline-background\"\r\n          id=\"timeline-background\"\r\n          role=\"presentation\"\r\n          aria-hidden=\"true\"\r\n          style={{\r\n            position: 'absolute',\r\n            top: '0',\r\n            left: '0',\r\n            width: `${getAdjustedTimelineWidth()}px`,\r\n            height: `${totalHeight + 200}px`,\r\n            pointerEvents: 'none',\r\n            zIndex: 1\r\n          }}\r\n        >\r\n          {timelineElements.map((element, index) => {\r\n                         if (element.type === 'century') {\r\n               const year = element.year;\r\n               // Каждый век занимает ровно 100 лет\r\n               const nextYear = year + 100\r\n               const startPos = getAdjustedPosition(year)\r\n               const endPos = getAdjustedPosition(nextYear)\r\n               const width = endPos - startPos\r\n\r\n              // Вычисляем век на основе центра года в столетии\r\n              const centerYear = year + 50\r\n              const centuryNumber = getCenturyNumber(centerYear)\r\n              // Для отрицательных веков добавляем знак минус\r\n              const isNegativeCentury = year < 0\r\n              const romanNumeral = isNegativeCentury ? `-${toRomanNumeral(Math.abs(centuryNumber))}` : toRomanNumeral(centuryNumber)\r\n              \r\n              return (\r\n                <div \r\n                  key={`century-bg-${year}`} \r\n                  className=\"century-background\"\r\n                  id={`century-${year}`}\r\n                  role=\"presentation\"\r\n                  aria-label={`Век ${romanNumeral}`}\r\n                  style={{\r\n                    position: 'absolute',\r\n                    left: `${startPos}px`,\r\n                    width: `${width}px`,\r\n                    height: '100%',\r\n                    background: getCenturyColor(year, minYear),\r\n                    opacity: 0.3,\r\n                    zIndex: 1\r\n                  }}\r\n                >\r\n                </div>\r\n              )\r\n                                                   } else if (element.type === 'gap') {\r\n                // Промежуток между веками - компактный размер (1/10 века)\r\n                const gapWidth = pixelsPerYear * 10; // 10 лет = 1/10 века\r\n                const startPos = getAdjustedPosition(element.startYear)\r\n               \r\n               return (\r\n                 <div key={`gap-${element.startYear}`} style={{\r\n                   position: 'absolute',\r\n                   left: `${startPos}px`,\r\n                   width: `${gapWidth}px`,\r\n                   height: '100%',\r\n                   background: 'rgba(139, 69, 19, 0.1)',\r\n                   border: '1px dashed rgba(139, 69, 19, 0.3)',\r\n                   zIndex: 1\r\n                 }}>\r\n                </div>\r\n              )\r\n            }\r\n            return null;\r\n          })}\r\n        </div>\r\n\r\n                 {/* Границы веков и промежутков на всю высоту */}\r\n         <div style={{\r\n           position: 'absolute',\r\n           top: '0',\r\n           left: '0',\r\n           width: `${getAdjustedTimelineWidth()}px`,\r\n           height: `${totalHeight + 200}px`,\r\n           pointerEvents: 'none',\r\n           zIndex: 5\r\n         }}>\r\n                      {timelineElements.map((element) => {\r\n              if (element.type === 'century') {\r\n                return (\r\n                  <div key={`century-line-${element.year}`} style={{\r\n                    position: 'absolute',\r\n                    left: `${getAdjustedPosition(element.year)}px`,\r\n                    width: '2px',\r\n                    height: '100%',\r\n                    background: 'linear-gradient(to bottom, #cd853f 0%, #cd853f 20%, rgba(205, 133, 63, 0.3) 100%)',\r\n                    zIndex: 5\r\n                  }} />\r\n                );\r\n              } else if (element.type === 'gap') {\r\n                return (\r\n                  <div key={`gap-line-${element.startYear}`} style={{\r\n                    position: 'absolute',\r\n                    left: `${getAdjustedPosition(element.startYear)}px`,\r\n                    width: '2px',\r\n                    height: '100%',\r\n                    background: 'linear-gradient(to bottom, #cd853f 0%, #cd853f 20%, rgba(205, 133, 63, 0.3) 100%)',\r\n                    zIndex: 5\r\n                  }} />\r\n                );\r\n              }\r\n              return null;\r\n            })}\r\n         </div>\r\n\r\n         {/* Повторяющиеся метки веков через каждые 90vh */}\r\n         <div style={{\r\n           position: 'absolute',\r\n           top: '0',\r\n           left: '0',\r\n           width: `${getAdjustedTimelineWidth()}px`,\r\n           height: `${totalHeight + 200}px`,\r\n           pointerEvents: 'none',\r\n           zIndex: 6\r\n         }}>\r\n           {createRepeatingCenturyLabels().map((label) => (\r\n             <div\r\n               key={label.id}\r\n               style={{\r\n                 position: 'absolute',\r\n                 left: `${label.left}px`,\r\n                 top: `${label.top}px`,\r\n                 transform: 'translate(-50%, -50%)',\r\n                 fontSize: label.type === 'century' ? '1.5rem' : '0.8rem',\r\n                 fontWeight: 'bold',\r\n                 color: label.type === 'century' \r\n                   ? 'rgba(244, 228, 193, 0.4)' \r\n                   : 'rgba(139, 69, 19, 0.5)',\r\n                 textShadow: '1px 1px 2px rgba(0, 0, 0, 0.6)',\r\n                 pointerEvents: 'none',\r\n                 fontFamily: label.type === 'century' ? 'serif' : 'sans-serif',\r\n                 textAlign: 'center',\r\n                 maxWidth: '200px',\r\n                 wordWrap: 'break-word'\r\n               }}\r\n             >\r\n               {label.type === 'century' ? (\r\n                 label.romanNumeral\r\n               ) : (\r\n                 <>\r\n                   <div>Скрыто:</div>\r\n                   <div style={{ fontSize: '0.7rem', marginTop: '2px' }}>\r\n                     {label.romanNumeral}\r\n                   </div>\r\n                 </>\r\n               )}\r\n             </div>\r\n           ))}\r\n         </div>\r\n\r\n         {/* Разделители групп */}\r\n         <div \r\n           className=\"category-dividers\"\r\n           id=\"category-dividers\"\r\n           role=\"presentation\"\r\n           aria-hidden=\"true\"\r\n           style={{\r\n             position: 'absolute',\r\n             top: '0',\r\n             left: '0',\r\n             width: `${getAdjustedTimelineWidth()}px`,\r\n             height: `${totalHeight + 200}px`,\r\n             pointerEvents: 'none',\r\n             zIndex: 8\r\n           }}\r\n         >\r\n          {categoryDividers.map((divider) => (\r\n            <div \r\n              key={`category-divider-${divider.category}`} \r\n              className=\"category-divider\"\r\n              id={`divider-${divider.category}`}\r\n              role=\"separator\"\r\n              aria-label={`Разделитель группы: ${divider.category}`}\r\n              style={{\r\n                position: 'absolute',\r\n                top: `${divider.top}px`,\r\n                left: '0',\r\n                width: '100%',\r\n                height: '10px',\r\n                background: `linear-gradient(to right, transparent 0%, ${getGroupColor(divider.category)} 20%, ${getGroupColor(divider.category)} 80%, transparent 100%)`,\r\n                opacity: 0.6,\r\n                zIndex: 8\r\n              }}\r\n            >\r\n              <div \r\n                className=\"category-label\" \r\n                id={`category-label-${divider.category}`}\r\n                aria-label={`Группа: ${divider.category}`}\r\n                style={{\r\n                  position: 'absolute',\r\n                  left: '20px',\r\n                  top: '50%',\r\n                  transform: 'translateY(-50%)',\r\n                  background: getGroupColor(divider.category),\r\n                  color: 'white',\r\n                  padding: '2px 8px',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.7rem',\r\n                  fontWeight: 'bold',\r\n                  whiteSpace: 'nowrap',\r\n                  zIndex: 9\r\n                }}\r\n              >\r\n                {divider.category}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n                 {/* Полоски жизни */}\r\n         <div \r\n           className=\"person-timeline\"\r\n           id=\"person-timeline\"\r\n           role=\"list\"\r\n           aria-label=\"Временные линии исторических личностей\"\r\n           style={{ \r\n             position: 'relative',\r\n             width: `${getAdjustedTimelineWidth()}px`,\r\n             height: `${totalHeight + 60}px`,\r\n             zIndex: 10\r\n           }}\r\n         >\r\n          {rowPlacement.map((row, rowIndex) => (\r\n            <div \r\n              key={rowIndex} \r\n              className=\"timeline-row\"\r\n              id={`timeline-row-${rowIndex}`}\r\n              role=\"listitem\"\r\n              aria-label={`Строка ${rowIndex + 1} временной линии`}\r\n              style={{\r\n                position: 'relative',\r\n                height: row.length === 0 ? '20px' : '60px',\r\n                marginBottom: row.length === 0 ? '0px' : '10px'\r\n              }}\r\n            >\r\n              {row.map((person) => (\r\n                <React.Fragment key={person.id}>\r\n                  {/* Годы жизни и правления над полоской */}\r\n                  <span \r\n                    className=\"birth-year-label\"\r\n                    id={`birth-year-${person.id}`}\r\n                    aria-label={`Год рождения: ${person.birthYear}`}\r\n                    style={{\r\n                      position: 'absolute',\r\n                      left: `${getAdjustedPosition(person.birthYear)}px`,\r\n                      top: 0,\r\n                      fontSize: '11px',\r\n                      color: 'rgba(244, 228, 193, 0.6)',\r\n                      fontStyle: 'italic',\r\n                      fontWeight: 400,\r\n                      transform: 'translateX(-100%) translateY(-10px)'\r\n                    }}\r\n                  >\r\n                    {person.birthYear}\r\n                  </span>\r\n\r\n                                     {person.reignStart && (\r\n                     <span \r\n                       className=\"reign-label\" \r\n                       id={`reign-start-${person.id}`}\r\n                       aria-label={`Начало правления: ${person.reignStart}`}\r\n                       style={{\r\n                         position: 'absolute',\r\n                         left: `${getAdjustedPosition(person.reignStart)}px`,\r\n                         top: 0,\r\n                         fontSize: '11px',\r\n                         color: '#E57373', // Темно-красный\r\n                         fontStyle: 'italic',\r\n                         fontWeight: 'bold',\r\n                         transform: 'translateX(-100%) translateY(-22px)'\r\n                       }}\r\n                     >\r\n                       👑 {person.reignStart}\r\n                     </span>\r\n                   )}\r\n\r\n                                     {person.reignEnd && (\r\n                     <span \r\n                       className=\"reign-label\" \r\n                       id={`reign-end-${person.id}`}\r\n                       aria-label={`Конец правления: ${person.reignEnd}`}\r\n                       style={{\r\n                         position: 'absolute',\r\n                         left: `${getAdjustedPosition(person.reignEnd)}px`,\r\n                         top: 0,\r\n                         fontSize: '11px',\r\n                         color: '#E57373', // Темно-красный\r\n                         fontStyle: 'italic',\r\n                         fontWeight: 'bold',\r\n                         transform: 'translateY(-22px)'\r\n                       }}\r\n                     >\r\n                       {person.reignEnd}\r\n                     </span>\r\n                   )}\r\n                  \r\n                                     <span \r\n                                       className=\"death-year-label\"\r\n                                       id={`death-year-${person.id}`}\r\n                                       aria-label={`Год смерти: ${person.deathYear}`}\r\n                                       style={{\r\n                                         position: 'absolute',\r\n                                         left: `${getAdjustedPosition(person.deathYear)}px`,\r\n                                         top: 0,\r\n                                         fontSize: '11px',\r\n                                         color: 'rgba(244, 228, 193, 0.6)',\r\n                                         fontStyle: 'italic',\r\n                                         fontWeight: 400,\r\n                                         transform: 'translateY(-10px)'\r\n                                       }}\r\n                                     >\r\n                                       {person.deathYear}\r\n                                     </span>\r\n\r\n                  {/* Маркеры ключевых достижений */}\r\n                  {filters.showAchievements && [person.achievementYear1, person.achievementYear2, person.achievementYear3]\r\n                    .filter(year => year !== undefined && year !== null)\r\n                    .map((year, index) => {\r\n                      return (\r\n                        <div \r\n                          key={index} \r\n                          className=\"achievement-marker\"\r\n                          id={`achievement-${person.id}-${index}`}\r\n                          role=\"button\"\r\n                          aria-label={`Достижение ${index + 1} в ${year} году`}\r\n                          tabIndex={0}\r\n                          style={{\r\n                            position: 'absolute',\r\n                            left: `${getAdjustedPosition(year as number)}px`,\r\n                            top: '-4px',\r\n                            width: '2px', // Возвращаем стандартную ширину\r\n                            height: '15px', // Возвращаем стандартную высоту\r\n                            backgroundColor: getGroupColorDark(getPersonGroup(person)),\r\n                            zIndex: activeAchievementMarker?.personId === person.id && activeAchievementMarker?.index === index ? 10 : 3,\r\n                            transform: 'translateX(-50%)',\r\n                            cursor: 'pointer',\r\n                            transition: 'all 0.2s ease',\r\n                            // Убираем псевдоэлементы, так как они не работают в inline стилях\r\n                          }}\r\n                        onMouseEnter={(e) => {\r\n                          if (!isMobile) {\r\n                            e.currentTarget.style.backgroundColor = getGroupColor(getPersonGroup(person));\r\n                            e.currentTarget.style.boxShadow = `0 0 3px ${getGroupColor(getPersonGroup(person))}`;\r\n                            \r\n                            // Устанавливаем активный маркер\r\n                            setActiveAchievementMarker({ personId: person.id, index });\r\n                            \r\n                            // Скрываем tooltip человека при наведении на маркер достижения\r\n                            if (hoveredPerson?.id === person.id) {\r\n                              handlePersonHover(null, 0, 0);\r\n                            }\r\n                            \r\n                            // Очищаем предыдущий таймер если он есть\r\n                            if (hoverTimerRef.current) {\r\n                              clearTimeout(hoverTimerRef.current);\r\n                            }\r\n                            \r\n                            // Запускаем таймер для показа tooltip\r\n                            hoverTimerRef.current = setTimeout(() => {\r\n                              setAchievementTooltipPosition({ x: e.clientX, y: e.clientY });\r\n                              setHoveredAchievement({ person, year: year as number, index });\r\n                              setShowAchievementTooltip(true);\r\n                            }, 500);\r\n                          }\r\n                        }}\r\n                        onMouseLeave={(e) => {\r\n                          if (!isMobile) {\r\n                            e.currentTarget.style.backgroundColor = getGroupColorDark(getPersonGroup(person));\r\n                            e.currentTarget.style.boxShadow = 'none';\r\n                            \r\n                            // Сбрасываем активный маркер\r\n                            setActiveAchievementMarker(null);\r\n                            \r\n                            // Очищаем таймер и скрываем tooltip достижения\r\n                            if (hoverTimerRef.current) {\r\n                              clearTimeout(hoverTimerRef.current);\r\n                              hoverTimerRef.current = null;\r\n                            }\r\n                            setShowAchievementTooltip(false);\r\n                            setHoveredAchievement(null);\r\n                            \r\n                            // Также скрываем tooltip человека, если он был показан\r\n                            if (hoveredPerson?.id === person.id) {\r\n                              handlePersonHover(null, 0, 0);\r\n                            }\r\n                          }\r\n                        }}\r\n                        onMouseMove={(e) => {\r\n                          if (!isMobile && hoveredAchievement && hoveredAchievement.person.id === person.id && hoveredAchievement.index === index) {\r\n                            setAchievementTooltipPosition({ x: e.clientX, y: e.clientY });\r\n                          }\r\n                        }}\r\n                        onTouchStart={(e) => {\r\n                          if (isMobile) {\r\n                            e.preventDefault();\r\n                            e.currentTarget.style.backgroundColor = getGroupColor(getPersonGroup(person));\r\n                            e.currentTarget.style.boxShadow = `0 0 3px ${getGroupColor(getPersonGroup(person))}`;\r\n                            \r\n                            // Устанавливаем активный маркер\r\n                            setActiveAchievementMarker({ personId: person.id, index });\r\n                            \r\n                            // Скрываем tooltip человека при касании маркера достижения\r\n                            if (hoveredPerson?.id === person.id) {\r\n                              handlePersonHover(null, 0, 0);\r\n                            }\r\n                            \r\n                            // Показываем tooltip сразу на мобильных\r\n                            const touch = e.touches[0];\r\n                            setAchievementTooltipPosition({ x: touch.clientX, y: touch.clientY });\r\n                            setHoveredAchievement({ person, year: year as number, index });\r\n                            setShowAchievementTooltip(true);\r\n                          }\r\n                        }}\r\n                        onTouchEnd={(e) => {\r\n                          if (isMobile) {\r\n                            // Убираем визуальные эффекты при отпускании, но НЕ скрываем tooltip\r\n                            e.currentTarget.style.backgroundColor = getGroupColorDark(getPersonGroup(person));\r\n                            e.currentTarget.style.boxShadow = 'none';\r\n                            \r\n                            // Сбрасываем активный маркер\r\n                            setActiveAchievementMarker(null);\r\n                            \r\n                            // НЕ скрываем tooltip достижения - он будет скрыт только по клику вне или по кнопке закрытия\r\n                            // Но скрываем tooltip человека, если он был показан\r\n                            if (hoveredPerson?.id === person.id) {\r\n                              handlePersonHover(null, 0, 0);\r\n                            }\r\n                          }\r\n                        }}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === 'Enter' || e.key === ' ') {\r\n                            e.preventDefault();\r\n                            // Показываем tooltip при нажатии Enter или Space\r\n                            setHoveredAchievement({ person, year: year as number, index });\r\n                            // Используем позицию элемента для tooltip при нажатии клавиши\r\n                            const rect = e.currentTarget.getBoundingClientRect();\r\n                            setAchievementTooltipPosition({ \r\n                              x: rect.left + rect.width / 2, \r\n                              y: rect.top - 10 \r\n                            });\r\n                            setShowAchievementTooltip(true);\r\n                          }\r\n                        }}\r\n                        >\r\n                          <span style={{\r\n                            position: 'absolute',\r\n                            top: '-12px',\r\n                            left: '50%',\r\n                            transform: 'translateX(-50%)',\r\n                            fontSize: '8px',\r\n                            color: getGroupColorDark(getPersonGroup(person)),\r\n                            fontWeight: 'bold',\r\n                            whiteSpace: 'nowrap',\r\n                            backgroundColor: 'rgba(44, 24, 16, 0.9)',\r\n                            padding: '1px 3px',\r\n                            borderRadius: '2px',\r\n                            border: `1px solid ${getGroupColorDark(getPersonGroup(person))}`,\r\n                            transition: 'all 0.2s ease'\r\n                          }}>\r\n                            {year}\r\n                          </span>\r\n                        </div>\r\n                      );\r\n                    })}\r\n\r\n                                     {/* полоса правления */}\r\n                   {person.reignStart && person.reignEnd && (\r\n                     <div \r\n                       className=\"reign-bar\"\r\n                       id={`reign-bar-${person.id}`}\r\n                       role=\"presentation\"\r\n                       aria-label={`Период правления: ${person.reignStart} - ${person.reignEnd}`}\r\n                       style={{\r\n                         position: 'absolute',\r\n                         top: '-15px',\r\n                         left: `${getAdjustedPosition(person.reignStart)}px`,\r\n                         width: `${getAdjustedWidth(person.reignStart, person.reignEnd)}px`,\r\n                         height: '65px',\r\n                         backgroundColor: 'rgba(211, 47, 47, 0.25)',\r\n                         pointerEvents: 'none',\r\n                         borderLeft: '2px solid #D32F2F',\r\n                         borderRight: '2px solid #D32F2F',\r\n                         borderRadius: '3px',\r\n                         zIndex: 1\r\n                       }} \r\n                     />\r\n                   )}\r\n\r\n                                     <div\r\n                     className=\"life-bar\"\r\n                     id={`life-bar-${person.id}`}\r\n                     role=\"button\"\r\n                     aria-label={`${person.name}, ${person.birthYear} - ${person.deathYear}, ${person.category}`}\r\n                     tabIndex={0}\r\n                     style={{\r\n                       position: 'absolute',\r\n                       top: '10px',\r\n                       left: `${getAdjustedPosition(person.birthYear)}px`,\r\n                       width: `${getAdjustedWidth(person.birthYear, person.deathYear)}px`,\r\n                       height: '40px',\r\n                       background: `linear-gradient(135deg, ${getGroupColorMuted(getPersonGroup(person))} 0%, #6a5a3a 100%)`,\r\n                       borderRadius: '6px',\r\n                       cursor: 'pointer',\r\n                       display: 'flex',\r\n                       alignItems: 'center',\r\n                       padding: '0 12px',\r\n                       color: 'white',\r\n                       fontSize: '14px',\r\n                       fontWeight: 'bold',\r\n                       minWidth: '60px',\r\n                       boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\r\n                       border: '1.5px solid #a8926a',\r\n                       opacity: selectedPerson?.id === person.id ? 0.8 : 1,\r\n                       zIndex: 5,\r\n                       transform: selectedPerson?.id === person.id ? 'scale(1.05)' : 'scale(1)',\r\n                       transition: 'all 0.2s ease'\r\n                     }}\r\n                    onMouseEnter={(e) => {\r\n                      if (!isMobile) {\r\n                        e.currentTarget.style.transform = 'translateY(-3px) scale(1.02)'\r\n                        e.currentTarget.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.4)'\r\n                        e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.4)'\r\n                        \r\n                        // Скрываем tooltip достижения при наведении на lifebar\r\n                        if (hoveredAchievement?.person.id === person.id) {\r\n                          setShowAchievementTooltip(false);\r\n                          setHoveredAchievement(null);\r\n                          setActiveAchievementMarker(null);\r\n                        }\r\n                        \r\n                        // Используем handlePersonHover для правильной обработки\r\n                        handlePersonHover(person, e.clientX, e.clientY)\r\n                      }\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      if (!isMobile) {\r\n                        e.currentTarget.style.transform = selectedPerson?.id === person.id ? 'scale(1.05)' : 'translateY(0) scale(1)'\r\n                        e.currentTarget.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)'\r\n                        e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.2)'\r\n                        // Используем handlePersonHover для правильной обработки с задержкой\r\n                        handlePersonHover(null, 0, 0)\r\n                      }\r\n                    }}\r\n                    onMouseMove={(e) => {\r\n                      if (!isMobile && hoveredPerson?.id === person.id) {\r\n                        setMousePosition({ x: e.clientX, y: e.clientY })\r\n                      }\r\n                    }}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter' || e.key === ' ') {\r\n                        e.preventDefault();\r\n                        if (isMobile) {\r\n                          setSelectedPerson(person);\r\n                        } else {\r\n                          setHoveredPerson(person);\r\n                          setShowTooltip(true);\r\n                        }\r\n                      }\r\n                    }}\r\n                    onTouchStart={(e) => {\r\n                      if (isMobile) {\r\n                        // Скрываем tooltip достижения при касании lifebar\r\n                        if (hoveredAchievement?.person.id === person.id) {\r\n                          setShowAchievementTooltip(false);\r\n                          setHoveredAchievement(null);\r\n                          setActiveAchievementMarker(null);\r\n                        }\r\n                      }\r\n                    }}\r\n                    onClick={() => {\r\n                      if (isMobile) {\r\n                        setSelectedPerson(person)\r\n                      }\r\n                    }}\r\n                  >\r\n                    <div style={{ display: 'flex', flexDirection: 'column', lineHeight: '1.2' }}>\r\n                      <span>{person.name}</span>\r\n                    </div>\r\n                  </div>\r\n                </React.Fragment>\r\n              ))}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}